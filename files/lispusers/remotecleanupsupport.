(FILECREATED "24-JAN-79 09:37:20" <LAASER>REMOTECLEANUPSUPPORT.;2 2265   

     changes to:  READALTEREDFNS

     previous date: "15-JAN-79 12:27:43" <LAASER>REMOTECLEANUPSUPPORT.;1)


(PRETTYCOMPRINT REMOTECLEANUPSUPPORTCOMS)

(RPAQQ REMOTECLEANUPSUPPORTCOMS ((FNS * REMOTESUPPORTFNS)
				 (VARS * REMOTESUPPORTVARS)
				 (ADVICE * REMOTECLEANUPSUPPORTADVICE)
				 (P (READVISE COMPSETREAD))))

(RPAQQ REMOTESUPPORTFNS (DUMPDATABASES LOADALTERATIONS LOADDB? PREVIOUSFILE READALTEREDFNS))
(DEFINEQ

(DUMPDATABASES
  [LAMBDA (FILES)                                           (* WTL: " 8-JAN-79 10:05")
    (FOR FILE IN FILES DO (DUMPDB FILE])

(LOADALTERATIONS
  [LAMBDA NIL                                               (* WTL: " 9-JAN-79 12:20")
    (PROG [EXPR (FILE (INFILE (INFILE (QUOTE TEMPREMOTECLEANUP]
          (while (NEQ (QUOTE STOP)
		      (SETQ EXPR (READ FILE)))
	     do (EVAL EXPR))
          (CLOSEF FILE])

(LOADDB?
  [LAMBDA (FILE)                                            (* WTL: " 8-JAN-79 10:29")
    (OR (EQ (GETPROP FILE (QUOTE DATABASE))
	    (QUOTE YES))
	[NULL (FULLNAME (PACKFILENAME (LIST (QUOTE BODY)
					    FILE
					    (QUOTE EXTENSION)
					    (QUOTE DATABASE]
	(LOADDB FILE])

(PREVIOUSFILE
  [LAMBDA (FILE)                                            (* WTL: "15-JAN-79 12:26")
    (PROG (FIELDS)
          (SETQ FIELDS (UNPACKFILENAME (FULLNAME FILE)))
          (RETURN (PACKFILENAME (CONS (QUOTE VERSION)
				      (CONS (SUB1 (CADR (FMEMB (QUOTE VERSION)
							       FIELDS)))
					    FIELDS])

(READALTEREDFNS
  [LAMBDA (FNS FILE)                                        (* WTL: "24-JAN-79 09:37")
    (if (FULLNAME FILE)
	then (OR (FILEFNSLST FILE)
		 (LOADFROM (PREVIOUSFILE FILE)))
	     (LOADFNS FNS FILE)
	     (for FN in FNS do (UPDATEFN FN T))
      else (ERROR "CANT FIND FILE" FILE])
)

(RPAQQ REMOTESUPPORTVARS ((LOADDBFLG (QUOTE YES))))

(RPAQQ LOADDBFLG YES)

(RPAQQ REMOTECLEANUPSUPPORTADVICE (COMPSETREAD))

(PUTPROPS COMPSETREAD READVICE [NIL (BEFORE NIL (RETURN (QUOTE F])
(READVISE COMPSETREAD)
(DECLARE: DONTCOPY
  (FILEMAP (NIL (516 1999 (DUMPDATABASES 528 . 692) (LOADALTERATIONS 696 . 1000) (LOADDB? 1004 . 1310) (
PREVIOUSFILE 1314 . 1652) (READALTEREDFNS 1656 . 1996)))))
STOP
