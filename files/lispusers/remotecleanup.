(FILECREATED "15-JAN-79 12:29:16" <LAASER>REMOTECLEANUP.;1 4944   

     changes to:  CLEANUPREMOTELY

     previous date: "11-JAN-79 11:58:45" <LISPUSERS>REMOTECLEANUP.;3)


(PRETTYCOMPRINT REMOTECLEANUPCOMS)

(RPAQQ REMOTECLEANUPCOMS [(VARS * REMOTECLEANUPVARS)
			  (FNS * REMOTECLEANUPFNS)
			  (ADVICE * REMOTECLEANUPADVICE)
			  (P (READVISE CLEANUP)
			     (SETQ MAKEFILEOPTIONS (APPEND (QUOTE (REMMAST REMCOM RELOAD))
							   MAKEFILEOPTIONS))
			     [OR (STRINGP (GETATOMVAL (QUOTE CLEANUPSYSTEM)))
				 (COND ((GETPROP (QUOTE MENUMENU)
						 (QUOTE MENUCOMS))
					(* THIS IS A DLISP)
					(SETQ CLEANUPOPTIONS (CONS (QUOTE REMCOM)
								   (DREMOVE (QUOTE RC)
									    CLEANUPOPTIONS)))
					(SETQ CLEANUPSYSTEM "<KBA>DLISP
"))
				       ([AND (GETD (QUOTE SeekInFiller))
					     (NULL (GETD (QUOTE MASTERSCOPE]
					(* THIS IS A SMALLKRL)
					[SETQ CLEANUPOPTIONS (CONS (QUOTE REMCOM)
								   (CONS (QUOTE REMMAST)
									 (REMOVE (QUOTE RC)
										 CLEANUPOPTIONS]
					(SETQ CLEANUPSYSTEM "<KRL1>KRL
Y"))
				       (T (SETQ CLEANUPSYSTEM "LISP
"]
			     (LOAD? (QUOTE <LISPUSERS>FILEWONTOPEN])

(RPAQQ REMOTECLEANUPVARS (FORCESUBJOB (REMOTECLEANUPINITIALIZED NIL)
				      (CLEANUPSTRINGEND "(LOGOUT)")
				      CLEANUPSTRINGSTART))

(RPAQQ FORCESUBJOB NIL)

(RPAQ REMOTECLEANUPINITIALIZED NIL)

(RPAQ CLEANUPSTRINGEND "(LOGOUT)")

(RPAQQ CLEANUPSTRINGSTART "<KRL1>KRL
C")

(RPAQQ REMOTECLEANUPFNS (CLEANUPREMOTELY))
(DEFINEQ

(CLEANUPREMOTELY
  [LAMBDA (FILES)                                           (* WTL: "15-JAN-79 12:29")
    (AND (INTERSECTION (QUOTE (REMMAST REMCOM))
		       CLEANUPOPTIONS)
	 (PROG [VALUE (STR (COND
			     (REMOTECLEANUPINITIALIZED "CONTINUE
")
			     ((FMEMB (QUOTE REMMAST)
				     CLEANUPOPTIONS)
			       (SETQ REMOTECLEANUPINITIALIZED T)
			       (CONCAT CLEANUPSYSTEM 
				       "(LOAD (QUOTE <LISPUSERS>REMOTECLEANUPSUPPORT.COM]"))
			     (T (SETQ REMOTECLEANUPINITIALIZED T)
				CLEANUPSYSTEM)))
		      FNS
		      (TEMPFILE (OUTFILE (OUTFILE (QUOTE TEMPREMOTECLEANUP;T]
	       (if (NOT FILES)
		   then (SETQ FILES NOTCOMPILEDFILES))
	       (for FILE in FILES do (SETQ FNS (for FN in (INFILECOMS? NIL (QUOTE FNS)
								       (FILECOMS FILE))
						  when (FMEMB (FNTYP FN)
							      (QUOTE (EXPR FEXPR EXPR* FEXPR*)))
						  collect FN))
				     (if (FMEMB (QUOTE REMCOM)
						CLEANUPOPTIONS)
					 then (PRINT (if (FULLNAME (PACKFILENAME (LIST (QUOTE BODY)
										       FILE
										       (QUOTE 
											EXTENSION)
										       COMPILE.EXT)))
							 then (LIST (QUOTE RECOMPILE)
								    (KWOTE FILE)
								    (KWOTE (PACKFILENAME
									     (QUOTE NAME)
									     FILE
									     (QUOTE EXTENSION)
									     COMPILE.EXT))
								    (KWOTE FNS))
						       else (LIST (QUOTE BCOMPL)
								  (KWOTE FILE)))
						     TEMPFILE))
				     (if (FMEMB (QUOTE REMMAST)
						CLEANUPOPTIONS)
					 then (PRINT (LIST (QUOTE LOADDB?)
							   (KWOTE FILE))
						     TEMPFILE)
					      (PRINT (LIST (QUOTE READALTEREDFNS)
							   (KWOTE FNS)
							   (KWOTE FILE))
						     TEMPFILE)))
	       (if (FMEMB (QUOTE REMMAST)
			  CLEANUPOPTIONS)
		   then (PRINT (LIST (QUOTE DUMPDATABASES)
				     (KWOTE FILES))
			       TEMPFILE))
	       (PRINT (QUOTE STOP)
		      TEMPFILE)
	       (CLOSEF TEMPFILE)
	       (SETQ STR (CONCAT STR (QUOTE (LOADALTERATIONS))
				 CLEANUPSTRINGEND))
	       (if (TENEX STR)
		   then (if (FMEMB (QUOTE RELOAD)
				   CLEANUPOPTIONS)
			    then [for FILE in FILES do (LOAD (PACKFILENAME (QUOTE NAME)
									   FILE
									   (QUOTE EXTENSION)
									   (QUOTE COM]
			  else (SETQ NOTCOMPILEDFILES NIL)))
	       (DELFILE TEMPFILE])
)

(RPAQQ REMOTECLEANUPADVICE (CLEANUP))

(PUTPROPS CLEANUP ARGNAMES (NIL (FILES) . FILES))

(PUTPROPS CLEANUP READVICE (NIL (AFTER NIL (CLEANUPREMOTELY FILES))))
(READVISE CLEANUP)
(SETQ MAKEFILEOPTIONS (APPEND (QUOTE (REMMAST REMCOM RELOAD))
			      MAKEFILEOPTIONS))
[OR (STRINGP (GETATOMVAL (QUOTE CLEANUPSYSTEM)))
    (COND ((GETPROP (QUOTE MENUMENU)
		    (QUOTE MENUCOMS))
	   (* THIS IS A DLISP)
	   (SETQ CLEANUPOPTIONS (CONS (QUOTE REMCOM)
				      (DREMOVE (QUOTE RC)
					       CLEANUPOPTIONS)))
	   (SETQ CLEANUPSYSTEM "<KBA>DLISP
"))
	  ([AND (GETD (QUOTE SeekInFiller))
		(NULL (GETD (QUOTE MASTERSCOPE]
	   (* THIS IS A SMALLKRL)
	   [SETQ CLEANUPOPTIONS (CONS (QUOTE REMCOM)
				      (CONS (QUOTE REMMAST)
					    (REMOVE (QUOTE RC)
						    CLEANUPOPTIONS]
	   (SETQ CLEANUPSYSTEM "<KRL1>KRL
Y"))
	  (T (SETQ CLEANUPSYSTEM "LISP
"]
(LOAD? (QUOTE <LISPUSERS>FILEWONTOPEN))
(DECLARE: DONTCOPY
  (FILEMAP (NIL (1541 3984 (CLEANUPREMOTELY 1553 . 3981)))))
STOP
