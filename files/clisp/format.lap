
;;; CLC vP.U.V.1(2) compiling CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31

(IN-PACKAGE (QUOTE LISP)) 
(EXPORT (QUOTE (FORMAT))) 
(DEFVAR *FORMAT-CONTROL-STRING* "" "The current FORMAT control string") 
(DEFVAR *FORMAT-INDEX* 0 "The current index into *format-control-string*") 
(DEFVAR *FORMAT-LENGTH* 0 "The length of the current FORMAT control string") 
(DEFVAR *FORMAT-ARGUMENTS* NIL "Arguments to the current call of FORMAT") 
(DEFVAR *FORMAT-ORIGINAL-ARGUMENTS* NIL "Saved arglist from top-level FORMAT call for ~* and ~@*") 
(DEFVAR *FORMAT-STREAM-STACK* NIL "A stack of string streams for collecting FORMAT output") 
(DEFVAR *FORMAT-DISPATCH-TABLE* NIL "Dispatch table for FORMAT commands") 
(%PUT (QUOTE *PRINT-BASE*) (QUOTE GLOBALLY-SPECIAL) T) 
(%PUT (QUOTE *STANDARD-OUTPUT*) (QUOTE GLOBALLY-SPECIAL) T) 
(%PUT (QUOTE *TERMINAL-IO*) (QUOTE GLOBALLY-SPECIAL) T) 
(%PUT (QUOTE *ERROR-OUTPUT*) (QUOTE GLOBALLY-SPECIAL) T) 

#_(LAP #0_FORMAT-ERROR EXPR
       (ENTRY-POINTS (2-FEW 2 3 4 5 6 7) REST)
       #0_(FORMAT-ERROR "~1{~:}~%~S~%~V@T^" *FORMAT-CONTROL-STRING* *FORMAT-INDEX*)
       (CODE-START)
(LABEL 2)    (MOVE O2 NIL)
             (JRST 1)
(LABEL 3)    (MOVEI W2 1)
             (ICALL REST2)
             (JRST 1)
(LABEL 4)    (MOVEI W2 2)
             (ICALL REST3)
             (JRST 1)
(LABEL 5)    (MOVEI W2 3)
             (ICALL REST4)
             (JRST 1)
(LABEL 6)    (MOVEI W2 4)
             (ICALL REST5)
             (JRST 1)
(LABEL 7)    (MOVEI W2 1)
             (ICALL RESTX)
(LABEL 1)    (ADDI Q 3)
             (MOVEM O1 -2 Q)
             (MOVEM O2 -1 Q)
             (MOVE O1 (CONSTANT 0))
             (ICALL CTHROW)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 3))
             (CALL 1+ 1)
             (MOVE O5 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 -2 Q)
             (MOVE O3 -1 Q)
             (MOVE O4 0 Q)
             (CALL LIST 5)
             (CALL LIST 1)
             (POPJ P)
             (SUBI Q 3)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-ERROR) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COMPLAINT &REST ARGS))) 
(%PUT (QUOTE FORMAT-ERROR) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-ERROR) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-WITH-CONTROL-STRING MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(2 "Macro ~S cannot be called with ~S args." FORMAT-WITH-CONTROL-STRING LET STRING IF SIMPLE-STRING-P COERCE ((QUOTE SIMPLE-STRING)) (DECLARE (SIMPLE-STRING STRING)) ERROR CATCH (QUOTE FORMAT-ERROR) ((*FORMAT-CONTROL-STRING* STRING) (*FORMAT-LENGTH* (LENGTH STRING)) (*FORMAT-INDEX* 0)) (NIL) ((WHEN ERROR (THROW (QUOTE FORMAT-ERROR) (CONS (LIST "While processing indirect control string~%~S~%~V@T^" *FORMAT-CONTROL-STRING* (1+ *FORMAT-INDEX*)) ERROR)))))
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -5 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL < 2)
             (JUMPE O1 4)
             (MOVE O1 -6 Q)
             (CALL LENGTH 1)
             (CALL 1- 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 (CONSTANT 2))
             (CALL ERROR 3)
             (JRST 3)
(LABEL 4)    (SKIPA)
             (JRST 5)
             (MOVE O1 -6 Q)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 -6 Q)
             (MOVE O1 1 O1)
             (MOVE O5 1 O1)
             (MOVEM O5 -3 Q)
             (MOVE O2 -4 Q)
             (MOVE O1 (CONSTANT 6))
             (CALL LIST 2)
             (MOVEM O1 -1 Q)
             (MOVE O3 (CONSTANT 8))
             (MOVE O1 (CONSTANT 7))
             (MOVE O2 -4 Q)
             (CALL LIST* 3)
             (MOVE O4 O1)
             (MOVE O1 (CONSTANT 5))
             (MOVE O2 -1 Q)
             (MOVE O3 -4 Q)
             (CALL LIST 4)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 4))
             (CALL LIST 2)
             (CALL LIST 1)
             (MOVEM O1 -2 Q)
             (MOVE O2 (CONSTANT 14))
             (MOVE O1 -3 Q)
             (CALL APPEND 2)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 3))
             (MOVE O2 (CONSTANT 13))
             (CALL LIST* 3)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 11))
             (MOVE O2 (CONSTANT 12))
             (CALL LIST 3)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 10))
             (CALL LIST 2)
             (CALL LIST 1)
             (MOVEM O1 0 Q)
             (MOVE O3 (CONSTANT 15))
             (MOVE O1 (CONSTANT 3))
             (MOVE O2 0 Q)
             (CALL LIST* 3)
             (MOVE O4 O1)
             (MOVE O1 (CONSTANT 3))
             (MOVE O2 -2 Q)
             (MOVE O3 (CONSTANT 9))
             (CALL LIST 4)
(LABEL 5)
(LABEL 3)    (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-WITH-CONTROL-STRING) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (CONTROL-STRING &BODY FORMS))) 
(%PUT (QUOTE FORMAT-WITH-CONTROL-STRING) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-WITH-CONTROL-STRING) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-STRINGIFY-OUTPUT MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(LET ((*STANDARD-OUTPUT* (IF *FORMAT-STREAM-STACK* (POP *FORMAT-STREAM-STACK*) (MAKE-STRING-OUTPUT-STREAM)))) UNWIND-PROTECT PROGN ((PROG1 (GET-OUTPUT-STREAM-STRING *STANDARD-OUTPUT*) (PUSH *STANDARD-OUTPUT* *FORMAT-STREAM-STACK*))) ((GET-OUTPUT-STREAM-STRING *STANDARD-OUTPUT*)))
       (CODE-START)
(LABEL 1)    (ADDI Q 3)
             (MOVEM O1 -2 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -1 Q)
             (MOVE O2 (CONSTANT 4))
             (MOVE O1 O5)
             (CALL APPEND 2)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 3))
             (CALL CONS 2)
             (MOVEM O1 0 Q)
             (MOVE O3 (CONSTANT 5))
             (MOVE O1 (CONSTANT 2))
             (MOVE O2 0 Q)
             (CALL LIST* 3)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 0))
             (MOVE O2 (CONSTANT 1))
             (CALL LIST 3)
             (SUBI Q 3)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-STRINGIFY-OUTPUT) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (&BODY FORMS))) 
(%PUT (QUOTE FORMAT-STRINGIFY-OUTPUT) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-STRINGIFY-OUTPUT) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_POP-FORMAT-ARG MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(1 "Macro ~S cannot be called with ~S args." POP-FORMAT-ARG (IF *FORMAT-ARGUMENTS* (POP *FORMAT-ARGUMENTS*) (FORMAT-ERROR "Missing argument")))
       (CODE-START)
(LABEL 1)    (ADDI Q 2)
             (MOVEM O1 -1 Q)
             (CALL LENGTH 1)
             (MOVEM O1 0 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL > 2)
             (JUMPE O1 4)
             (MOVE O1 -1 Q)
             (CALL LENGTH 1)
             (CALL 1- 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 (CONSTANT 2))
             (CALL ERROR 3)
             (JRST 3)
(LABEL 4)    (SKIPA)
             (JRST 5)
             (MOVE O1 (CONSTANT 3))
             (MOVEI N 1)
(LABEL 5)
(LABEL 3)    (SUBI Q 2)
             (POPJ P)
)

(%PUT (QUOTE POP-FORMAT-ARG) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE POP-FORMAT-ARG) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE POP-FORMAT-ARG) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_WITH-FORMAT-PARAMETERS MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(3 "Macro ~S cannot be called with ~S args." WITH-FORMAT-PARAMETERS LET WHEN ((FORMAT-ERROR "Too many parameters")) OR IF POP)
       (CODE-START)
(LABEL 1)    (ADDI Q 11)
             (MOVEM O1 -10 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -9 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL < 2)
             (JUMPE O1 4)
             (MOVE O1 -10 Q)
             (CALL LENGTH 1)
             (CALL 1- 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 (CONSTANT 2))
             (CALL ERROR 3)
             (JRST 3)
(LABEL 4)    (SKIPA)
             (JRST 5)
             (MOVE O1 -10 Q)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 -10 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 -10 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O5 1 O1)
             (MOVEM O5 -6 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -5 Q)
             (MOVEM NIL -4 Q)
(LABEL 10)   (SKIPE NIL -5 Q)
             (JRST 11)
             (MOVE O1 -4 Q)
             (CALL NREVERSE 1)
             (MOVEM O1 -2 Q)
             (MOVE O3 (CONSTANT 5))
             (MOVE O1 (CONSTANT 4))
             (MOVE O2 -8 Q)
             (CALL LIST* 3)
             (MOVEM O1 -1 Q)
             (MOVE O4 -6 Q)
             (MOVE O1 (CONSTANT 3))
             (MOVE O2 -2 Q)
             (MOVE O3 -1 Q)
             (CALL LIST* 4)
             (JRST 6)
(LABEL 11)   (MOVE O1 -5 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -3 Q)
             (MOVE O1 0 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O2 -8 Q)
             (MOVE O1 (CONSTANT 8))
             (CALL LIST 2)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 7))
             (MOVE O2 -8 Q)
             (CALL LIST 3)
             (MOVEM O1 0 Q)
             (MOVE O1 -5 Q)
             (MOVE O1 0 O1)
             (MOVE O1 1 O1)
             (MOVE O3 0 O1)
             (MOVE O1 (CONSTANT 6))
             (MOVE O2 0 Q)
             (CALL LIST 3)
             (MOVE O2 O1)
             (MOVE O1 -2 Q)
             (CALL LIST 2)
             (MOVEM O1 -2 Q)
             (MOVE O2 -4 Q)
             (CALL CONS 2)
             (MOVEM O1 -2 Q)
             (MOVE O1 -3 Q)
             (MOVEM O1 -5 Q)
             (MOVE O1 -2 Q)
             (MOVEM O1 -4 Q)
             (JRST 10)
(LABEL 6)
(LABEL 5)
(LABEL 3)    (SUBI Q 11)
             (POPJ P)
)

(%PUT (QUOTE WITH-FORMAT-PARAMETERS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (PARMVAR PARMDEFS &BODY FORMS))) 
(%PUT (QUOTE WITH-FORMAT-PARAMETERS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE WITH-FORMAT-PARAMETERS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_NEXTCHAR MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(1 "Macro ~S cannot be called with ~S args." NEXTCHAR (IF (< (INCF *FORMAT-INDEX*) *FORMAT-LENGTH*) (SCHAR *FORMAT-CONTROL-STRING* *FORMAT-INDEX*) (FORMAT-ERROR "Syntax error")))
       (CODE-START)
(LABEL 1)    (ADDI Q 2)
             (MOVEM O1 -1 Q)
             (CALL LENGTH 1)
             (MOVEM O1 0 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL > 2)
             (JUMPE O1 4)
             (MOVE O1 -1 Q)
             (CALL LENGTH 1)
             (CALL 1- 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 (CONSTANT 2))
             (CALL ERROR 3)
             (JRST 3)
(LABEL 4)    (SKIPA)
             (JRST 5)
             (MOVE O1 (CONSTANT 3))
             (MOVEI N 1)
(LABEL 5)
(LABEL 3)    (SUBI Q 2)
             (POPJ P)
)

(%PUT (QUOTE NEXTCHAR) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE NEXTCHAR) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE NEXTCHAR) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PEEK MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(1 "Macro ~S cannot be called with ~S args." FORMAT-PEEK (SCHAR *FORMAT-CONTROL-STRING* *FORMAT-INDEX*))
       (CODE-START)
(LABEL 1)    (ADDI Q 2)
             (MOVEM O1 -1 Q)
             (CALL LENGTH 1)
             (MOVEM O1 0 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL > 2)
             (JUMPE O1 4)
             (MOVE O1 -1 Q)
             (CALL LENGTH 1)
             (CALL 1- 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 (CONSTANT 2))
             (CALL ERROR 3)
             (JRST 3)
(LABEL 4)    (SKIPA)
             (JRST 5)
             (MOVE O1 (CONSTANT 3))
             (MOVEI N 1)
(LABEL 5)
(LABEL 3)    (SUBI Q 2)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PEEK) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-PEEK) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PEEK) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-FIND-CHAR MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(4 "Macro ~S cannot be called with ~S args." FORMAT-FIND-CHAR POSITION (THE SIMPLE-STRING *FORMAT-CONTROL-STRING*) :START :END (:TEST (FUNCTION CHAR=)))
       (CODE-START)
(LABEL 1)    (ADDI Q 10)
             (MOVEM O1 -9 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -8 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL = 2)
             (JUMPN O1 4)
             (MOVE O1 -9 Q)
             (CALL LENGTH 1)
             (CALL 1- 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 (CONSTANT 2))
             (CALL ERROR 3)
             (JRST 3)
(LABEL 4)    (SKIPA)
             (JRST 5)
             (MOVE O1 -9 Q)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 -9 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 -9 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -4 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -2 Q)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -1 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 0 Q)
             (PUSH Q (CONSTANT 6))
             (PUSH Q -6 Q)
             (PUSH Q (CONSTANT 7))
             (MOVE O1 -7 Q)
             (MOVE O2 -6 Q)
             (MOVE O3 -5 Q)
             (MOVE O4 -4 Q)
             (MOVE O5 -3 Q)
             (CALL LIST* 8)
(LABEL 5)
(LABEL 3)    (SUBI Q 10)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-FIND-CHAR) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (CHAR START END))) 
(%PUT (QUOTE FORMAT-FIND-CHAR) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-FIND-CHAR) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-GET-PARAMETER EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-CONTROL-STRING* *FORMAT-INDEX* #\# *FORMAT-LENGTH* "Syntax error" *FORMAT-ARGUMENTS* (#\V #\v) :TEST EQL "Missing argument" #\' (#\0 #\1 #\2 #\3 #\4 #\5 #\6 #\7 #\8 #\9) 10 #\- #\+)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -5 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -6 Q)
             (MOVE O2 (CONSTANT 2))
             (CAME O2 -6 Q)
             (JRST 4)
             (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -4 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -5 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 5)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -5 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 6)
(LABEL 5)    (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 6)    (MOVE O1 (SPECIAL 5))
             (CALL LENGTH 1)
             (JRST 3)
(LABEL 4)    (MOVE O4 (CONSTANT 8))
             (MOVE O1 -6 Q)
             (MOVE O2 (CONSTANT 6))
             (MOVE O3 (CONSTANT 7))
             (CALL MEMBER 4)
             (JUMPE O1 7)
             (SKIPN NIL (SPECIAL 5))
             (JRST 8)
             (MOVE O1 (SPECIAL 5))
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 (SPECIAL 5))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 5))
             (MOVEM O5 -5 Q)
             (JRST 9)
(LABEL 8)    (MOVE O1 (CONSTANT 9))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -5 Q)
(LABEL 9)    (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -3 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -4 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 10)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -4 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 11)
(LABEL 10)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 11)   (MOVE O1 -5 Q)
             (MOVEI N 1)
             (JRST 3)
(LABEL 7)    (MOVE O2 (CONSTANT 10))
             (CAME O2 -6 Q)
             (JRST 12)
             (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -4 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -5 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 13)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -5 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -5 Q)
             (JRST 14)
(LABEL 13)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -5 Q)
(LABEL 14)   (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -3 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -4 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 15)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -4 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 16)
(LABEL 15)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 16)   (MOVE O1 -5 Q)
             (MOVEI N 1)
             (JRST 3)
(LABEL 12)   (MOVE O4 (CONSTANT 8))
             (MOVE O1 -6 Q)
             (MOVE O2 (CONSTANT 11))
             (MOVE O3 (CONSTANT 7))
             (CALL MEMBER 4)
             (JUMPE O1 17)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -3 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (CALL DIGIT-CHAR-P 1)
             (MOVEM O1 -4 Q)
(LABEL 22)   (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -3 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 25)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -3 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 26)
(LABEL 25)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 26)   (CALL DIGIT-CHAR-P 1)
             (JUMPN O1 23)
             (MOVE O1 -4 Q)
             (MOVEI N 1)
             (JRST 18)
(LABEL 23)   (MOVE O2 -4 Q)
             (MOVE O1 (CONSTANT 12))
             (CALL * 2)
             (MOVEM O1 -3 Q)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (CALL DIGIT-CHAR-P 1)
             (MOVE O2 O1)
             (MOVE O1 -3 Q)
             (CALL + 2)
             (MOVEM O1 -4 Q)
             (JRST 22)
(LABEL 18)   (JRST 3)
(LABEL 17)   (MOVE O2 (CONSTANT 13))
             (CAME O2 -6 Q)
             (JRST 27)
             (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -4 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -5 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 28)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -5 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 29)
(LABEL 28)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 29)   (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -3 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -4 Q)
             (MOVE O4 (CONSTANT 8))
             (MOVE O2 (CONSTANT 11))
             (MOVE O3 (CONSTANT 7))
             (CALL MEMBER 4)
             (JUMPE O1 31)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (CALL DIGIT-CHAR-P 1)
             (MOVEM O1 -2 Q)
(LABEL 36)   (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 39)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 40)
(LABEL 39)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 40)   (CALL DIGIT-CHAR-P 1)
             (JUMPN O1 37)
             (MOVE O1 -2 Q)
             (CALL - 1)
             (JRST 32)
(LABEL 37)   (MOVE O2 -2 Q)
             (MOVE O1 (CONSTANT 12))
             (CALL * 2)
             (MOVEM O1 -1 Q)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 0 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (CALL DIGIT-CHAR-P 1)
             (MOVE O2 O1)
             (MOVE O1 -1 Q)
             (CALL + 2)
             (MOVEM O1 -2 Q)
             (JRST 36)
(LABEL 32)   (JRST 30)
(LABEL 31)   (SKIPA)
             (JRST 41)
             (MOVE O1 (SPECIAL 1))
             (CALL 1- 1)
             (MOVEM O1 -2 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 41)
(LABEL 30)   (JRST 3)
(LABEL 27)   (MOVE O2 (CONSTANT 14))
             (CAME O2 -6 Q)
             (JRST 43)
             (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -4 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -5 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 44)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -5 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 45)
(LABEL 44)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 45)   (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -3 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -4 Q)
             (MOVE O4 (CONSTANT 8))
             (MOVE O2 (CONSTANT 11))
             (MOVE O3 (CONSTANT 7))
             (CALL MEMBER 4)
             (JUMPE O1 47)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (CALL DIGIT-CHAR-P 1)
             (MOVEM O1 -2 Q)
(LABEL 52)   (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 55)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 56)
(LABEL 55)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 56)   (CALL DIGIT-CHAR-P 1)
             (JUMPN O1 53)
             (MOVE O1 -2 Q)
             (MOVEI N 1)
             (JRST 48)
(LABEL 53)   (MOVE O2 -2 Q)
             (MOVE O1 (CONSTANT 12))
             (CALL * 2)
             (MOVEM O1 -1 Q)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 0 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (CALL DIGIT-CHAR-P 1)
             (MOVE O2 O1)
             (MOVE O1 -1 Q)
             (CALL + 2)
             (MOVEM O1 -2 Q)
             (JRST 52)
(LABEL 48)   (JRST 46)
(LABEL 47)   (SKIPA)
             (JRST 57)
             (MOVE O1 (SPECIAL 1))
             (CALL 1- 1)
             (MOVEM O1 -2 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 57)
(LABEL 46)   (JRST 3)
(LABEL 43)   (SKIPA)
             (JRST 59)
             (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 59)
(LABEL 3)    (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-GET-PARAMETER) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-GET-PARAMETER) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-GET-PARAMETER) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_PARSE-FORMAT-OPERATION EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" (#\, #\# #\V #\v #\' #\+ #\-) :TEST CHAR= #\, #\: #\@)
       (CODE-START)
(LABEL 1)    (ADDI Q 5)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -3 Q)
             (MOVE O2 (SPECIAL 1))
             (CALL < 2)
             (JUMPE O1 3)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -3 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -4 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -4 Q)
(LABEL 4)    (MOVE O1 -4 Q)
             (CALL DIGIT-CHAR-P 1)
             (JUMPN1 O1 7)
             (MOVE O4 (CONSTANT 6))
             (MOVE O1 -4 Q)
             (MOVE O2 (CONSTANT 4))
             (MOVE O3 (CONSTANT 5))
             (CALL MEMBER 4)
             (SKIPN NIL O1)
(LABEL 7)    (JRST 5)
             (CALL LISP::FORMAT-GET-PARAMETER 0)
             (CALL LIST 1)
             (MOVEM O1 -2 Q)
(LABEL 12)   (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 (CONSTANT 7))
             (CAMN O2 -1 Q)
             (JRST 13)
             (MOVE O1 -2 Q)
             (CALL NREVERSE 1)
             (MOVEM O1 -3 Q)
             (JRST 8)
(LABEL 13)   (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (CALL < 2)
             (JUMPE O1 15)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 16)
(LABEL 15)   (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 16)   (CALL LISP::FORMAT-GET-PARAMETER 0)
             (MOVEM O1 -1 Q)
             (MOVE O2 -2 Q)
             (CALL CONS 2)
             (MOVEM O1 -2 Q)
             (JRST 12)
(LABEL 8)    (JRST 6)
(LABEL 5)    (MOVE O5 NIL)
             (MOVEM O5 -3 Q)
(LABEL 6)    (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -2 Q)
             (MOVE O2 (CONSTANT 8))
             (CAME O2 -2 Q)
             (JRST 17)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -2 Q)
             (MOVE O2 (SPECIAL 1))
             (CALL < 2)
             (JUMPE O1 19)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -2 Q)
             (JRST 20)
(LABEL 19)   (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -2 Q)
(LABEL 20)   (JRST 18)
(LABEL 17)   (MOVEM NIL -2 Q)
(LABEL 18)   (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 (CONSTANT 9))
             (CAME O2 -1 Q)
             (JRST 21)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (CALL < 2)
             (JUMPE O1 23)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVEM O1 -1 Q)
             (JRST 24)
(LABEL 23)   (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -1 Q)
(LABEL 24)   (JRST 22)
(LABEL 21)   (MOVEM NIL -1 Q)
(LABEL 22)   (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (MOVE O4 O1)
             (MOVE O1 -3 Q)
             (MOVE O2 -2 Q)
             (MOVE O3 -1 Q)
             (MOVEI N 4)
             (SUBI Q 5)
             (POPJ P)
)

(%PUT (QUOTE PARSE-FORMAT-OPERATION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE PARSE-FORMAT-OPERATION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE PARSE-FORMAT-OPERATION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-FIND-COMMAND EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-INDEX* #\~ *FORMAT-CONTROL-STRING* :START :END *FORMAT-LENGTH* :TEST CHAR= "Expecting one of ~S" #\{ "Syntax error" (#\}) #\< (#\>) #\( (#\)) #\[ (#\]) (#\} #\> #\) #\]) EQL "No matching bracket")
       (CODE-START)
(LABEL 1)    (ADDI Q 14)
             (MOVEM O1 -13 Q)
             (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -12 Q)
             (MOVEM O5 -11 Q)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -9 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -8 Q)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -7 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -6 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -5 Q)
             (PUSH Q (SPECIAL 5))
             (PUSH Q (CONSTANT 6))
             (PUSH Q (CONSTANT 7))
             (MOVE O1 -12 Q)
             (MOVE O2 -11 Q)
             (MOVE O3 -10 Q)
             (MOVE O4 -9 Q)
             (MOVE O5 -8 Q)
             (CALL POSITION 8)
             (MOVEM O1 -10 Q)
(LABEL 7)    (SKIPE NIL -10 Q)
             (JRST 8)
             (MOVE O2 -13 Q)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-ERROR 2)
             (JRST 3)
(LABEL 8)    (MOVE O1 -10 Q)
             (MOVEM O1 (SPECIAL 0))
             (CALL LISP::PARSE-FORMAT-OPERATION 0)
             (ADJUST-VALUES 4)
             (MOVEM O1 -8 Q)
             (MOVEM O2 -7 Q)
             (MOVEM O3 -6 Q)
             (MOVEM O4 -5 Q)
             (MOVE O4 (CONSTANT 7))
             (MOVE O1 -5 Q)
             (MOVE O2 -13 Q)
             (MOVE O3 (CONSTANT 6))
             (CALL MEMBER 4)
             (JUMPE O1 11)
             (MOVE O5 -12 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -10 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -8 Q)
             (MOVEM O5 -2 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -1 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 0 Q)
             (PUSH Q -5 Q)
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL VALUES 6)
             (JRST 3)
(LABEL 11)   (MOVE O5 -5 Q)
             (MOVEM O5 -3 Q)
             (MOVE O2 (CONSTANT 9))
             (CAME O2 -3 Q)
             (JRST 14)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -2 Q)
             (MOVE O2 (SPECIAL 5))
             (CALL < 2)
             (JUMPE O1 15)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 16)
(LABEL 15)   (MOVE O1 (CONSTANT 10))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 16)   (MOVE O1 (CONSTANT 11))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (JRST 13)
(LABEL 14)   (MOVE O2 (CONSTANT 12))
             (CAME O2 -3 Q)
             (JRST 17)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -2 Q)
             (MOVE O2 (SPECIAL 5))
             (CALL < 2)
             (JUMPE O1 18)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 19)
(LABEL 18)   (MOVE O1 (CONSTANT 10))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 19)   (MOVE O1 (CONSTANT 13))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (JRST 13)
(LABEL 17)   (MOVE O2 (CONSTANT 14))
             (CAME O2 -3 Q)
             (JRST 20)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -2 Q)
             (MOVE O2 (SPECIAL 5))
             (CALL < 2)
             (JUMPE O1 21)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 22)
(LABEL 21)   (MOVE O1 (CONSTANT 10))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 22)   (MOVE O1 (CONSTANT 15))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (JRST 13)
(LABEL 20)   (MOVE O2 (CONSTANT 16))
             (CAME O2 -3 Q)
             (JRST 23)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -2 Q)
             (MOVE O2 (SPECIAL 5))
             (CALL < 2)
             (JUMPE O1 24)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 25)
(LABEL 24)   (MOVE O1 (CONSTANT 10))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 25)   (MOVE O1 (CONSTANT 17))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (JRST 13)
(LABEL 23)   (MOVE O4 (CONSTANT 19))
             (MOVE O1 -3 Q)
             (MOVE O2 (CONSTANT 18))
             (MOVE O3 (CONSTANT 6))
             (CALL MEMBER 4)
             (JUMPE O1 26)
             (MOVE O1 (CONSTANT 20))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 26)
(LABEL 13)   (MOVE O5 (SPECIAL 0))
             (MOVEM O5 -9 Q)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -8 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -7 Q)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -6 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -4 Q)
             (PUSH Q (SPECIAL 5))
             (PUSH Q (CONSTANT 6))
             (PUSH Q (CONSTANT 7))
             (MOVE O1 -11 Q)
             (MOVE O2 -10 Q)
             (MOVE O3 -9 Q)
             (MOVE O4 -8 Q)
             (MOVE O5 -7 Q)
             (CALL POSITION 8)
             (MOVEM O1 -8 Q)
             (MOVE O1 -9 Q)
             (MOVEM O1 -11 Q)
             (MOVE O1 -8 Q)
             (MOVEM O1 -10 Q)
             (JRST 7)
(LABEL 3)    (SUBI Q 14)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-FIND-COMMAND) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COMMAND-LIST))) 
(%PUT (QUOTE FORMAT-FIND-COMMAND) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-FIND-COMMAND) (QUOTE %SOURCE-DOCUMENTATION)))) 
(%PUT (QUOTE FORMAT) (QUOTE %FUN-DOCUMENTATION) (QUOTE "Provides various facilities for formatting output.
  CONTROL-STRING contains a string to be output, possibly with embedded
  directives, which are flagged with the escape character \"~\".  Directives
  generally expand into additional text to be output, usually consuming one
  or more of the FORMAT-ARGUMENTS in the process.  A few useful directives
  are:
        ~A or ~nA     Prints one argument as if by PRINC
        ~S or ~nS     Prints one argument as if by PRIN1
        ~D or ~nD     Prints one argument as a decimal integer
        ~%            Does a TERPRI
        ~&            Does a FRESH-LINE

         where n is the width of the field in which the object is printed.
  
  DESTINATION controls where the result will go.  If DESTINATION is T, then
  the output is sent to the standard output stream.  If it is NIL, then the
  output is returned in a string as the value of the call.  Otherwise,
  DESTINATION must be a stream to which the output will be sent.

  Example:   (FORMAT NIL \"The answer is ~D.\" 10) => \"The answer is 10.\"

  FORMAT has many additional capabilities not described here.  Consult the
  manual for details.")) 

#_(LAP #0_FORMAT EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2 3 4 5 6) REST)
       #0_(SIMPLE-STRING *FORMAT-ORIGINAL-ARGUMENTS* *FORMAT-ARGUMENTS* *FORMAT-CONTROL-STRING* *FORMAT-STREAM-STACK* *STANDARD-OUTPUT* FORMAT-ERROR FORMAT-ESCAPE FORMAT-COLON-ESCAPE 0 "~%~:{~@?~%~}" "~%~:{~?~%~}" T)
       (CODE-START)
(LABEL 2)    (MOVE O3 NIL)
             (JRST 1)
(LABEL 3)    (MOVEI W2 1)
             (ICALL REST3)
             (JRST 1)
(LABEL 4)    (MOVEI W2 2)
             (ICALL REST4)
             (JRST 1)
(LABEL 5)    (MOVEI W2 3)
             (ICALL REST5)
             (JRST 1)
(LABEL 6)    (MOVEI W2 2)
             (ICALL RESTX)
(LABEL 1)    (ADDI Q 10)
             (MOVEM O1 -9 Q)
             (MOVEM O2 -8 Q)
             (MOVEM O3 -7 Q)
             (MOVE O5 O3)
             (MOVEM O5 -6 Q)
             (MOVEM O5 -5 Q)
             (MOVE O1 O2)
             (CALL SIMPLE-STRING-P 1)
             (JUMPE O1 8)
             (MOVE O5 -8 Q)
             (MOVEM O5 -4 Q)
             (JRST 9)
(LABEL 8)    (MOVE O2 (CONSTANT 0))
             (MOVE O1 -8 Q)
             (CALL COERCE 2)
             (MOVEM O1 -4 Q)
(LABEL 9)    (MOVE O1 -6 Q)
             (SPEC-BIND (SPECIAL 1))
             (MOVEM O1 (SPECIAL 1))
             (MOVE O1 -5 Q)
             (SPEC-BIND (SPECIAL 2))
             (MOVEM O1 (SPECIAL 2))
             (MOVE O1 -4 Q)
             (SPEC-BIND (SPECIAL 3))
             (MOVEM O1 (SPECIAL 3))
             (SKIPE NIL -9 Q)
             (JRST 11)
             (SKIPN NIL (SPECIAL 4))
             (JRST 12)
             (MOVE O1 (SPECIAL 4))
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 (SPECIAL 4))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 4))
             (MOVEM O5 -3 Q)
             (JRST 13)
(LABEL 12)   (CALL MAKE-STRING-OUTPUT-STREAM 0)
             (MOVEM O1 -3 Q)
(LABEL 13)   (MOVE O1 -3 Q)
             (SPEC-BIND (SPECIAL 5))
             (MOVEM O1 (SPECIAL 5))
             (ICALL CUNWIND)
             (JRST 14)
             (JRST 15)
             (MOVE O1 (CONSTANT 6))
             (ICALL CCATCH)
             (JRST 16)
             (MOVE O1 (CONSTANT 7))
             (ICALL CCATCH)
             (JRST 17)
             (MOVE O1 (CONSTANT 8))
             (ICALL CCATCH)
             (JRST 18)
             (MOVE O1 -8 Q)
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 9))
             (CALL LISP::SUB-FORMAT 2)
             (POPJ P)
(LABEL 18)   (POPJ P)
(LABEL 17)   (MOVE O1 NIL)
             (MOVEI N 1)
             (POPJ P)
(LABEL 16)   (MOVEM O1 -1 Q)
             (SKIPN NIL -1 Q)
             (JRST 20)
             (MOVE O1 -1 Q)
             (CALL NREVERSE 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 10))
             (CALL ERROR 2)
(LABEL 20)   (MOVE O1 (SPECIAL 5))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (MOVEM O1 -2 Q)
             (MOVE O5 (SPECIAL 5))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 4))
             (MOVE O1 O5)
             (CALL CONS 2)
             (MOVEM O1 (SPECIAL 4))
             (MOVE O1 -2 Q)
             (MOVEI N 1)
             (POPJ P)
(LABEL 14)   (MOVE O1 (SPECIAL 5))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (POPJ P)
(LABEL 15)   (UNBIND 1)
             (JRST 10)
(LABEL 11)   (MOVE O1 -9 Q)
             (CALL STRINGP 1)
             (JUMPE O1 23)
             (MOVE O1 -9 Q)
             (CALL ARRAY-HAS-FILL-POINTER-P 1)
             (SKIPN NIL O1)
(LABEL 23)   (JRST 22)
             (MOVE O1 -9 Q)
             (CALL LISP::MAKE-FILL-POINTER-OUTPUT-STREAM 1)
             (MOVEM O1 -3 Q)
             (MOVEM NIL -2 Q)
             (SPEC-BIND (SPECIAL 5))
             (MOVEM O1 (SPECIAL 5))
             (ICALL CUNWIND)
             (JRST 25)
             (JRST 26)
             (MOVE O1 (CONSTANT 6))
             (ICALL CCATCH)
             (JRST 27)
             (MOVE O1 (CONSTANT 7))
             (ICALL CCATCH)
             (JRST 28)
             (MOVE O1 (CONSTANT 8))
             (ICALL CCATCH)
             (JRST 29)
             (MOVE O1 -8 Q)
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 9))
             (CALL LISP::SUB-FORMAT 2)
             (POPJ P)
(LABEL 29)   (POPJ P)
(LABEL 28)   (MOVE O1 NIL)
             (MOVEI N 1)
             (POPJ P)
(LABEL 27)   (MOVEM O1 0 Q)
             (SKIPN NIL 0 Q)
             (JRST 31)
             (MOVE O1 0 Q)
             (CALL REVERSE 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 11))
             (CALL ERROR 2)
(LABEL 31)   (MOVE O1 NIL)
             (MOVEM O1 -2 Q)
             (POPJ P)
(LABEL 25)   (MOVE O1 (SPECIAL 5))
             (CALL CLOSE 1)
             (POPJ P)
(LABEL 26)   (MOVE O1 -2 Q)
             (MOVEI N 1)
             (UNBIND 1)
             (JRST 10)
(LABEL 22)   (SKIPA)
             (JRST 33)
             (MOVE O2 (CONSTANT 12))
             (CAME O2 -9 Q)
             (JRST 34)
             (MOVE O5 (SPECIAL 5))
             (MOVEM O5 -3 Q)
             (JRST 35)
(LABEL 34)   (MOVE O5 -9 Q)
             (MOVEM O5 -3 Q)
(LABEL 35)   (MOVE O1 -3 Q)
             (SPEC-BIND (SPECIAL 5))
             (MOVEM O1 (SPECIAL 5))
             (MOVE O1 (CONSTANT 6))
             (ICALL CCATCH)
             (JRST 36)
             (MOVE O1 (CONSTANT 7))
             (ICALL CCATCH)
             (JRST 37)
             (MOVE O1 (CONSTANT 8))
             (ICALL CCATCH)
             (JRST 38)
             (MOVE O1 -8 Q)
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 9))
             (CALL LISP::SUB-FORMAT 2)
             (POPJ P)
(LABEL 38)   (POPJ P)
(LABEL 37)   (MOVE O1 NIL)
             (MOVEI N 1)
             (POPJ P)
(LABEL 36)   (MOVEM O1 -1 Q)
             (SKIPN NIL -1 Q)
             (JRST 40)
             (MOVE O1 -1 Q)
             (CALL NREVERSE 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 10))
             (CALL ERROR 2)
(LABEL 40)   (MOVE O1 NIL)
             (MOVEI N 1)
             (UNBIND 1)
(LABEL 33)
(LABEL 10)   (UNBIND 3)
             (SUBI Q 10)
             (POPJ P)
)

(%PUT (QUOTE FORMAT) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (DESTINATION CONTROL-STRING &REST FORMAT-ARGUMENTS))) 
(%PUT (QUOTE FORMAT) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_SUB-FORMAT EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-INDEX* *FORMAT-LENGTH* #\~ *FORMAT-CONTROL-STRING* :START :END :TEST CHAR= *STANDARD-OUTPUT* *FORMAT-DISPATCH-TABLE* "Illegal FORMAT command ~~~S")
       (CODE-START)
(LABEL 1)    (ADDI Q 13)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVE O5 O1)
             (MOVEM O5 -10 Q)
             (MOVE O5 O2)
             (MOVEM O5 -9 Q)
             (SPEC-BIND (SPECIAL 0))
             (MOVEM O1 (SPECIAL 0))
             (MOVE O1 -9 Q)
             (SPEC-BIND (SPECIAL 1))
             (MOVEM O1 (SPECIAL 1))
             (MOVE O5 -12 Q)
             (MOVEM O5 -8 Q)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -6 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -5 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -4 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -2 Q)
             (PUSH Q -11 Q)
             (PUSH Q (CONSTANT 6))
             (PUSH Q (CONSTANT 7))
             (MOVE O1 -9 Q)
             (MOVE O2 -8 Q)
             (MOVE O3 -7 Q)
             (MOVE O4 -6 Q)
             (MOVE O5 -5 Q)
             (CALL POSITION 8)
             (MOVEM O1 -7 Q)
(LABEL 7)    (SKIPE NIL -7 Q)
             (JRST 8)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -6 Q)
             (MOVE O5 (SPECIAL 8))
             (MOVEM O5 -5 Q)
             (MOVE O4 -11 Q)
             (MOVE O1 -6 Q)
             (MOVE O2 O5)
             (MOVE O3 -8 Q)
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 3)
(LABEL 8)    (MOVE O2 -8 Q)
             (MOVE O1 -7 Q)
             (CALL > 2)
             (JUMPE O1 11)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -6 Q)
             (MOVE O5 (SPECIAL 8))
             (MOVEM O5 -5 Q)
             (MOVE O4 -7 Q)
             (MOVE O1 -6 Q)
             (MOVE O2 O5)
             (MOVE O3 -8 Q)
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 11)   (MOVE O1 -7 Q)
             (MOVEM O1 (SPECIAL 0))
             (CALL LISP::PARSE-FORMAT-OPERATION 0)
             (ADJUST-VALUES 4)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (MOVEM O4 -2 Q)
             (MOVE O5 (SPECIAL 9))
             (MOVEM O5 0 Q)
             (MOVE O1 O4)
             (CALL CHAR-CODE 1)
             (MOVE O2 O1)
             (MOVE O1 0 Q)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (SKIPN NIL -1 Q)
             (JRST 13)
             (MOVE O5 -1 Q)
             (MOVEM O5 0 Q)
             (MOVE O3 -5 Q)
             (MOVE O1 -4 Q)
             (MOVE O2 -3 Q)
             (MOVE O6 O5)
             (FCALL 3)
             (JRST 14)
(LABEL 13)   (MOVE O2 -2 Q)
             (MOVE O1 (CONSTANT 10))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 14)   (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -5 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -6 Q)
             (MOVE O2 -11 Q)
             (CALL < 2)
             (JUMPN O1 16)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 3)
(LABEL 16)   (MOVE O1 (SPECIAL 0))
             (MOVEM O1 -8 Q)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -6 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -5 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -4 Q)
             (MOVE O5 O1)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -2 Q)
             (PUSH Q -11 Q)
             (PUSH Q (CONSTANT 6))
             (PUSH Q (CONSTANT 7))
             (MOVE O1 -9 Q)
             (MOVE O2 -8 Q)
             (MOVE O3 -7 Q)
             (MOVE O4 -6 Q)
             (MOVE O5 -5 Q)
             (CALL POSITION 8)
             (MOVEM O1 -7 Q)
             (JRST 7)
(LABEL 3)    (UNBIND 2)
             (SUBI Q 13)
             (POPJ P)
)

(%PUT (QUOTE SUB-FORMAT) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (START END))) 
(%PUT (QUOTE SUB-FORMAT) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE SUB-FORMAT) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-CAPITALIZATION EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("No parameters allowed to ~~(" *FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" (#\)) "Flags or parameters not allowed" *FORMAT-STREAM-STACK* *STANDARD-OUTPUT* 0)
       (CODE-START)
(LABEL 1)    (ADDI Q 14)
             (MOVEM O1 -13 Q)
             (MOVEM O2 -12 Q)
             (MOVEM O3 -11 Q)
             (SKIPN NIL -11 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (MOVE O1 (SPECIAL 1))
             (CALL 1+ 1)
             (MOVEM O1 -9 Q)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O1 -10 Q)
             (MOVE O2 (SPECIAL 2))
             (CALL < 2)
             (JUMPE O1 6)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -10 Q)
             (MOVE O2 (SPECIAL 1))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 7)
(LABEL 6)    (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 7)    (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 5)
             (MOVEM O1 -9 Q)
             (MOVEM O2 -8 Q)
             (MOVEM O3 -7 Q)
             (MOVEM O4 -6 Q)
             (MOVEM O5 -5 Q)
             (SKIPE NIL -7 Q)
             (JRST1 10)
             (SKIPE NIL -6 Q)
             (JRST1 10)
             (SKIPN NIL -5 Q)
(LABEL 10)   (JRST 9)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 9)    (SKIPN NIL (SPECIAL 7))
             (JRST 12)
             (MOVE O1 (SPECIAL 7))
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O1 (SPECIAL 7))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 7))
             (MOVEM O5 -2 Q)
             (JRST 13)
(LABEL 12)   (CALL MAKE-STRING-OUTPUT-STREAM 0)
             (MOVEM O1 -2 Q)
(LABEL 13)   (MOVE O1 -2 Q)
             (SPEC-BIND (SPECIAL 8))
             (MOVEM O1 (SPECIAL 8))
             (ICALL CUNWIND)
             (JRST 14)
             (JRST 15)
             (MOVE O2 -8 Q)
             (MOVE O1 -9 Q)
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O1 (SPECIAL 8))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (MOVEM O1 -1 Q)
             (MOVE O5 (SPECIAL 8))
             (MOVEM O5 0 Q)
             (MOVE O2 (SPECIAL 7))
             (MOVE O1 O5)
             (CALL CONS 2)
             (MOVEM O1 (SPECIAL 7))
             (MOVE O5 -1 Q)
             (MOVEM O5 -4 Q)
             (POPJ P)
(LABEL 14)   (MOVE O1 (SPECIAL 8))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (POPJ P)
(LABEL 15)   (UNBIND 1)
             (SKIPN NIL -12 Q)
             (JRST 18)
             (SKIPN NIL -13 Q)
(LABEL 18)   (JRST 17)
             (MOVE O1 -4 Q)
             (CALL NSTRING-UPCASE 1)
             (MOVEM O1 -3 Q)
             (JRST 16)
(LABEL 17)   (SKIPN NIL -13 Q)
             (JRST 20)
             (MOVE O1 -4 Q)
             (CALL NSTRING-CAPITALIZE 1)
             (MOVEM O1 -3 Q)
             (JRST 16)
(LABEL 20)   (SKIPN NIL -12 Q)
             (JRST 21)
             (MOVE O1 -4 Q)
             (CALL NSTRING-DOWNCASE 1)
             (MOVE O5 (CONSTANT 9))
             (MOVEM O5 -2 Q)
             (MOVE O1 -4 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -1 Q)
(LABEL 26)   (MOVE O2 -1 Q)
             (MOVE O1 -2 Q)
             (CALL < 2)
             (JUMPN O1 27)
             (MOVE O5 -4 Q)
             (MOVEM O5 -3 Q)
             (JRST 22)
(LABEL 27)   (MOVE O2 -2 Q)
             (MOVE O1 -4 Q)
             (CALL AREF 2)
             (CALL ALPHA-CHAR-P 1)
             (JUMPE O1 30)
             (MOVE O2 -2 Q)
             (MOVE O1 -4 Q)
             (CALL AREF 2)
             (CALL CHAR-UPCASE 1)
             (MOVE O3 O1)
             (MOVE O1 -4 Q)
             (MOVE O2 -2 Q)
             (CALL LISP::%CHARSET 3)
             (MOVE O5 -4 Q)
             (MOVEM O5 -3 Q)
             (JRST 22)
(LABEL 30)   (MOVE O1 -2 Q)
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (JRST 26)
(LABEL 22)   (JRST 16)
(LABEL 21)   (SKIPA)
             (JRST 32)
             (MOVE O1 -4 Q)
             (CALL NSTRING-DOWNCASE 1)
             (MOVEM O1 -3 Q)
(LABEL 32)
(LABEL 16)   (MOVE O5 (SPECIAL 8))
             (MOVEM O5 -2 Q)
             (MOVE O4 NIL)
             (MOVE O1 -3 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 9))
             (CALL LISP::%SP-WRITE-STRING 4)
             (SUBI Q 14)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-CAPITALIZATION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-CAPITALIZATION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-CAPITALIZATION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-ESCAPE EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("FORMAT command ~~~:[~;:~]@^ is undefined" INTEGER CHARACTER *FORMAT-ARGUMENTS* FORMAT-COLON-ESCAPE FORMAT-ESCAPE)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (SKIPN NIL -5 Q)
             (JRST 4)
             (MOVE O2 -6 Q)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 4)    (MOVE O1 -4 Q)
             (SKIPN NIL 0 O1)
             (JRST 8)
             (MOVE O1 -4 Q)
             (MOVE O1 1 O1)
             (SKIPN NIL 0 O1)
             (JRST 10)
             (MOVE O1 -4 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (SKIPN NIL 0 O1)
             (JRST 12)
             (MOVE O1 -4 Q)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O2 (CONSTANT 1))
             (MOVE O1 O5)
             (CALL TYPEP 2)
             (JUMPE O1 15)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 -4 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O3 0 O1)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (CALL <= 3)
             (JRST 14)
(LABEL 15)   (MOVE O2 (CONSTANT 2))
             (MOVE O1 -2 Q)
             (CALL TYPEP 2)
             (JUMPE O1 16)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 -4 Q)
             (MOVE O1 1 O1)
             (MOVE O1 1 O1)
             (MOVE O3 0 O1)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (CALL CHAR< 3)
             (JRST 14)
(LABEL 16)   (SKIPA)
             (JRST 17)
             (MOVE O1 NIL)
(LABEL 17)
(LABEL 14)   (JUMPE O1 13)
             (JRST1 13)
(LABEL 12)   (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -3 Q)
             (MOVE O1 1 O1)
             (MOVE O2 0 O1)
             (MOVE O1 O5)
             (CALL EQUAL 2)
             (SKIPN NIL O1)
(LABEL 13)   (JRST 11)
             (JRST1 11)
(LABEL 10)   (MOVE O1 -4 Q)
             (MOVE O1 0 O1)
             (CALL ZEROP 1)
             (SKIPN NIL O1)
(LABEL 11)   (JRST 9)
             (JRST1 9)
(LABEL 8)    (SKIPE NIL (SPECIAL 3))
(LABEL 9)    (JRST 7)
             (SKIPN NIL -6 Q)
             (JRST 19)
             (MOVE O1 (CONSTANT 4))
             (JRST 20)
(LABEL 19)   (MOVE O1 (CONSTANT 5))
(LABEL 20)   (ICALL CTHROW)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (POPJ P)
             (JRST 6)
(LABEL 7)    (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 6)    (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-ESCAPE) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-ESCAPE) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-ESCAPE) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-UNTAGGED-CONDITION EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" "Argument to ~~[ must be integer - ~S" 0 (#\; #\]) "Atsign flag not allowed" "No parameters allowed" #\] (#\]) "Parameters not allowed" *FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error")
       (CODE-START)
(LABEL 1)    (ADDI Q 16)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 -14 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 -15 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -15 Q)
(LABEL 4)    (MOVE O1 -15 Q)
             (CALL INTEGERP 1)
             (JUMPN O1 6)
             (MOVE O2 -15 Q)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 6)    (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -13 Q)
(LABEL 12)   (MOVE O2 -15 Q)
             (MOVE O1 -13 Q)
             (CALL = 2)
             (JUMPE O1 13)
             (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 6)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVEM O3 -10 Q)
             (MOVEM O4 -9 Q)
             (MOVEM O5 -8 Q)
             (MOVE W2 MVP)
             (ADDI W2 6)
             (POP W2 -7 Q)
             (SKIPN NIL -8 Q)
             (JRST 16)
             (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 16)   (SKIPN NIL -10 Q)
             (JRST 19)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 19)   (MOVE O2 -11 Q)
             (MOVE O1 -12 Q)
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O2 (CONSTANT 7))
             (CAMN O2 -7 Q)
             (JRST 22)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (JRST 21)
(LABEL 22)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 21)   (JRST 8)
(LABEL 13)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 6)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVEM O3 -10 Q)
             (MOVEM O4 -9 Q)
             (MOVEM O5 -8 Q)
             (MOVE W2 MVP)
             (ADDI W2 6)
             (POP W2 -7 Q)
             (SKIPN NIL -8 Q)
             (JRST 25)
             (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 25)   (SKIPN NIL -10 Q)
             (JRST 28)
             (MOVE O1 (CONSTANT 9))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 28)   (MOVE O2 (CONSTANT 7))
             (CAME O2 -7 Q)
             (JRST 31)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 8)
(LABEL 31)   (SKIPN NIL -9 Q)
             (JRST 34)
             (MOVE O1 (SPECIAL 10))
             (CALL 1+ 1)
             (MOVEM O1 -5 Q)
             (MOVEM O1 (SPECIAL 10))
             (MOVEM O1 -6 Q)
             (MOVE O2 (SPECIAL 11))
             (CALL < 2)
             (JUMPE O1 35)
             (MOVE O5 (SPECIAL 12))
             (MOVEM O5 -6 Q)
             (MOVE O2 (SPECIAL 10))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 36)
(LABEL 35)   (MOVE O1 (CONSTANT 13))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 36)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 6)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (MOVEM O4 -2 Q)
             (MOVEM O5 -1 Q)
             (MOVE W2 MVP)
             (ADDI W2 6)
             (POP W2 0 Q)
             (MOVE O2 -4 Q)
             (MOVE O1 -5 Q)
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O2 (CONSTANT 7))
             (CAMN O2 0 Q)
             (JRST 38)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
(LABEL 38)   (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 8)
(LABEL 34)   (MOVE O1 (SPECIAL 10))
             (CALL 1+ 1)
             (MOVEM O1 -5 Q)
             (MOVEM O1 (SPECIAL 10))
             (MOVEM O1 -6 Q)
             (MOVE O2 (SPECIAL 11))
             (CALL < 2)
             (JUMPE O1 41)
             (MOVE O5 (SPECIAL 12))
             (MOVEM O5 -6 Q)
             (MOVE O2 (SPECIAL 10))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 42)
(LABEL 41)   (MOVE O1 (CONSTANT 13))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 42)   (MOVE O1 -13 Q)
             (CALL 1+ 1)
             (MOVEM O1 -13 Q)
             (JRST 12)
(LABEL 8)    (SUBI Q 16)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-UNTAGGED-CONDITION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-UNTAGGED-CONDITION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-UNTAGGED-CONDITION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-FUNNY-CONDITION EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_((#\]) "Flags or arguments not allowed" *FORMAT-ARGUMENTS* "Missing argument")
       (CODE-START)
(LABEL 1)    (ADDI Q 6)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 5)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (MOVEM O4 -2 Q)
             (MOVEM O5 -1 Q)
             (SKIPE NIL -2 Q)
             (JRST1 5)
             (SKIPE NIL -1 Q)
             (JRST1 5)
             (SKIPN NIL -3 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL (SPECIAL 2))
             (JRST 7)
             (MOVE O1 (SPECIAL 2))
             (SKIPN NIL 0 O1)
             (JRST 9)
             (MOVE O2 -4 Q)
             (MOVE O1 -5 Q)
             (CALL LISP::SUB-FORMAT 2)
             (JRST 10)
(LABEL 9)    (MOVE O1 (SPECIAL 2))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 2))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 2))
             (MOVE O1 O5)
             (MOVEI N 1)
(LABEL 10)   (JRST 8)
(LABEL 7)    (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 8)    (SUBI Q 6)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-FUNNY-CONDITION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-FUNNY-CONDITION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-FUNNY-CONDITION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-BOOLEAN-CONDITION EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_((#\;) "Flags or parameters not allowed" *FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" *FORMAT-ARGUMENTS* "Missing argument" (#\]))
       (CODE-START)
(LABEL 1)    (ADDI Q 11)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 5)
             (MOVEM O1 -10 Q)
             (MOVEM O2 -9 Q)
             (MOVEM O3 -8 Q)
             (MOVEM O4 -7 Q)
             (MOVEM O5 -6 Q)
             (SKIPE NIL -8 Q)
             (JRST1 5)
             (SKIPE NIL -7 Q)
             (JRST1 5)
             (SKIPN NIL -6 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (MOVE O1 (SPECIAL 2))
             (CALL 1+ 1)
             (MOVEM O1 -4 Q)
             (MOVEM O1 (SPECIAL 2))
             (MOVEM O1 -5 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 7)
             (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -5 Q)
             (MOVE O2 (SPECIAL 2))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 8)
(LABEL 7)    (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 8)    (SKIPN NIL (SPECIAL 6))
             (JRST 11)
             (MOVE O1 (SPECIAL 6))
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 (SPECIAL 6))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 6))
             (SKIPN NIL -5 Q)
             (JRST 12)
             (JRST1 12)
(LABEL 11)   (MOVE O1 (CONSTANT 7))
             (CALL LISP::FORMAT-ERROR 1)
             (SKIPN NIL O1)
(LABEL 12)   (JRST 9)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 5)
             (MOVEM O1 -4 Q)
             (MOVEM O2 -3 Q)
             (MOVEM O3 -2 Q)
             (MOVEM O4 -1 Q)
             (MOVEM O5 0 Q)
             (SKIPE NIL -1 Q)
             (JRST1 15)
             (SKIPE NIL 0 Q)
             (JRST1 15)
             (SKIPN NIL -2 Q)
(LABEL 15)   (JRST 14)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 14)   (MOVE O2 -3 Q)
             (MOVE O1 -4 Q)
             (CALL LISP::SUB-FORMAT 2)
             (JRST 10)
(LABEL 9)    (MOVE O2 -9 Q)
             (MOVE O1 -10 Q)
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
(LABEL 10)   (SUBI Q 11)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-BOOLEAN-CONDITION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-BOOLEAN-CONDITION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-BOOLEAN-CONDITION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-CONDITION EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Too many parameters to ~[" *FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" "~~:@[ undefined")
       (CODE-START)
(LABEL 1)    (ADDI Q 5)
             (MOVEM O1 -4 Q)
             (MOVEM O2 -3 Q)
             (MOVEM O3 -2 Q)
             (SKIPN NIL -2 Q)
             (JRST 4)
             (MOVE O1 -2 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -2 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL CONS 2)
             (MOVEM O1 (SPECIAL 0))
             (SKIPN NIL -2 Q)
             (JRST 6)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 6)
(LABEL 4)    (MOVE O1 (SPECIAL 2))
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVEM O1 (SPECIAL 2))
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 9)
             (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 2))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 10)
(LABEL 9)    (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 10)   (SKIPN NIL -4 Q)
             (JRST 12)
             (SKIPN NIL -3 Q)
             (JRST 14)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 14)   (CALL LISP::FORMAT-BOOLEAN-CONDITION 0)
             (JRST 11)
(LABEL 12)   (SKIPN NIL -3 Q)
             (JRST 16)
             (CALL LISP::FORMAT-FUNNY-CONDITION 0)
             (JRST 11)
(LABEL 16)   (SKIPA)
             (JRST 17)
             (CALL LISP::FORMAT-UNTAGGED-CONDITION 0)
(LABEL 17)
(LABEL 11)   (SUBI Q 5)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-CONDITION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-CONDITION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-CONDITION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-ITERATION EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(-1 "Too many parameters" *FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" (#\}) "Illegal terminator for ~~{" *FORMAT-ARGUMENTS* "Missing argument" "Control string is not a string" SIMPLE-STRING FORMAT-ERROR 0 "While processing indirect control string~%~S~%~V@T^")
       (CODE-START)
(LABEL 1)    (ADDI Q 25)
             (MOVEM O1 -24 Q)
             (MOVEM O2 -23 Q)
             (MOVEM O3 -22 Q)
             (SKIPN NIL -22 Q)
             (JRST 4)
             (MOVE O1 -22 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -20 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -22 Q)
             (MOVE O1 O5)
             (JRST 5)
(LABEL 4)    (MOVE O1 NIL)
(LABEL 5)    (SKIPE NIL O1)
             (MOVEM O1 -21 Q)
             (JUMPN O1 3)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -21 Q)
(LABEL 3)    (SKIPN NIL -22 Q)
             (JRST 7)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 7)    (MOVE O1 (SPECIAL 2))
             (CALL 1+ 1)
             (MOVEM O1 -19 Q)
             (MOVEM O1 (SPECIAL 2))
             (MOVEM O1 -20 Q)
             (MOVE O2 (SPECIAL 3))
             (CALL < 2)
             (JUMPE O1 9)
             (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -20 Q)
             (MOVE O2 (SPECIAL 2))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 10)
(LABEL 9)    (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 10)   (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 5)
             (MOVEM O1 -19 Q)
             (MOVEM O2 -18 Q)
             (MOVEM O3 -17 Q)
             (MOVEM O4 -16 Q)
             (MOVEM O5 -15 Q)
             (SKIPE NIL -15 Q)
             (JRST1 13)
             (SKIPN NIL -17 Q)
(LABEL 13)   (JRST 12)
             (MOVE O1 (CONSTANT 7))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 12)   (MOVE O2 -18 Q)
             (MOVE O1 -19 Q)
             (CALL = 2)
             (JUMPE O1 15)
             (SKIPN NIL (SPECIAL 8))
             (JRST 17)
             (MOVE O1 (SPECIAL 8))
             (MOVE O5 0 O1)
             (MOVEM O5 -12 Q)
             (MOVE O1 (SPECIAL 8))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 8))
             (MOVEM O5 -13 Q)
             (JRST 18)
(LABEL 17)   (MOVE O1 (CONSTANT 9))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -13 Q)
(LABEL 18)   (MOVE O1 -13 Q)
             (CALL STRINGP 1)
             (JUMPN O1 20)
             (MOVE O1 (CONSTANT 10))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 20)   (MOVE O1 -13 Q)
             (CALL SIMPLE-STRING-P 1)
             (JUMPE O1 22)
             (MOVE O5 -13 Q)
             (MOVEM O5 -11 Q)
             (JRST 23)
(LABEL 22)   (MOVE O2 (CONSTANT 11))
             (MOVE O1 -13 Q)
             (CALL COERCE 2)
             (MOVEM O1 -11 Q)
(LABEL 23)   (MOVE O1 (CONSTANT 12))
             (ICALL CCATCH)
             (JRST 24)
             (MOVE O5 -11 Q)
             (MOVEM O5 -7 Q)
             (MOVE O1 O5)
             (CALL LENGTH 1)
             (MOVEM O1 -6 Q)
             (MOVE O5 (CONSTANT 13))
             (MOVEM O5 -5 Q)
             (MOVE O1 -7 Q)
             (SPEC-BIND (SPECIAL 4))
             (MOVEM O1 (SPECIAL 4))
             (MOVE O1 -6 Q)
             (SPEC-BIND (SPECIAL 3))
             (MOVEM O1 (SPECIAL 3))
             (MOVE O1 -5 Q)
             (SPEC-BIND (SPECIAL 2))
             (MOVEM O1 (SPECIAL 2))
             (MOVE O5 (CONSTANT 13))
             (MOVEM O5 -4 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -3 Q)
             (MOVE O5 -21 Q)
             (MOVEM O5 -2 Q)
             (MOVE O5 -24 Q)
             (MOVEM O5 -1 Q)
             (MOVE O5 -23 Q)
             (MOVEM O5 0 Q)
             (PUSH Q -16 Q)
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-DO-ITERATION 6)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (UNBIND 3)
             (POPJ P)
(LABEL 24)   (MOVEM O1 -9 Q)
             (SKIPN NIL -9 Q)
             (JRST 26)
             (MOVE O1 (CONSTANT 12))
             (ICALL CTHROW)
             (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -7 Q)
             (MOVE O1 (SPECIAL 2))
             (CALL 1+ 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 14))
             (MOVE O2 -7 Q)
             (CALL LIST 3)
             (MOVEM O1 -8 Q)
             (MOVE O2 -9 Q)
             (CALL CONS 2)
             (POPJ P)
             (JRST 25)
(LABEL 26)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 25)   (JRST 16)
(LABEL 15)   (MOVE O5 -19 Q)
             (MOVEM O5 -14 Q)
             (MOVE O5 -18 Q)
             (MOVEM O5 -13 Q)
             (MOVE O5 -21 Q)
             (MOVEM O5 -12 Q)
             (MOVE O5 -24 Q)
             (MOVEM O5 -11 Q)
             (MOVE O5 -23 Q)
             (MOVEM O5 -10 Q)
             (PUSH Q -16 Q)
             (MOVE O1 -15 Q)
             (MOVE O2 -14 Q)
             (MOVE O3 -13 Q)
             (MOVE O4 -12 Q)
             (MOVE O5 -11 Q)
             (CALL LISP::FORMAT-DO-ITERATION 6)
(LABEL 16)   (SUBI Q 25)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-ITERATION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-ITERATION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-ITERATION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-DO-ITERATION EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 1 2-MANY))
       #0_(FORMAT-COLON-ESCAPE FORMAT-ESCAPE 0 *FORMAT-ARGUMENTS* "Missing argument" "Argument must be a list" "Argument must be a list of lists")
       (CODE-START)
(LABEL 1)    (ADDI Q 11)
             (MOVEM O1 -10 Q)
             (MOVEM O2 -9 Q)
             (MOVEM O3 -8 Q)
             (MOVEM O4 -7 Q)
             (MOVEM O5 -6 Q)
             (MOVE O1 (CONSTANT 0))
             (ICALL CCATCH)
             (JRST 3)
             (MOVE O1 (CONSTANT 1))
             (ICALL CCATCH)
             (JRST 4)
             (SKIPN NIL -6 Q)
             (JRST 5)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -5 Q)
(LABEL 11)   (MOVE O2 -8 Q)
             (MOVE O1 -5 Q)
             (CALL = 2)
             (JUMPN1 O1 14)
             (SKIPE NIL (SPECIAL 3))
             (JRST 15)
             (MOVE O1 -5 Q)
             (CALL ZEROP 1)
             (JUMPE O1 17)
             (SKIPE NIL -11 Q)
             (JRST 18)
             (JRST1 18)
(LABEL 17)   (SKIPA)
(LABEL 18)
(LABEL 15)
(LABEL 14)   (JRST 12)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 7)
(LABEL 12)   (SKIPN NIL -7 Q)
             (JRST 20)
             (MOVE O1 (CONSTANT 1))
             (JRST 21)
(LABEL 20)   (MOVE O1 NIL)
(LABEL 21)   (ICALL CCATCH)
             (JRST 19)
             (SKIPN NIL -7 Q)
             (JRST 22)
             (SKIPN NIL (SPECIAL 3))
             (JRST 24)
             (MOVE O1 (SPECIAL 3))
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 (SPECIAL 3))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 3))
             (MOVEM O5 -3 Q)
             (JRST 25)
(LABEL 24)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -3 Q)
(LABEL 25)   (MOVE O1 -3 Q)
             (SPEC-BIND (SPECIAL 3))
             (MOVEM O1 (SPECIAL 3))
             (MOVE O1 (SPECIAL 3))
             (CALL LISTP 1)
             (JUMPN O1 27)
             (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 27)   (MOVE O2 -9 Q)
             (MOVE O1 -10 Q)
             (CALL LISP::SUB-FORMAT 2)
             (UNBIND 1)
             (JRST 23)
(LABEL 22)   (MOVE O2 -9 Q)
             (MOVE O1 -10 Q)
             (CALL LISP::SUB-FORMAT 2)
(LABEL 23)   (POPJ P)
(LABEL 19)   (MOVE O1 -5 Q)
             (CALL 1+ 1)
             (MOVEM O1 -5 Q)
             (JRST 11)
(LABEL 7)    (JRST 6)
(LABEL 5)    (SKIPN NIL (SPECIAL 3))
             (JRST 29)
             (MOVE O1 (SPECIAL 3))
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 (SPECIAL 3))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 3))
             (MOVEM O5 -5 Q)
             (JRST 30)
(LABEL 29)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -5 Q)
(LABEL 30)   (MOVE O1 -5 Q)
             (SPEC-BIND (SPECIAL 3))
             (MOVEM O1 (SPECIAL 3))
             (MOVE O1 (SPECIAL 3))
             (CALL LISTP 1)
             (JUMPN O1 32)
             (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 32)   (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -3 Q)
(LABEL 38)   (MOVE O2 -8 Q)
             (MOVE O1 -3 Q)
             (CALL = 2)
             (JUMPN1 O1 41)
             (SKIPE NIL (SPECIAL 3))
             (JRST 42)
             (MOVE O1 -3 Q)
             (CALL ZEROP 1)
             (JUMPE O1 44)
             (SKIPE NIL -11 Q)
             (JRST 45)
             (JRST1 45)
(LABEL 44)   (SKIPA)
(LABEL 45)
(LABEL 42)
(LABEL 41)   (JRST 39)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 34)
(LABEL 39)   (SKIPN NIL -7 Q)
             (JRST 47)
             (MOVE O1 (CONSTANT 1))
             (JRST 48)
(LABEL 47)   (MOVE O1 NIL)
(LABEL 48)   (ICALL CCATCH)
             (JRST 46)
             (SKIPN NIL -7 Q)
             (JRST 49)
             (SKIPN NIL (SPECIAL 3))
             (JRST 51)
             (MOVE O1 (SPECIAL 3))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 3))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 3))
             (MOVEM O5 -1 Q)
             (JRST 52)
(LABEL 51)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -1 Q)
(LABEL 52)   (MOVE O1 -1 Q)
             (SPEC-BIND (SPECIAL 3))
             (MOVEM O1 (SPECIAL 3))
             (MOVE O1 (SPECIAL 3))
             (CALL LISTP 1)
             (JUMPN O1 54)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 54)   (MOVE O2 -9 Q)
             (MOVE O1 -10 Q)
             (CALL LISP::SUB-FORMAT 2)
             (UNBIND 1)
             (JRST 50)
(LABEL 49)   (MOVE O2 -9 Q)
             (MOVE O1 -10 Q)
             (CALL LISP::SUB-FORMAT 2)
(LABEL 50)   (POPJ P)
(LABEL 46)   (MOVE O1 -3 Q)
             (CALL 1+ 1)
             (MOVEM O1 -3 Q)
             (JRST 38)
(LABEL 34)   (UNBIND 1)
(LABEL 6)    (POPJ P)
(LABEL 4)    (POPJ P)
(LABEL 3)    (SUBI Q 12)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-DO-ITERATION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (START END MAX-ITER COLON ATSIGN AT-LEAST-ONCE-P))) 
(%PUT (QUOTE FORMAT-DO-ITERATION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-DO-ITERATION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-GET-TRAILING-SEGMENTS EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" (#\; #\>) "~~:; allowed only after first segment in ~~<" "Flags and parameters not allowed" FORMAT-ESCAPE *FORMAT-STREAM-STACK* *STANDARD-OUTPUT* #\; 1 0)
       (CODE-START)
(LABEL 1)    (ADDI Q 14)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 -12 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -13 Q)
             (MOVE O2 (SPECIAL 1))
             (CALL < 2)
             (JUMPE O1 3)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -13 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 6)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVEM O3 -10 Q)
             (MOVEM O4 -9 Q)
             (MOVEM O5 -8 Q)
             (MOVE W2 MVP)
             (ADDI W2 6)
             (POP W2 -7 Q)
             (SKIPN NIL -10 Q)
             (JRST 6)
             (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 6)    (SKIPE NIL -9 Q)
             (JRST1 10)
             (SKIPN NIL -8 Q)
(LABEL 10)   (JRST 9)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 9)    (MOVE O1 (CONSTANT 7))
             (ICALL CCATCH)
             (JRST 12)
             (SKIPN NIL (SPECIAL 8))
             (JRST 13)
             (MOVE O1 (SPECIAL 8))
             (MOVE O5 0 O1)
             (MOVEM O5 -3 Q)
             (MOVE O1 (SPECIAL 8))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 8))
             (MOVEM O5 -4 Q)
             (JRST 14)
(LABEL 13)   (CALL MAKE-STRING-OUTPUT-STREAM 0)
             (MOVEM O1 -4 Q)
(LABEL 14)   (MOVE O1 -4 Q)
             (SPEC-BIND (SPECIAL 9))
             (MOVEM O1 (SPECIAL 9))
             (ICALL CUNWIND)
             (JRST 15)
             (JRST 16)
             (MOVE O2 -11 Q)
             (MOVE O1 -12 Q)
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O1 (SPECIAL 9))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (MOVEM O1 -3 Q)
             (MOVE O5 (SPECIAL 9))
             (MOVEM O5 -2 Q)
             (MOVE O2 (SPECIAL 8))
             (MOVE O1 O5)
             (CALL CONS 2)
             (MOVEM O1 (SPECIAL 8))
             (MOVE O1 -3 Q)
             (MOVEI N 1)
             (POPJ P)
(LABEL 15)   (MOVE O1 (SPECIAL 9))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (POPJ P)
(LABEL 16)   (UNBIND 1)
             (POPJ P)
(LABEL 12)   (MOVEM O1 -6 Q)
             (SKIPN NIL -6 Q)
             (JRST 17)
             (MOVE O2 (CONSTANT 10))
             (CAME O2 -7 Q)
             (JRST 19)
             (CALL LISP::FORMAT-GET-TRAILING-SEGMENTS 0)
             (ADJUST-VALUES 3)
             (MOVEM O1 -4 Q)
             (MOVEM O2 -3 Q)
             (MOVEM O3 -2 Q)
             (MOVE O2 O1)
             (MOVE O1 -6 Q)
             (CALL CONS 2)
             (MOVEM O1 -1 Q)
             (MOVE O1 -3 Q)
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVE O1 -6 Q)
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 -2 Q)
             (CALL + 2)
             (MOVE O3 O1)
             (MOVE O1 -1 Q)
             (MOVE O2 0 Q)
             (MOVEI N 3)
             (JRST 20)
(LABEL 19)   (MOVE O1 -6 Q)
             (CALL LIST 1)
             (MOVEM O1 -5 Q)
             (MOVE O1 -6 Q)
             (CALL LENGTH 1)
             (MOVE O3 O1)
             (MOVE O1 -5 Q)
             (MOVE O2 (CONSTANT 11))
             (MOVEI N 3)
(LABEL 20)   (JRST 18)
(LABEL 17)   (MOVE O3 (CONSTANT 12))
             (MOVE O1 NIL)
             (MOVE O2 (CONSTANT 12))
             (MOVEI N 3)
(LABEL 18)   (SUBI Q 14)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-GET-TRAILING-SEGMENTS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-GET-TRAILING-SEGMENTS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-GET-TRAILING-SEGMENTS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-GET-SEGMENTS EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_((#\; #\>) "Atsign flag not allowed" *FORMAT-STREAM-STACK* *STANDARD-OUTPUT* #\; 1)
       (CODE-START)
(LABEL 1)    (ADDI Q 13)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-FIND-COMMAND 1)
             (ADJUST-VALUES 6)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVEM O3 -10 Q)
             (MOVEM O4 -9 Q)
             (MOVEM O5 -8 Q)
             (MOVE W2 MVP)
             (ADDI W2 6)
             (POP W2 -7 Q)
             (SKIPN NIL -8 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL (SPECIAL 2))
             (JRST 6)
             (MOVE O1 (SPECIAL 2))
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 (SPECIAL 2))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 2))
             (MOVEM O5 -5 Q)
             (JRST 7)
(LABEL 6)    (CALL MAKE-STRING-OUTPUT-STREAM 0)
             (MOVEM O1 -5 Q)
(LABEL 7)    (MOVE O1 -5 Q)
             (SPEC-BIND (SPECIAL 3))
             (MOVEM O1 (SPECIAL 3))
             (ICALL CUNWIND)
             (JRST 8)
             (JRST 9)
             (MOVE O2 -11 Q)
             (MOVE O1 -12 Q)
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O1 (SPECIAL 3))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (MOVEM O1 -4 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -3 Q)
             (MOVE O2 (SPECIAL 2))
             (MOVE O1 O5)
             (CALL CONS 2)
             (MOVEM O1 (SPECIAL 2))
             (MOVE O5 -4 Q)
             (MOVEM O5 -6 Q)
             (POPJ P)
(LABEL 8)    (MOVE O1 (SPECIAL 3))
             (CALL GET-OUTPUT-STREAM-STRING 1)
             (POPJ P)
(LABEL 9)    (UNBIND 1)
             (MOVE O2 (CONSTANT 4))
             (CAME O2 -7 Q)
             (JRST 10)
             (CALL LISP::FORMAT-GET-TRAILING-SEGMENTS 0)
             (ADJUST-VALUES 3)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (SKIPN NIL -9 Q)
             (JRST 12)
             (MOVE O5 -3 Q)
             (MOVE O1 -6 Q)
             (MOVE O2 -10 Q)
             (MOVE O3 -5 Q)
             (MOVE O4 -4 Q)
             (MOVEI N 5)
             (JRST 13)
(LABEL 12)   (MOVE O2 -5 Q)
             (MOVE O1 -6 Q)
             (CALL CONS 2)
             (MOVEM O1 -2 Q)
             (MOVE O1 -4 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (MOVE O1 -6 Q)
             (CALL LENGTH 1)
             (MOVEM O1 0 Q)
             (MOVE O2 -3 Q)
             (CALL + 2)
             (MOVE O5 O1)
             (MOVE O1 NIL)
             (MOVE O2 O1)
             (MOVE O3 -2 Q)
             (MOVE O4 -1 Q)
             (MOVEI N 5)
(LABEL 13)   (JRST 11)
(LABEL 10)   (MOVE O1 -6 Q)
             (CALL LIST 1)
             (MOVEM O1 -4 Q)
             (MOVE O1 -6 Q)
             (CALL LENGTH 1)
             (MOVE O5 O1)
             (MOVE O1 NIL)
             (MOVE O2 O1)
             (MOVE O3 -4 Q)
             (MOVE O4 (CONSTANT 5))
             (MOVEI N 5)
(LABEL 11)   (SUBI Q 13)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-GET-SEGMENTS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-GET-SEGMENTS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-GET-SEGMENTS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_MAKE-PAD-SEGS EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(0 1)
       (CODE-START)
(LABEL 1)    (ADDI Q 8)
             (MOVEM O1 -7 Q)
             (MOVEM O2 -6 Q)
             (MOVEM NIL -5 Q)
             (MOVEM NIL -4 Q)
             (CALL TRUNCATE 2)
             (MOVEM O1 -3 Q)
             (MOVE O2 O1)
             (MOVE O1 -6 Q)
             (CALL * 2)
             (MOVE O2 O1)
             (MOVE O1 -7 Q)
             (CALL - 2)
             (MOVEM O1 -2 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 -1 Q)
(LABEL 7)    (MOVE O1 -1 Q)
             (CALL ZEROP 1)
             (JUMPE O1 8)
             (MOVE O1 -4 Q)
             (MOVEI N 1)
             (JRST 3)
(LABEL 8)    (MOVE O2 (CONSTANT 0))
             (MOVE O1 -2 Q)
             (CALL > 2)
             (JUMPE O1 10)
             (MOVE O1 (CONSTANT 1))
             (CALL FLOAT 1)
             (CALL RANDOM 1)
             (MOVEM O1 0 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 -1 Q)
             (CALL / 2)
             (MOVE O2 O1)
             (MOVE O1 0 Q)
             (CALL < 2)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (MOVEM O1 -5 Q)
             (SKIPN NIL -5 Q)
             (JRST 12)
             (MOVE O1 -3 Q)
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (JRST 13)
(LABEL 12)   (MOVE O5 -3 Q)
             (MOVEM O5 0 Q)
(LABEL 13)   (MOVE O2 -4 Q)
             (MOVE O1 0 Q)
             (CALL CONS 2)
             (MOVEM O1 -4 Q)
             (SKIPN NIL -5 Q)
             (JRST 14)
             (MOVE O1 -2 Q)
             (CALL 1- 1)
             (JRST 15)
(LABEL 14)   (MOVE O1 -2 Q)
(LABEL 15)   (MOVEM O1 -2 Q)
             (MOVE O1 -1 Q)
             (CALL 1- 1)
             (MOVEM O1 -1 Q)
             (JRST 7)
(LABEL 3)    (SUBI Q 8)
             (POPJ P)
)

(%PUT (QUOTE MAKE-PAD-SEGS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (SPACES PADDINGS))) 
(%PUT (QUOTE MAKE-PAD-SEGS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE MAKE-PAD-SEGS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-ROUND-COLUMNS EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(0)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (CALL > 2)
             (JUMPE O1 3)
             (MOVE O2 -5 Q)
             (MOVE O1 -6 Q)
             (CALL - 2)
             (MOVEM O1 -3 Q)
             (MOVE O2 -4 Q)
             (CALL FLOOR 2)
             (ADJUST-VALUES 2)
             (MOVEM O1 -2 Q)
             (MOVEM O2 -1 Q)
             (MOVE O2 -4 Q)
             (CALL * 2)
             (MOVE O2 O1)
             (MOVE O1 -5 Q)
             (CALL + 2)
             (MOVEM O1 0 Q)
             (MOVE O1 -1 Q)
             (CALL ZEROP 1)
             (JUMPE O1 5)
             (MOVE O2 (CONSTANT 0))
             (JRST 6)
(LABEL 5)    (MOVE O2 -4 Q)
(LABEL 6)    (MOVE O1 0 Q)
             (CALL + 2)
             (JRST 4)
(LABEL 3)    (MOVE O1 -5 Q)
             (MOVEI N 1)
(LABEL 4)    (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-ROUND-COLUMNS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (WIDTH MINCOL COLINC))) 
(%PUT (QUOTE FORMAT-ROUND-COLUMNS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-ROUND-COLUMNS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-JUSTIFICATION EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(0 1 #\SPACE "Too many parameters" "Mincol must be a non-negative integer - ~S" "Colinc must be a positive integer - ~S" "Minpad must be a non-negative integer - ~S" "Padchar must be a character - ~S" *FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" (0) 72 *STANDARD-OUTPUT*)
       (CODE-START)
(LABEL 1)    (ADDI Q 23)
             (MOVEM O1 -22 Q)
             (MOVEM O2 -21 Q)
             (MOVEM O3 -20 Q)
             (SKIPN NIL -20 Q)
             (JRST 4)
             (MOVE O1 -20 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -18 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -20 Q)
             (MOVE O1 O5)
             (JRST 5)
(LABEL 4)    (MOVE O1 NIL)
(LABEL 5)    (SKIPE NIL O1)
             (MOVEM O1 -19 Q)
             (JUMPN O1 3)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -19 Q)
(LABEL 3)    (SKIPN NIL -20 Q)
             (JRST 7)
             (MOVE O1 -20 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -17 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -20 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -18 Q)
             (JUMPN O1 6)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -18 Q)
(LABEL 6)    (SKIPN NIL -20 Q)
             (JRST 10)
             (MOVE O1 -20 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -16 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -20 Q)
             (MOVE O1 O5)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (SKIPE NIL O1)
             (MOVEM O1 -17 Q)
             (JUMPN O1 9)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -17 Q)
(LABEL 9)    (SKIPN NIL -20 Q)
             (JRST 13)
             (MOVE O1 -20 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -15 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -20 Q)
             (MOVE O1 O5)
             (JRST 14)
(LABEL 13)   (MOVE O1 NIL)
(LABEL 14)   (SKIPE NIL O1)
             (MOVEM O1 -16 Q)
             (JUMPN O1 12)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -16 Q)
(LABEL 12)   (SKIPN NIL -20 Q)
             (JRST 16)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 16)   (MOVE O1 -19 Q)
             (CALL INTEGERP 1)
             (JUMPE1 O1 20)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -19 Q)
             (CALL < 2)
             (SKIPN NIL O1)
(LABEL 20)   (JRST 19)
             (MOVE O2 -19 Q)
             (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 19)   (MOVE O1 -18 Q)
             (CALL INTEGERP 1)
             (JUMPE1 O1 25)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -18 Q)
             (CALL > 2)
             (SKIPE NIL O1)
(LABEL 25)   (JRST 24)
             (MOVE O2 -18 Q)
             (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 24)   (MOVE O1 -17 Q)
             (CALL INTEGERP 1)
             (JUMPE1 O1 30)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -17 Q)
             (CALL < 2)
             (SKIPN NIL O1)
(LABEL 30)   (JRST 29)
             (MOVE O2 -17 Q)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 29)   (MOVE O1 -16 Q)
             (CALL CHARACTERP 1)
             (JUMPN O1 34)
             (MOVE O2 -16 Q)
             (MOVE O1 (CONSTANT 7))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 34)   (MOVE O1 (SPECIAL 8))
             (CALL 1+ 1)
             (MOVEM O1 -14 Q)
             (MOVEM O1 (SPECIAL 8))
             (MOVEM O1 -15 Q)
             (MOVE O2 (SPECIAL 9))
             (CALL < 2)
             (JUMPE O1 36)
             (MOVE O5 (SPECIAL 10))
             (MOVEM O5 -15 Q)
             (MOVE O2 (SPECIAL 8))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 37)
(LABEL 36)   (MOVE O1 (CONSTANT 11))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 37)   (CALL LISP::FORMAT-GET-SEGMENTS 0)
             (ADJUST-VALUES 5)
             (MOVEM O1 -14 Q)
             (MOVEM O2 -13 Q)
             (MOVEM O3 -12 Q)
             (MOVEM O4 -11 Q)
             (MOVEM O5 -10 Q)
             (SKIPE NIL -22 Q)
             (JRST1 40)
             (SKIPE NIL -21 Q)
             (JRST 41)
             (MOVE O2 (CONSTANT 1))
             (MOVE O1 -11 Q)
             (CALL = 2)
             (SKIPN NIL O1)
(LABEL 41)
(LABEL 40)   (JRST 38)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -8 Q)
             (JRST 39)
(LABEL 38)   (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -8 Q)
(LABEL 39)   (MOVE O1 -11 Q)
             (CALL 1- 1)
             (MOVE O2 O1)
             (MOVE O1 -8 Q)
             (CALL + 2)
             (MOVEM O1 -8 Q)
             (SKIPN NIL -21 Q)
             (JRST 43)
             (MOVE O2 (CONSTANT 1))
             (JRST 44)
(LABEL 43)   (MOVE O2 (CONSTANT 0))
(LABEL 44)   (MOVE O1 -8 Q)
             (CALL + 2)
             (MOVEM O1 -9 Q)
             (MOVE O2 O1)
             (MOVE O1 -17 Q)
             (CALL * 2)
             (MOVE O2 O1)
             (MOVE O1 -10 Q)
             (CALL + 2)
             (MOVEM O1 -7 Q)
             (MOVE O3 -18 Q)
             (MOVE O2 -19 Q)
             (CALL LISP::FORMAT-ROUND-COLUMNS 3)
             (MOVEM O1 -8 Q)
             (SKIPE NIL -22 Q)
             (JRST1 47)
             (SKIPE NIL -21 Q)
             (JRST 48)
             (MOVE O2 (CONSTANT 1))
             (MOVE O1 -11 Q)
             (CALL = 2)
             (SKIPN NIL O1)
(LABEL 48)
(LABEL 47)   (JRST 45)
             (MOVEM NIL -6 Q)
             (JRST 46)
(LABEL 45)   (MOVE O5 (CONSTANT 12))
             (MOVEM O5 -6 Q)
(LABEL 46)   (MOVE O2 -10 Q)
             (MOVE O1 -8 Q)
             (CALL - 2)
             (MOVEM O1 -5 Q)
             (MOVE O2 -9 Q)
             (CALL LISP::MAKE-PAD-SEGS 2)
             (MOVEM O1 -5 Q)
             (SKIPN NIL -21 Q)
             (JRST 50)
             (MOVE O3 NIL)
             (JRST 51)
(LABEL 50)   (MOVE O3 (CONSTANT 12))
(LABEL 51)   (MOVE O1 -6 Q)
             (MOVE O2 -5 Q)
             (CALL APPEND 3)
             (MOVEM O1 -7 Q)
             (SKIPN NIL -14 Q)
             (JRST 53)
             (SKIPN NIL -13 Q)
             (JRST 55)
             (MOVE O1 -13 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -13 Q)
             (MOVE O1 O5)
             (JRST 56)
(LABEL 55)   (MOVE O1 NIL)
(LABEL 56)   (SKIPE NIL O1)
             (MOVEM O1 -5 Q)
             (JUMPN O1 54)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -5 Q)
(LABEL 54)   (SKIPN NIL -13 Q)
             (JRST 58)
             (MOVE O1 -13 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -3 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -13 Q)
             (MOVE O1 O5)
             (JRST 59)
(LABEL 58)   (MOVE O1 NIL)
(LABEL 59)   (SKIPE NIL O1)
             (MOVEM O1 -4 Q)
             (JUMPN O1 57)
             (CALL LISP::LINE-LENGTH 0)
             (SKIPE NIL O1)
             (MOVEM O1 -4 Q)
             (JUMPN O1 60)
             (MOVE O5 (CONSTANT 13))
             (MOVEM O5 -4 Q)
(LABEL 60)
(LABEL 57)   (SKIPN NIL -13 Q)
             (JRST 62)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 62)   (MOVE O1 (SPECIAL 14))
             (CALL LISP::CHARPOS 1)
             (SKIPE NIL O1)
             (MOVEM O1 -2 Q)
             (JUMPN O1 64)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -2 Q)
(LABEL 64)   (MOVE O2 -8 Q)
             (MOVE O1 -2 Q)
             (CALL + 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 -5 Q)
             (CALL + 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 -4 Q)
             (CALL > 2)
             (JUMPE O1 66)
             (MOVE O5 (SPECIAL 14))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -14 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 66)
(LABEL 53)   (MOVE O5 -12 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -4 Q)
(LABEL 73)   (SKIPE NIL -5 Q)
             (JRST 74)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -2 Q)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
(LABEL 80)   (MOVE O2 -1 Q)
             (MOVE O1 -2 Q)
             (CALL < 2)
             (JUMPN O1 81)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 76)
(LABEL 81)   (MOVE O1 -16 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -2 Q)
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (JRST 80)
(LABEL 76)   (JRST 69)
(LABEL 74)   (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -2 Q)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
(LABEL 87)   (MOVE O2 -1 Q)
             (MOVE O1 -2 Q)
             (CALL < 2)
             (JUMPN O1 88)
             (JRST 83)
(LABEL 88)   (MOVE O1 -16 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -2 Q)
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (JRST 87)
(LABEL 83)   (MOVE O1 -5 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -3 Q)
             (MOVE O5 (SPECIAL 14))
             (MOVEM O5 -2 Q)
             (MOVE O4 NIL)
             (MOVE O1 -3 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O1 -5 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -3 Q)
             (MOVE O1 -4 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 -3 Q)
             (MOVEM O1 -5 Q)
             (MOVE O1 O5)
             (MOVEM O1 -4 Q)
             (JRST 73)
(LABEL 69)   (SUBI Q 23)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-JUSTIFICATION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-JUSTIFICATION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-JUSTIFICATION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-TERPRI EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Flags not allowed" 1 "Too many parameters" 0)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (SKIPE NIL -6 Q)
             (JRST1 5)
             (SKIPN NIL -5 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -4 Q)
             (JRST 8)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -4 Q)
             (MOVE O1 O5)
             (JRST 9)
(LABEL 8)    (MOVE O1 NIL)
(LABEL 9)    (SKIPE NIL O1)
             (MOVEM O1 -3 Q)
             (JUMPN O1 7)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -3 Q)
(LABEL 7)    (SKIPN NIL -4 Q)
             (JRST 11)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 11)   (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -1 Q)
             (MOVE O5 -3 Q)
             (MOVEM O5 0 Q)
(LABEL 17)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 18)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 13)
(LABEL 18)   (CALL TERPRI 0)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 17)
(LABEL 13)   (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-TERPRI) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-TERPRI) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-TERPRI) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-FRESHLINE EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Flags not allowed" 1 "Too many parameters" 0)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (SKIPE NIL -6 Q)
             (JRST1 5)
             (SKIPN NIL -5 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -4 Q)
             (JRST 8)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -4 Q)
             (MOVE O1 O5)
             (JRST 9)
(LABEL 8)    (MOVE O1 NIL)
(LABEL 9)    (SKIPE NIL O1)
             (MOVEM O1 -3 Q)
             (JUMPN O1 7)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -3 Q)
(LABEL 7)    (SKIPN NIL -4 Q)
             (JRST 11)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 11)   (CALL FRESH-LINE 0)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -1 Q)
             (MOVE O1 -3 Q)
             (CALL 1- 1)
             (MOVEM O1 0 Q)
(LABEL 17)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 18)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 13)
(LABEL 18)   (CALL TERPRI 0)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 17)
(LABEL 13)   (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-FRESHLINE) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-FRESHLINE) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-FRESHLINE) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PAGE EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Flags not allowed" 1 "Too many parameters" 0 #\PAGE)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (SKIPE NIL -6 Q)
             (JRST1 5)
             (SKIPN NIL -5 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -4 Q)
             (JRST 8)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -4 Q)
             (MOVE O1 O5)
             (JRST 9)
(LABEL 8)    (MOVE O1 NIL)
(LABEL 9)    (SKIPE NIL O1)
             (MOVEM O1 -3 Q)
             (JUMPN O1 7)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -3 Q)
(LABEL 7)    (SKIPN NIL -4 Q)
             (JRST 11)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 11)   (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -1 Q)
             (MOVE O5 -3 Q)
             (MOVEM O5 0 Q)
(LABEL 17)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 18)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 13)
(LABEL 18)   (MOVE O1 (CONSTANT 4))
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 17)
(LABEL 13)   (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PAGE) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PAGE) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PAGE) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-TILDE EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Flags not allowed" 1 "Too many parameters" 0 #\~)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (SKIPE NIL -6 Q)
             (JRST1 5)
             (SKIPN NIL -5 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -4 Q)
             (JRST 8)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -4 Q)
             (MOVE O1 O5)
             (JRST 9)
(LABEL 8)    (MOVE O1 NIL)
(LABEL 9)    (SKIPE NIL O1)
             (MOVEM O1 -3 Q)
             (JUMPN O1 7)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -3 Q)
(LABEL 7)    (SKIPN NIL -4 Q)
             (JRST 11)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 11)   (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -1 Q)
             (MOVE O5 -3 Q)
             (MOVEM O5 0 Q)
(LABEL 17)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 18)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 13)
(LABEL 18)   (MOVE O1 (CONSTANT 4))
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 17)
(LABEL 13)   (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-TILDE) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-TILDE) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-TILDE) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-EAT-WHITESPACE-INTERNAL-217 EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(#\NEWLINE T)
       (CODE-START)
(LABEL 1)    (ADDI Q 1)
             (MOVEM O1 0 Q)
             (CALL LISP::WHITESPACE-CHAR-P 1)
             (JUMPN O1 3)
             (MOVE O2 (CONSTANT 0))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
(LABEL 3)    (SUBI Q 1)
             (POPJ P)
)


#_(LAP #0_FORMAT-EAT-WHITESPACE EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-INDEX* *FORMAT-LENGTH* *FORMAT-CONTROL-STRING* "Syntax error" FORMAT-EAT-WHITESPACE-INTERNAL-217 :START)
       (CODE-START)
(LABEL 1)    (ADDI Q 2)
             (MOVE O1 (SPECIAL 0))
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 1))
             (CALL < 2)
             (JUMPE O1 3)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 (SPECIAL 0))
             (MOVE O1 O5)
             (CALL SCHAR 2)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 (SPECIAL 0))
             (MOVE O1 (CONSTANT 4))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 5))
             (CALL POSITION-IF-NOT 4)
             (CALL 1- 1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEI N 1)
             (SUBI Q 2)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-EAT-WHITESPACE) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-EAT-WHITESPACE) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-EAT-WHITESPACE) (QUOTE %SOURCE-DOCUMENTATION)))) 
(%PUT (QUOTE WHITESPACE-CHAR-P) (QUOTE %FUN-DOCUMENTATION) (QUOTE "Determines whether or not a character is considered whitespace.")) 

#_(LAP #0_WHITESPACE-CHAR-P EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(#\SPACE T #\TAB #\PAGE #\NEWLINE #\RETURN)
       (CODE-START)
(LABEL 1)    (ADDI Q 1)
             (MOVEM O1 0 Q)
             (MOVE O2 (CONSTANT 0))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
             (JUMPN O1 3)
             (MOVE O2 (CONSTANT 2))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
             (JUMPN O1 3)
             (MOVE O2 (CONSTANT 3))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
             (JUMPN O1 3)
             (MOVE O2 (CONSTANT 4))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
             (JUMPN O1 3)
             (MOVE O2 (CONSTANT 5))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
             (JUMPN O1 3)
             (MOVE O2 (CONSTANT 4))
             (CAME O2 0 Q)
             (SKIPA O1 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
(LABEL 3)    (SUBI Q 1)
             (POPJ P)
)

(%PUT (QUOTE WHITESPACE-CHAR-P) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (CHAR))) 
(%PUT (QUOTE WHITESPACE-CHAR-P) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE WHITESPACE-CHAR-P) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-NEWLINE EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Parameters not allowed" "~:@<newline> is undefined")
       (CODE-START)
(LABEL 1)    (ADDI Q 3)
             (MOVEM O1 -2 Q)
             (MOVEM O2 -1 Q)
             (MOVEM O3 0 Q)
             (SKIPN NIL 0 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -2 Q)
             (JRST 7)
             (SKIPN NIL -1 Q)
             (JRST 9)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (JRST 8)
(LABEL 9)    (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 8)    (JRST 6)
(LABEL 7)    (SKIPN NIL -1 Q)
             (JRST 11)
             (CALL TERPRI 0)
             (CALL LISP::FORMAT-EAT-WHITESPACE 0)
             (JRST 6)
(LABEL 11)   (SKIPA)
             (JRST 12)
             (CALL LISP::FORMAT-EAT-WHITESPACE 0)
(LABEL 12)
(LABEL 6)    (SUBI Q 3)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-NEWLINE) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-NEWLINE) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-NEWLINE) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PLURAL EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Parameters not allowed" *FORMAT-ORIGINAL-ARGUMENTS* *FORMAT-ARGUMENTS* 0 "No previous argument" "Missing argument" 1 "y" "" *STANDARD-OUTPUT* "ies" "s")
       (CODE-START)
(LABEL 1)    (ADDI Q 6)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (SKIPN NIL -3 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -5 Q)
             (JRST 7)
             (MOVE O1 (SPECIAL 1))
             (CALL LENGTH 1)
             (MOVEM O1 0 Q)
             (MOVE O1 (SPECIAL 2))
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 0 Q)
             (CALL - 2)
             (CALL 1- 1)
             (MOVEM O1 -1 Q)
             (MOVE O2 (CONSTANT 3))
             (CALL < 2)
             (JUMPE O1 8)
             (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
             (JRST 9)
(LABEL 8)    (MOVE O2 (SPECIAL 1))
             (MOVE O1 -1 Q)
             (CALL NTHCDR 2)
             (MOVEM O1 (SPECIAL 2))
(LABEL 9)
(LABEL 7)    (SKIPN NIL (SPECIAL 2))
             (JRST 13)
             (MOVE O1 (SPECIAL 2))
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 (SPECIAL 2))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 2))
             (MOVEM O5 -2 Q)
             (JRST 14)
(LABEL 13)   (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -2 Q)
(LABEL 14)   (MOVE O2 (CONSTANT 6))
             (CAME O2 -2 Q)
             (JRST 11)
             (SKIPN NIL -4 Q)
             (JRST 15)
             (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -2 Q)
             (JRST 16)
(LABEL 15)   (MOVE O5 (CONSTANT 8))
             (MOVEM O5 -2 Q)
(LABEL 16)   (MOVE O5 (SPECIAL 9))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -2 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 3))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 12)
(LABEL 11)   (SKIPN NIL -4 Q)
             (JRST 17)
             (MOVE O5 (CONSTANT 10))
             (MOVEM O5 -2 Q)
             (JRST 18)
(LABEL 17)   (MOVE O5 (CONSTANT 11))
             (MOVEM O5 -2 Q)
(LABEL 18)   (MOVE O5 (SPECIAL 9))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -2 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 3))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 12)   (SUBI Q 6)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PLURAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PLURAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PLURAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-SKIP-ARGUMENTS EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(1 "Too many parameters" 0 *FORMAT-ORIGINAL-ARGUMENTS* "Illegal to go to non-existant argument" *FORMAT-ARGUMENTS* "Skip to nonexistant argument")
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (SKIPN NIL -4 Q)
             (JRST 4)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -4 Q)
             (MOVE O1 O5)
             (JRST 5)
(LABEL 4)    (MOVE O1 NIL)
(LABEL 5)    (SKIPE NIL O1)
             (MOVEM O1 -3 Q)
             (JUMPN O1 3)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -3 Q)
(LABEL 3)    (SKIPN NIL -4 Q)
             (JRST 7)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 7)    (SKIPN NIL -5 Q)
             (JRST 10)
             (MOVE O2 (CONSTANT 2))
             (MOVE O1 -3 Q)
             (CALL < 2)
             (JUMPN1 O1 13)
             (MOVE O1 (SPECIAL 3))
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 -3 Q)
             (CALL > 2)
             (SKIPN NIL O1)
(LABEL 13)   (JRST 12)
             (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 12)   (MOVE O2 (SPECIAL 3))
             (MOVE O1 -3 Q)
             (CALL NTHCDR 2)
             (MOVEM O1 (SPECIAL 5))
             (MOVEI N 1)
             (JRST 9)
(LABEL 10)   (SKIPN NIL -6 Q)
             (JRST 15)
             (MOVE O1 (SPECIAL 3))
             (CALL LENGTH 1)
             (MOVEM O1 0 Q)
             (MOVE O1 (SPECIAL 5))
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 0 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
             (MOVE O2 -3 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 (CONSTANT 2))
             (CALL < 2)
             (JUMPE O1 16)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
             (JRST 17)
(LABEL 16)   (MOVE O2 (SPECIAL 3))
             (MOVE O1 -1 Q)
             (CALL NTHCDR 2)
             (MOVEM O1 (SPECIAL 5))
             (MOVEI N 1)
(LABEL 17)   (JRST 9)
(LABEL 15)   (SKIPA)
             (JRST 18)
             (MOVE O1 (SPECIAL 5))
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 -3 Q)
             (CALL > 2)
             (JUMPE O1 19)
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
             (JRST 20)
(LABEL 19)   (MOVE O2 (SPECIAL 5))
             (MOVE O1 -3 Q)
             (CALL NTHCDR 2)
             (MOVEM O1 (SPECIAL 5))
             (MOVEI N 1)
(LABEL 20)
(LABEL 18)
(LABEL 9)    (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-SKIP-ARGUMENTS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-SKIP-ARGUMENTS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-SKIP-ARGUMENTS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-INDIRECTION EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Flags or parameters not allowed" *FORMAT-ARGUMENTS* "Missing argument" "Indirected control string is not a string" SIMPLE-STRING FORMAT-ERROR 0 *FORMAT-CONTROL-STRING* *FORMAT-LENGTH* *FORMAT-INDEX* "While processing indirect control string~%~S~%~V@T^")
       (CODE-START)
(LABEL 1)    (ADDI Q 13)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVEM O3 -10 Q)
             (SKIPE NIL -12 Q)
             (JRST1 5)
             (SKIPN NIL -10 Q)
(LABEL 5)    (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -11 Q)
             (JRST 7)
             (SKIPN NIL (SPECIAL 1))
             (JRST 9)
             (MOVE O1 (SPECIAL 1))
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 (SPECIAL 1))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O5 -9 Q)
             (JRST 10)
(LABEL 9)    (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -9 Q)
(LABEL 10)   (MOVE O1 -9 Q)
             (CALL STRINGP 1)
             (JUMPN O1 12)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 12)   (MOVE O1 -9 Q)
             (CALL SIMPLE-STRING-P 1)
             (JUMPE O1 14)
             (MOVE O5 -9 Q)
             (MOVEM O5 -7 Q)
             (JRST 15)
(LABEL 14)   (MOVE O2 (CONSTANT 4))
             (MOVE O1 -9 Q)
             (CALL COERCE 2)
             (MOVEM O1 -7 Q)
(LABEL 15)   (MOVE O1 (CONSTANT 5))
             (ICALL CCATCH)
             (JRST 16)
             (MOVE O5 -7 Q)
             (MOVEM O5 -3 Q)
             (MOVE O1 O5)
             (CALL LENGTH 1)
             (MOVEM O1 -2 Q)
             (MOVE O5 (CONSTANT 6))
             (MOVEM O5 -1 Q)
             (MOVE O1 -3 Q)
             (SPEC-BIND (SPECIAL 7))
             (MOVEM O1 (SPECIAL 7))
             (MOVE O1 -2 Q)
             (SPEC-BIND (SPECIAL 8))
             (MOVEM O1 (SPECIAL 8))
             (MOVE O1 -1 Q)
             (SPEC-BIND (SPECIAL 9))
             (MOVEM O1 (SPECIAL 9))
             (MOVE O2 (SPECIAL 8))
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (UNBIND 3)
             (POPJ P)
(LABEL 16)   (MOVEM O1 -5 Q)
             (SKIPN NIL -5 Q)
             (JRST 18)
             (MOVE O1 (CONSTANT 5))
             (ICALL CTHROW)
             (MOVE O5 (SPECIAL 7))
             (MOVEM O5 -3 Q)
             (MOVE O1 (SPECIAL 9))
             (CALL 1+ 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 10))
             (MOVE O2 -3 Q)
             (CALL LIST 3)
             (MOVEM O1 -4 Q)
             (MOVE O2 -5 Q)
             (CALL CONS 2)
             (POPJ P)
             (JRST 17)
(LABEL 18)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 17)   (JRST 8)
(LABEL 7)    (SKIPN NIL (SPECIAL 1))
             (JRST 20)
             (MOVE O1 (SPECIAL 1))
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 (SPECIAL 1))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O5 -9 Q)
             (JRST 21)
(LABEL 20)   (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -9 Q)
(LABEL 21)   (SKIPN NIL (SPECIAL 1))
             (JRST 22)
             (MOVE O1 (SPECIAL 1))
             (MOVE O5 0 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 (SPECIAL 1))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O5 -8 Q)
             (JRST 23)
(LABEL 22)   (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -8 Q)
(LABEL 23)   (MOVE O1 -8 Q)
             (SPEC-BIND (SPECIAL 1))
             (MOVEM O1 (SPECIAL 1))
             (MOVE O1 -9 Q)
             (CALL STRINGP 1)
             (JUMPN O1 25)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 25)   (MOVE O1 -9 Q)
             (CALL SIMPLE-STRING-P 1)
             (JUMPE O1 27)
             (MOVE O5 -9 Q)
             (MOVEM O5 -6 Q)
             (JRST 28)
(LABEL 27)   (MOVE O2 (CONSTANT 4))
             (MOVE O1 -9 Q)
             (CALL COERCE 2)
             (MOVEM O1 -6 Q)
(LABEL 28)   (MOVE O1 (CONSTANT 5))
             (ICALL CCATCH)
             (JRST 29)
             (MOVE O5 -6 Q)
             (MOVEM O5 -2 Q)
             (MOVE O1 O5)
             (CALL LENGTH 1)
             (MOVEM O1 -1 Q)
             (MOVE O5 (CONSTANT 6))
             (MOVEM O5 0 Q)
             (MOVE O1 -2 Q)
             (SPEC-BIND (SPECIAL 7))
             (MOVEM O1 (SPECIAL 7))
             (MOVE O1 -1 Q)
             (SPEC-BIND (SPECIAL 8))
             (MOVEM O1 (SPECIAL 8))
             (MOVE O1 0 Q)
             (SPEC-BIND (SPECIAL 9))
             (MOVEM O1 (SPECIAL 9))
             (MOVE O2 (SPECIAL 8))
             (MOVE O1 (CONSTANT 6))
             (CALL LISP::SUB-FORMAT 2)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (UNBIND 3)
             (POPJ P)
(LABEL 29)   (MOVEM O1 -4 Q)
             (SKIPN NIL -4 Q)
             (JRST 31)
             (MOVE O1 (CONSTANT 5))
             (ICALL CTHROW)
             (MOVE O5 (SPECIAL 7))
             (MOVEM O5 -2 Q)
             (MOVE O1 (SPECIAL 9))
             (CALL 1+ 1)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 10))
             (MOVE O2 -2 Q)
             (CALL LIST 3)
             (MOVEM O1 -3 Q)
             (MOVE O2 -4 Q)
             (CALL CONS 2)
             (POPJ P)
             (JRST 30)
(LABEL 31)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 30)   (UNBIND 1)
(LABEL 8)    (SUBI Q 13)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-INDIRECTION) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-INDIRECTION) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-INDIRECTION) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-TAB EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(1 "Too many parameters" "Tab-to in pixel units not supported" "                                                                                " *STANDARD-OUTPUT* 0 80 2)
       (CODE-START)
(LABEL 1)    (ADDI Q 11)
             (MOVEM O1 -10 Q)
             (MOVEM O2 -9 Q)
             (MOVEM O3 -8 Q)
             (SKIPN NIL -8 Q)
             (JRST 4)
             (MOVE O1 -8 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -8 Q)
             (MOVE O1 O5)
             (JRST 5)
(LABEL 4)    (MOVE O1 NIL)
(LABEL 5)    (SKIPE NIL O1)
             (MOVEM O1 -7 Q)
             (JUMPN O1 3)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -7 Q)
(LABEL 3)    (SKIPN NIL -8 Q)
             (JRST 7)
             (MOVE O1 -8 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -8 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -6 Q)
             (JUMPN O1 6)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -6 Q)
(LABEL 6)    (SKIPN NIL -8 Q)
             (JRST 10)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 10)   (SKIPN NIL -10 Q)
             (JRST 13)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 13)   (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -4 Q)
             (MOVE O1 (SPECIAL 4))
             (CALL LISP::CHARPOS 1)
             (MOVEM O1 -3 Q)
             (SKIPN NIL -3 Q)
             (JRST 16)
             (SKIPN NIL -9 Q)
             (JRST 17)
             (MOVE O2 -7 Q)
             (MOVE O1 -3 Q)
             (CALL + 2)
             (MOVEM O1 -2 Q)
             (JRST 18)
(LABEL 17)   (MOVE O5 -7 Q)
             (MOVEM O5 -2 Q)
(LABEL 18)   (MOVE O2 -2 Q)
             (MOVE O1 -3 Q)
             (CALL > 2)
             (JUMPE O1 19)
             (MOVE O2 -2 Q)
             (MOVE O1 -3 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
             (MOVE O2 -6 Q)
             (CALL REM 2)
             (MOVE O2 O1)
             (MOVE O1 -6 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
             (JRST 20)
(LABEL 19)   (MOVE O2 -3 Q)
             (MOVE O1 -2 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
(LABEL 20)   (MOVE O2 (CONSTANT 6))
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPE O1 21)
             (MOVE O4 -1 Q)
             (JRST 22)
(LABEL 21)   (MOVE O4 (CONSTANT 6))
(LABEL 22)   (JRST 15)
(LABEL 16)   (SKIPN NIL -9 Q)
             (JRST 23)
             (MOVE O4 -7 Q)
             (JRST 15)
(LABEL 23)   (SKIPA)
             (JRST 24)
             (MOVE O4 (CONSTANT 7))
(LABEL 24)
(LABEL 15)   (MOVE O1 (CONSTANT 3))
             (MOVE O2 -4 Q)
             (MOVE O3 (CONSTANT 5))
             (CALL LISP::%SP-WRITE-STRING 4)
             (SUBI Q 11)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-TAB) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-TAB) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-TAB) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINC EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" "()" "NIL" *STANDARD-OUTPUT* 0 1 #\SPACE "Too many parameters")
       (CODE-START)
(LABEL 1)    (ADDI Q 14)
             (MOVEM O1 -13 Q)
             (MOVEM O2 -12 Q)
             (MOVEM O3 -11 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 -9 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 -10 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -10 Q)
(LABEL 4)    (SKIPE NIL -11 Q)
             (JRST 5)
             (SKIPN NIL -10 Q)
             (JRST 7)
             (MOVE O1 -10 Q)
             (CALL PRINC 1)
             (JRST 8)
(LABEL 7)    (SKIPN NIL -13 Q)
             (JRST 9)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -9 Q)
             (JRST 10)
(LABEL 9)    (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -9 Q)
(LABEL 10)   (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -8 Q)
             (MOVE O4 NIL)
             (MOVE O1 -9 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 5))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 8)    (JRST 6)
(LABEL 5)    (SKIPN NIL -11 Q)
             (JRST 12)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 13)
(LABEL 12)   (MOVE O1 NIL)
(LABEL 13)   (SKIPE NIL O1)
             (MOVEM O1 -8 Q)
             (JUMPN O1 11)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -8 Q)
(LABEL 11)   (SKIPN NIL -11 Q)
             (JRST 15)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 16)
(LABEL 15)   (MOVE O1 NIL)
(LABEL 16)   (SKIPE NIL O1)
             (MOVEM O1 -7 Q)
             (JUMPN O1 14)
             (MOVE O5 (CONSTANT 6))
             (MOVEM O5 -7 Q)
(LABEL 14)   (SKIPN NIL -11 Q)
             (JRST 18)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 19)
(LABEL 18)   (MOVE O1 NIL)
(LABEL 19)   (SKIPE NIL O1)
             (MOVEM O1 -6 Q)
             (JUMPN O1 17)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -6 Q)
(LABEL 17)   (SKIPN NIL -11 Q)
             (JRST 21)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 22)
(LABEL 21)   (MOVE O1 NIL)
(LABEL 22)   (SKIPE NIL O1)
             (MOVEM O1 -5 Q)
             (JUMPN O1 20)
             (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -5 Q)
(LABEL 20)   (SKIPN NIL -11 Q)
             (JRST 24)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 24)   (SKIPN NIL -10 Q)
             (JRST 26)
             (MOVE O1 -10 Q)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -4 Q)
             (JRST 27)
(LABEL 26)   (SKIPN NIL -13 Q)
             (JRST 28)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -4 Q)
             (JRST 29)
(LABEL 28)   (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -4 Q)
(LABEL 29)
(LABEL 27)   (MOVE O5 -8 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -2 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 -1 Q)
             (MOVE O5 -5 Q)
             (MOVEM O5 0 Q)
             (PUSH Q -12 Q)
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
(LABEL 6)    (SUBI Q 14)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINC) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINC) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINC) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRIN1 EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" "()" "NIL" *STANDARD-OUTPUT* 0 1 #\SPACE "Too many parameters")
       (CODE-START)
(LABEL 1)    (ADDI Q 14)
             (MOVEM O1 -13 Q)
             (MOVEM O2 -12 Q)
             (MOVEM O3 -11 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 -9 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 -10 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -10 Q)
(LABEL 4)    (SKIPE NIL -11 Q)
             (JRST 5)
             (SKIPN NIL -10 Q)
             (JRST 7)
             (MOVE O1 -10 Q)
             (CALL PRIN1 1)
             (JRST 8)
(LABEL 7)    (SKIPN NIL -13 Q)
             (JRST 9)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -9 Q)
             (JRST 10)
(LABEL 9)    (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -9 Q)
(LABEL 10)   (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -8 Q)
             (MOVE O4 NIL)
             (MOVE O1 -9 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 5))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 8)    (JRST 6)
(LABEL 5)    (SKIPN NIL -11 Q)
             (JRST 12)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 13)
(LABEL 12)   (MOVE O1 NIL)
(LABEL 13)   (SKIPE NIL O1)
             (MOVEM O1 -8 Q)
             (JUMPN O1 11)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -8 Q)
(LABEL 11)   (SKIPN NIL -11 Q)
             (JRST 15)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 16)
(LABEL 15)   (MOVE O1 NIL)
(LABEL 16)   (SKIPE NIL O1)
             (MOVEM O1 -7 Q)
             (JUMPN O1 14)
             (MOVE O5 (CONSTANT 6))
             (MOVEM O5 -7 Q)
(LABEL 14)   (SKIPN NIL -11 Q)
             (JRST 18)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 19)
(LABEL 18)   (MOVE O1 NIL)
(LABEL 19)   (SKIPE NIL O1)
             (MOVEM O1 -6 Q)
             (JUMPN O1 17)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -6 Q)
(LABEL 17)   (SKIPN NIL -11 Q)
             (JRST 21)
             (MOVE O1 -11 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -11 Q)
             (MOVE O1 O5)
             (JRST 22)
(LABEL 21)   (MOVE O1 NIL)
(LABEL 22)   (SKIPE NIL O1)
             (MOVEM O1 -5 Q)
             (JUMPN O1 20)
             (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -5 Q)
(LABEL 20)   (SKIPN NIL -11 Q)
             (JRST 24)
             (MOVE O1 (CONSTANT 8))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 24)   (SKIPN NIL -10 Q)
             (JRST 26)
             (MOVE O1 -10 Q)
             (CALL PRIN1-TO-STRING 1)
             (MOVEM O1 -4 Q)
             (JRST 27)
(LABEL 26)   (SKIPN NIL -13 Q)
             (JRST 28)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -4 Q)
             (JRST 29)
(LABEL 28)   (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -4 Q)
(LABEL 29)
(LABEL 27)   (MOVE O5 -8 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -2 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 -1 Q)
             (MOVE O5 -5 Q)
             (MOVEM O5 0 Q)
             (PUSH Q -12 Q)
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
(LABEL 6)    (SUBI Q 14)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRIN1) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRIN1) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRIN1) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-CHARACTER EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Too many parameters" *FORMAT-ARGUMENTS* "Missing argument" "Argument must be a character")
       (CODE-START)
(LABEL 1)    (ADDI Q 5)
             (MOVEM O1 -4 Q)
             (MOVEM O2 -3 Q)
             (MOVEM O3 -2 Q)
             (SKIPN NIL -2 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL (SPECIAL 1))
             (JRST 6)
             (MOVE O1 (SPECIAL 1))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 1))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 1))
             (MOVEM O5 -1 Q)
             (JRST 7)
(LABEL 6)    (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -1 Q)
(LABEL 7)    (MOVE O1 -1 Q)
             (CALL CHARACTERP 1)
             (JUMPN O1 9)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 9)    (SKIPN NIL -3 Q)
             (JRST 13)
             (SKIPE NIL -4 Q)
(LABEL 13)   (JRST 12)
             (MOVE O1 -1 Q)
             (CALL PRIN1 1)
             (JRST 11)
(LABEL 12)   (SKIPA)
             (JRST 15)
             (MOVE O2 -4 Q)
             (MOVE O1 -1 Q)
             (CALL LISP::FORMAT-PRINT-NAMED-CHARACTER 2)
(LABEL 15)
(LABEL 11)   (SUBI Q 5)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-CHARACTER) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-CHARACTER) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-CHARACTER) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-NAMED-CHARACTER EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(:CONTROL "Control-" "C-" :META "Meta-" "M-" :SUPER "Super-" "S-" :HYPER "Hyper-" "H-" "" *STANDARD-OUTPUT* 0 31 #\^ 64)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL CHAR-BIT 2)
             (JUMPE O1 4)
             (SKIPN NIL -5 Q)
             (JRST 5)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -4 Q)
             (JRST 6)
(LABEL 5)    (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -4 Q)
(LABEL 6)    (JRST 3)
(LABEL 4)    (MOVE O2 (CONSTANT 3))
             (MOVE O1 -6 Q)
             (CALL CHAR-BIT 2)
             (JUMPE O1 7)
             (SKIPN NIL -5 Q)
             (JRST 8)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -4 Q)
             (JRST 9)
(LABEL 8)    (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -4 Q)
(LABEL 9)    (JRST 3)
(LABEL 7)    (MOVE O2 (CONSTANT 6))
             (MOVE O1 -6 Q)
             (CALL CHAR-BIT 2)
             (JUMPE O1 10)
             (SKIPN NIL -5 Q)
             (JRST 11)
             (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -4 Q)
             (JRST 12)
(LABEL 11)   (MOVE O5 (CONSTANT 8))
             (MOVEM O5 -4 Q)
(LABEL 12)   (JRST 3)
(LABEL 10)   (MOVE O2 (CONSTANT 9))
             (MOVE O1 -6 Q)
             (CALL CHAR-BIT 2)
             (JUMPE O1 13)
             (SKIPN NIL -5 Q)
             (JRST 14)
             (MOVE O5 (CONSTANT 10))
             (MOVEM O5 -4 Q)
             (JRST 15)
(LABEL 14)   (MOVE O5 (CONSTANT 11))
             (MOVEM O5 -4 Q)
(LABEL 15)   (JRST 3)
(LABEL 13)   (SKIPA)
             (JRST 16)
             (MOVE O5 (CONSTANT 12))
             (MOVEM O5 -4 Q)
(LABEL 16)
(LABEL 3)    (MOVE O5 (SPECIAL 13))
             (MOVEM O5 -3 Q)
             (MOVE O4 NIL)
             (MOVE O1 -4 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 14))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O1 -6 Q)
             (CALL CHAR-CODE 1)
             (CALL CODE-CHAR 1)
             (MOVEM O1 -3 Q)
             (CALL CHAR-NAME 1)
             (MOVEM O1 -2 Q)
             (SKIPN NIL -2 Q)
             (JRST 19)
             (MOVE O1 -2 Q)
             (CALL STRING-CAPITALIZE 1)
             (MOVEM O1 -1 Q)
             (MOVE O5 (SPECIAL 13))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 14))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 18)
(LABEL 19)   (MOVE O1 -6 Q)
             (CALL CHAR-CODE 1)
             (MOVEM O1 0 Q)
             (MOVE O3 (CONSTANT 15))
             (MOVE O1 (CONSTANT 14))
             (MOVE O2 0 Q)
             (CALL <= 3)
             (JUMPE O1 20)
             (MOVE O1 (CONSTANT 16))
             (CALL WRITE-CHAR 1)
             (MOVE O1 -6 Q)
             (CALL CHAR-CODE 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 17))
             (CALL + 2)
             (CALL CODE-CHAR 1)
             (CALL WRITE-CHAR 1)
             (JRST 18)
(LABEL 20)   (SKIPA)
             (JRST 21)
             (MOVE O1 -3 Q)
             (CALL WRITE-CHAR 1)
(LABEL 21)
(LABEL 18)   (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-NAMED-CHARACTER) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (CHAR LONGP))) 
(%PUT (QUOTE FORMAT-PRINT-NAMED-CHARACTER) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-NAMED-CHARACTER) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-ADD-COMMAS EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(3 :INITIAL-ELEMENT 0 :START1 :END1 :START2 :END2 4)
       (CODE-START)
(LABEL 1)    (ADDI Q 13)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -10 Q)
             (CALL 1- 1)
             (MOVEM O1 -7 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL FLOOR 2)
             (MOVE O2 O1)
             (MOVE O1 -10 Q)
             (CALL + 2)
             (MOVEM O1 -9 Q)
             (MOVE O3 -11 Q)
             (MOVE O2 (CONSTANT 1))
             (CALL MAKE-STRING 3)
             (MOVEM O1 -8 Q)
             (MOVE O5 -10 Q)
             (MOVEM O5 -7 Q)
             (MOVE O5 -9 Q)
             (MOVEM O5 -6 Q)
(LABEL 7)    (MOVE O2 (CONSTANT 2))
             (MOVE O1 -7 Q)
             (CALL > 2)
             (JUMPN O1 8)
             (MOVE O1 -8 Q)
             (MOVEI N 1)
             (JRST 3)
(LABEL 8)    (MOVE O5 -8 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -3 Q)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -6 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 2))
             (CALL > 2)
             (JUMPE O1 10)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -2 Q)
             (JRST 11)
(LABEL 10)   (MOVE O5 -1 Q)
             (MOVEM O5 -2 Q)
(LABEL 11)   (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -1 Q)
             (PUSH Q -6 Q)
             (PUSH Q (CONSTANT 5))
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -9 Q)
             (CALL - 2)
             (MOVEM O1 -2 Q)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 2))
             (CALL > 2)
             (JUMPE O1 12)
             (PUSH Q (CONSTANT 2))
             (JRST 13)
(LABEL 12)   (PUSH Q -2 Q)
(LABEL 13)   (PUSH Q (CONSTANT 6))
             (PUSH Q -11 Q)
             (MOVE O1 -10 Q)
             (MOVE O2 -9 Q)
             (MOVE O3 -8 Q)
             (MOVE O4 -7 Q)
             (MOVE O5 -6 Q)
             (CALL REPLACE 10)
             (MOVEM O1 -8 Q)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL - 2)
             (MOVEM O1 -7 Q)
             (MOVE O2 (CONSTANT 7))
             (MOVE O1 -6 Q)
             (CALL - 2)
             (MOVEM O1 -6 Q)
             (JRST 7)
(LABEL 3)    (SUBI Q 13)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-ADD-COMMAS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (STRING COMMACHAR))) 
(%PUT (QUOTE FORMAT-ADD-COMMAS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-ADD-COMMAS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-WRITE-FIELD EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 1 2-MANY))
       #0_(0 "Mincol must be a non-negative integer - ~S" "Colinc must be a positive integer - ~S" "Minpad must be a non-negative integer - ~S" "Padchar must be a character - ~S" *STANDARD-OUTPUT*)
       (CODE-START)
(LABEL 1)    (ADDI Q 10)
             (MOVEM O1 -9 Q)
             (MOVEM O2 -8 Q)
             (MOVEM O3 -7 Q)
             (MOVEM O4 -6 Q)
             (MOVEM O5 -5 Q)
             (MOVE O1 O2)
             (CALL INTEGERP 1)
             (JUMPE1 O1 5)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -8 Q)
             (CALL < 2)
             (SKIPN NIL O1)
(LABEL 5)    (JRST 4)
             (MOVE O2 -8 Q)
             (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 4)    (MOVE O1 -7 Q)
             (CALL INTEGERP 1)
             (JUMPE1 O1 10)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL > 2)
             (SKIPE NIL O1)
(LABEL 10)   (JRST 9)
             (MOVE O2 -7 Q)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 9)    (MOVE O1 -6 Q)
             (CALL INTEGERP 1)
             (JUMPE1 O1 15)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -6 Q)
             (CALL < 2)
             (SKIPN NIL O1)
(LABEL 15)   (JRST 14)
             (MOVE O2 -6 Q)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 14)   (MOVE O1 -5 Q)
             (CALL CHARACTERP 1)
             (JUMPN O1 19)
             (MOVE O2 -5 Q)
             (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 19)   (MOVE O1 -9 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -4 Q)
             (MOVE O2 -6 Q)
             (CALL + 2)
             (MOVEM O1 -2 Q)
             (MOVE O3 -7 Q)
             (MOVE O2 -8 Q)
             (CALL LISP::FORMAT-ROUND-COLUMNS 3)
             (MOVEM O1 -3 Q)
             (SKIPN NIL -10 Q)
             (JRST 22)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O2 -4 Q)
             (MOVE O1 -3 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
(LABEL 27)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 28)
             (JRST 23)
(LABEL 28)   (MOVE O1 -5 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 27)
(LABEL 23)   (MOVE O5 (SPECIAL 5))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -9 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 21)
(LABEL 22)   (SKIPA)
             (JRST 30)
             (MOVE O5 (SPECIAL 5))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -9 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O2 -4 Q)
             (MOVE O1 -3 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
(LABEL 35)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 36)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 31)
(LABEL 36)   (MOVE O1 -5 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 35)
(LABEL 31)
(LABEL 30)
(LABEL 21)   (SUBI Q 11)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-WRITE-FIELD) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (STRING MINCOL COLINC MINPAD PADCHAR PADLEFT))) 
(%PUT (QUOTE FORMAT-WRITE-FIELD) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-WRITE-FIELD) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-NUMBER EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 1 2-MANY))
       #0_(0 #\SPACE #\, "Too many parameters" *PRINT-BASE* STRING "+" 1 T *STANDARD-OUTPUT*)
       (CODE-START)
(LABEL 1)    (ADDI Q 15)
             (MOVEM O1 -14 Q)
             (MOVEM O2 -13 Q)
             (MOVEM O3 -12 Q)
             (MOVEM O4 -11 Q)
             (MOVEM O5 -10 Q)
             (SKIPN NIL -10 Q)
             (JRST 4)
             (MOVE O1 -10 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -10 Q)
             (MOVE O1 O5)
             (JRST 5)
(LABEL 4)    (MOVE O1 NIL)
(LABEL 5)    (SKIPE NIL O1)
             (MOVEM O1 -9 Q)
             (JUMPN O1 3)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -9 Q)
(LABEL 3)    (SKIPN NIL -10 Q)
             (JRST 7)
             (MOVE O1 -10 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -10 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -8 Q)
             (JUMPN O1 6)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -8 Q)
(LABEL 6)    (SKIPN NIL -10 Q)
             (JRST 10)
             (MOVE O1 -10 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -10 Q)
             (MOVE O1 O5)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (SKIPE NIL O1)
             (MOVEM O1 -7 Q)
             (JUMPN O1 9)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -7 Q)
(LABEL 9)    (SKIPN NIL -10 Q)
             (JRST 13)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 13)   (MOVE O1 -13 Q)
             (SPEC-BIND (SPECIAL 4))
             (MOVEM O1 (SPECIAL 4))
             (MOVE O1 -14 Q)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -5 Q)
             (MOVE O1 -14 Q)
             (CALL INTEGERP 1)
             (JUMPE O1 15)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -14 Q)
             (CALL > 2)
             (JUMPE O1 19)
             (SKIPN NIL -11 Q)
(LABEL 19)   (JRST 17)
             (SKIPN NIL -12 Q)
             (JRST 21)
             (MOVE O2 -7 Q)
             (MOVE O1 -5 Q)
             (CALL LISP::FORMAT-ADD-COMMAS 2)
             (MOVE O3 O1)
             (MOVE O1 (CONSTANT 5))
             (MOVE O2 (CONSTANT 6))
             (CALL CONCATENATE 3)
             (MOVEM O1 -4 Q)
             (JRST 22)
(LABEL 21)   (MOVE O3 -5 Q)
             (MOVE O1 (CONSTANT 5))
             (MOVE O2 (CONSTANT 6))
             (CALL CONCATENATE 3)
             (MOVEM O1 -4 Q)
(LABEL 22)   (JRST 18)
(LABEL 17)   (SKIPN NIL -12 Q)
             (JRST 23)
             (MOVE O2 -7 Q)
             (MOVE O1 -5 Q)
             (CALL LISP::FORMAT-ADD-COMMAS 2)
             (MOVEM O1 -4 Q)
             (JRST 24)
(LABEL 23)   (MOVE O5 -5 Q)
             (MOVEM O5 -4 Q)
(LABEL 24)
(LABEL 18)   (MOVE O5 -9 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -2 Q)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O5 -8 Q)
             (MOVEM O5 0 Q)
             (PUSH Q (CONSTANT 8))
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
             (JRST 16)
(LABEL 15)   (MOVE O5 (SPECIAL 9))
             (MOVEM O5 -3 Q)
             (MOVE O4 NIL)
             (MOVE O1 -5 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 16)   (UNBIND 1)
             (SUBI Q 15)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-NUMBER) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (NUMBER RADIX PRINT-COMMAS-P PRINT-SIGN-P PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-NUMBER) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-NUMBER) (QUOTE %SOURCE-DOCUMENTATION)))) 
(DEFVAR CARDINAL-ONES (QUOTE #(NIL "one" "two" "three" "four" "five" "six" "seven" "eight" "nine")) "Table of cardinal ones-place digits in English") 
(DEFVAR CARDINAL-TENS (QUOTE #(NIL NIL "twenty" "thirty" "forty" "fifty" "sixty" "seventy" "eighty" "ninety")) "Table of cardinal tens-place digits in English") 
(DEFVAR CARDINAL-TEENS (QUOTE #("ten" "eleven" "twelve" "thirteen" "fourteen" "fifteen" "sixteen" "seventeen" "eighteen" "nineteen")) "Table of cardinal 'teens' digits in English") 

#_(LAP #0_FORMAT-PRINT-SMALL-CARDINAL EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(100 0 CARDINAL-ONES *STANDARD-OUTPUT* " hundred" #\SPACE 10 1 CARDINAL-TENS #\- CARDINAL-TEENS)
       (CODE-START)
(LABEL 1)    (ADDI Q 8)
             (MOVEM O1 -7 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL TRUNCATE 2)
             (ADJUST-VALUES 2)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVE O2 (CONSTANT 1))
             (CALL > 2)
             (JUMPE O1 4)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -4 Q)
             (MOVE O2 -6 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -3 Q)
             (MOVE O4 NIL)
             (MOVE O1 -4 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 1))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 -3 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 4))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 1))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O2 (CONSTANT 1))
             (MOVE O1 -5 Q)
             (CALL > 2)
             (JUMPE O1 6)
             (MOVE O1 (CONSTANT 5))
             (CALL WRITE-CHAR 1)
(LABEL 6)
(LABEL 4)    (MOVE O2 (CONSTANT 1))
             (MOVE O1 -5 Q)
             (CALL > 2)
             (JUMPE O1 10)
             (MOVE O2 (CONSTANT 6))
             (MOVE O1 -5 Q)
             (CALL TRUNCATE 2)
             (ADJUST-VALUES 2)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 7))
             (CALL < 2)
             (JUMPE O1 12)
             (MOVE O5 (SPECIAL 8))
             (MOVEM O5 -1 Q)
             (MOVE O2 -3 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 1))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O2 (CONSTANT 1))
             (MOVE O1 -2 Q)
             (CALL > 2)
             (JUMPE O1 14)
             (MOVE O1 (CONSTANT 9))
             (CALL WRITE-CHAR 1)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 1))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 13)
(LABEL 14)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 13)   (JRST 11)
(LABEL 12)   (MOVE O2 (CONSTANT 7))
             (MOVE O1 -3 Q)
             (CALL = 2)
             (JUMPE O1 16)
             (MOVE O5 (SPECIAL 10))
             (MOVEM O5 -1 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 1))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 11)
(LABEL 16)   (MOVE O2 (CONSTANT 1))
             (MOVE O1 -2 Q)
             (CALL > 2)
             (JUMPE O1 17)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -1 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 3))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 1))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 11)
(LABEL 17)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 11)   (JRST 9)
(LABEL 10)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 9)    (SUBI Q 8)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-SMALL-CARDINAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (N))) 
(%PUT (QUOTE FORMAT-PRINT-SMALL-CARDINAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-SMALL-CARDINAL) (QUOTE %SOURCE-DOCUMENTATION)))) 
(DEFCONSTANT CARDINAL-PERIODS (QUOTE #("" " thousand" " million" " billion" " trillion" " quadrillion" " quintillion" " sextillion" " septillion" " octillion" " nonillion" " decillion" " undecillion" " duodecillion" " tredecillion" " quattuordecillion" " quindecillion" " sexdecillion" " septendecillion" " octodecillion" " novemdecillion" " vigintillion")) "Table of cardinal 'illions' in English") 

#_(LAP #0_FORMAT-PRINT-CARDINAL EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(0 "negative " *STANDARD-OUTPUT* "zero")
       (CODE-START)
(LABEL 1)    (ADDI Q 3)
             (MOVEM O1 -2 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL < 2)
             (JUMPE O1 4)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O1 -2 Q)
             (CALL - 1)
             (MOVEM O1 -1 Q)
             (MOVE O3 -2 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL LISP::FORMAT-PRINT-CARDINAL-AUX 3)
             (JRST 3)
(LABEL 4)    (MOVE O1 -2 Q)
             (CALL ZEROP 1)
             (JUMPE O1 5)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 3))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 3)
(LABEL 5)    (SKIPA)
             (JRST 6)
             (MOVE O3 -2 Q)
             (MOVE O1 O3)
             (MOVE O2 (CONSTANT 0))
             (CALL LISP::FORMAT-PRINT-CARDINAL-AUX 3)
(LABEL 6)
(LABEL 3)    (SUBI Q 3)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-CARDINAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (N))) 
(%PUT (QUOTE FORMAT-PRINT-CARDINAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-CARDINAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-CARDINAL-AUX EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(1000 21 "Number too large to print in English: ~:D" #\SPACE CARDINAL-PERIODS *STANDARD-OUTPUT* 0)
       (CODE-START)
(LABEL 1)    (ADDI Q 7)
             (MOVEM O1 -6 Q)
             (MOVEM O2 -5 Q)
             (MOVEM O3 -4 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL TRUNCATE 2)
             (ADJUST-VALUES 2)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVE O2 (CONSTANT 1))
             (MOVE O1 -5 Q)
             (CALL > 2)
             (JUMPE O1 4)
             (MOVE O2 -4 Q)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 4)    (MOVE O1 -3 Q)
             (CALL ZEROP 1)
             (JUMPN O1 7)
             (MOVE O1 -5 Q)
             (CALL 1+ 1)
             (MOVEM O1 0 Q)
             (MOVE O3 -4 Q)
             (MOVE O1 -3 Q)
             (MOVE O2 0 Q)
             (CALL LISP::FORMAT-PRINT-CARDINAL-AUX 3)
(LABEL 7)    (MOVE O1 -2 Q)
             (CALL ZEROP 1)
             (JUMPN O1 10)
             (MOVE O1 -3 Q)
             (CALL ZEROP 1)
             (JUMPN O1 12)
             (MOVE O1 (CONSTANT 3))
             (CALL WRITE-CHAR 1)
(LABEL 12)   (MOVE O1 -2 Q)
             (CALL LISP::FORMAT-PRINT-SMALL-CARDINAL 1)
             (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -1 Q)
             (MOVE O2 -5 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 5))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 6))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 9)
(LABEL 10)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 9)    (SUBI Q 7)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-CARDINAL-AUX) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (N PERIOD ERR))) 
(%PUT (QUOTE FORMAT-PRINT-CARDINAL-AUX) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-CARDINAL-AUX) (QUOTE %SOURCE-DOCUMENTATION)))) 
(DEFVAR ORDINAL-ONES (QUOTE #(NIL "first" "second" "third" "fourth" "fifth" "sixth" "seventh" "eighth" "ninth")) "Table of ordinal ones-place digits in English") 
(DEFVAR ORDINAL-TENS (QUOTE #(NIL "tenth" "twentieth" "thirtieth" "fortieth" "fiftieth" "sixtieth" "seventieth" "eightieth" "ninetieth")) "Table of ordinal tens-place digits in English") 

#_(LAP #0_FORMAT-PRINT-ORDINAL EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(0 "negative " *STANDARD-OUTPUT* 100 #\SPACE 10 12 "twelfth" 1 CARDINAL-TEENS "th" ORDINAL-ONES ORDINAL-TENS CARDINAL-TENS #\- "zeroeth")
       (CODE-START)
(LABEL 1)    (ADDI Q 8)
             (MOVEM O1 -7 Q)
             (MOVE O2 (CONSTANT 0))
             (CALL < 2)
             (JUMPE O1 4)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 -6 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 1))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 4)    (MOVE O1 -7 Q)
             (CALL ABS 1)
             (MOVEM O1 -6 Q)
             (MOVE O2 (CONSTANT 3))
             (CALL TRUNCATE 2)
             (ADJUST-VALUES 2)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (CALL ZEROP 1)
             (JUMPN O1 7)
             (MOVE O2 -5 Q)
             (MOVE O1 (CONSTANT 3))
             (CALL * 2)
             (CALL LISP::FORMAT-PRINT-CARDINAL 1)
(LABEL 7)    (MOVE O2 (CONSTANT 0))
             (MOVE O1 -5 Q)
             (CALL > 2)
             (JUMPE O1 11)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -4 Q)
             (CALL > 2)
             (SKIPN NIL O1)
(LABEL 11)   (JRST 10)
             (MOVE O1 (CONSTANT 4))
             (CALL WRITE-CHAR 1)
(LABEL 10)   (MOVE O2 (CONSTANT 5))
             (MOVE O1 -4 Q)
             (CALL TRUNCATE 2)
             (ADJUST-VALUES 2)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVE O2 (CONSTANT 6))
             (MOVE O1 -4 Q)
             (CALL = 2)
             (JUMPE O1 15)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 7))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 14)
(LABEL 15)   (MOVE O2 (CONSTANT 8))
             (MOVE O1 -3 Q)
             (CALL = 2)
             (JUMPE O1 16)
             (MOVE O5 (SPECIAL 9))
             (MOVEM O5 -1 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 10))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 14)
(LABEL 16)   (MOVE O1 -3 Q)
             (CALL ZEROP 1)
             (JUMPE O1 18)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -2 Q)
             (CALL > 2)
             (SKIPN NIL O1)
(LABEL 18)   (JRST 17)
             (MOVE O5 (SPECIAL 11))
             (MOVEM O5 -1 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 14)
(LABEL 17)   (MOVE O1 -2 Q)
             (CALL ZEROP 1)
             (JUMPE O1 21)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -3 Q)
             (CALL > 2)
             (SKIPN NIL O1)
(LABEL 21)   (JRST 20)
             (MOVE O5 (SPECIAL 12))
             (MOVEM O5 -1 Q)
             (MOVE O2 -3 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 14)
(LABEL 20)   (MOVE O2 (CONSTANT 0))
             (MOVE O1 -4 Q)
             (CALL > 2)
             (JUMPE O1 23)
             (MOVE O5 (SPECIAL 13))
             (MOVEM O5 -1 Q)
             (MOVE O2 -3 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (MOVE O1 (CONSTANT 14))
             (CALL WRITE-CHAR 1)
             (MOVE O5 (SPECIAL 11))
             (MOVEM O5 -1 Q)
             (MOVE O2 -2 Q)
             (MOVE O1 O5)
             (ADDI O1 0 O2)
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 -1 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 14)
(LABEL 23)   (MOVE O2 (CONSTANT 0))
             (MOVE O1 -6 Q)
             (CALL > 2)
             (JUMPE O1 24)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 10))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 14)
(LABEL 24)   (SKIPA)
             (JRST 25)
             (MOVE O5 (SPECIAL 2))
             (MOVEM O5 0 Q)
             (MOVE O4 NIL)
             (MOVE O1 (CONSTANT 15))
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 25)
(LABEL 14)   (SUBI Q 8)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-ORDINAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (N))) 
(%PUT (QUOTE FORMAT-PRINT-ORDINAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-ORDINAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-OLD-ROMAN EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(0 5000 "Number too large to print in old Roman numerals: ~:D" (#\D #\C #\L #\X #\V #\I) (500 100 50 10 5 1) #\M 1000)
       (CODE-START)
(LABEL 1)    (ADDI Q 12)
             (MOVEM O1 -11 Q)
             (MOVE O3 (CONSTANT 1))
             (MOVE O1 (CONSTANT 0))
             (MOVE O2 -11 Q)
             (CALL < 3)
             (JUMPN O1 4)
             (MOVE O2 -11 Q)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 4)    (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -10 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -9 Q)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -8 Q)
             (MOVE O5 (CONSTANT 6))
             (MOVEM O5 -7 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 -6 Q)
(LABEL 10)   (MOVE O1 -6 Q)
             (CALL ZEROP 1)
             (JUMPE O1 11)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 6)
(LABEL 11)   (MOVE O1 -10 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 -9 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 -10 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -3 Q)
             (MOVE O1 -9 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -2 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 0 Q)
(LABEL 17)   (MOVE O2 -7 Q)
             (MOVE O1 0 Q)
             (CALL < 2)
             (JUMPE O1 18)
             (MOVE O5 0 Q)
             (MOVEM O5 -1 Q)
             (JRST 13)
(LABEL 18)   (MOVE O1 -8 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O2 -7 Q)
             (MOVE O1 0 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
             (JRST 17)
(LABEL 13)   (MOVE O1 -5 Q)
             (MOVEM O1 -10 Q)
             (MOVE O1 -4 Q)
             (MOVEM O1 -9 Q)
             (MOVE O1 -3 Q)
             (MOVEM O1 -8 Q)
             (MOVE O1 -2 Q)
             (MOVEM O1 -7 Q)
             (MOVE O1 -1 Q)
             (MOVEM O1 -6 Q)
             (JRST 10)
(LABEL 6)    (SUBI Q 12)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-OLD-ROMAN) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (N))) 
(%PUT (QUOTE FORMAT-PRINT-OLD-ROMAN) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-OLD-ROMAN) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-ROMAN EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(0 4000 "Number too large to print in Roman numerals: ~:D" (#\D #\C #\L #\X #\V #\I) (500 100 50 10 5 1) (#\C #\X #\X #\I #\I) (100 10 10 1 1 0) #\M 1000 #\C 100)
       (CODE-START)
(LABEL 1)    (ADDI Q 21)
             (MOVEM O1 -20 Q)
             (MOVE O3 (CONSTANT 1))
             (MOVE O1 (CONSTANT 0))
             (MOVE O2 -20 Q)
             (CALL < 3)
             (JUMPN O1 4)
             (MOVE O2 -20 Q)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 2)
(LABEL 4)    (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -19 Q)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -18 Q)
             (MOVE O5 (CONSTANT 5))
             (MOVEM O5 -17 Q)
             (MOVE O5 (CONSTANT 6))
             (MOVEM O5 -16 Q)
             (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -15 Q)
             (MOVE O5 (CONSTANT 8))
             (MOVEM O5 -14 Q)
             (MOVE O5 (CONSTANT 9))
             (MOVEM O5 -13 Q)
             (MOVE O5 (CONSTANT 10))
             (MOVEM O5 -12 Q)
             (MOVE O5 -20 Q)
             (MOVEM O5 -11 Q)
(LABEL 10)   (MOVE O1 -11 Q)
             (CALL ZEROP 1)
             (JUMPE O1 11)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 6)
(LABEL 11)   (MOVE O1 -19 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -10 Q)
             (MOVE O1 -18 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -9 Q)
             (MOVE O1 -17 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 -16 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -7 Q)
             (MOVE O1 -19 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 -18 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -5 Q)
             (MOVE O1 -17 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -4 Q)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -3 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 -1 Q)
(LABEL 17)   (MOVE O2 -14 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPE O1 18)
             (MOVE O2 -12 Q)
             (MOVE O1 -14 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
             (MOVE O2 -1 Q)
             (CALL > 2)
             (JUMPN O1 21)
             (MOVE O1 -13 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -15 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O2 -12 Q)
             (MOVE O1 -14 Q)
             (CALL - 2)
             (MOVE O2 O1)
             (MOVE O1 -1 Q)
             (CALL - 2)
             (MOVEM O1 -2 Q)
             (JRST 20)
(LABEL 21)   (SKIPA)
             (JRST 22)
             (MOVE O5 -1 Q)
             (MOVEM O5 -2 Q)
(LABEL 22)
(LABEL 20)   (JRST 13)
(LABEL 18)   (MOVE O1 -15 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O2 -14 Q)
             (MOVE O1 -1 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
             (JRST 17)
(LABEL 13)   (MOVE O1 -10 Q)
             (MOVEM O1 -19 Q)
             (MOVE O1 -9 Q)
             (MOVEM O1 -18 Q)
             (MOVE O1 -8 Q)
             (MOVEM O1 -17 Q)
             (MOVE O1 -7 Q)
             (MOVEM O1 -16 Q)
             (MOVE O1 -6 Q)
             (MOVEM O1 -15 Q)
             (MOVE O1 -5 Q)
             (MOVEM O1 -14 Q)
             (MOVE O1 -4 Q)
             (MOVEM O1 -13 Q)
             (MOVE O1 -3 Q)
             (MOVEM O1 -12 Q)
             (MOVE O1 -2 Q)
             (MOVEM O1 -11 Q)
             (JRST 10)
(LABEL 6)    (SUBI Q 21)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-ROMAN) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (N))) 
(%PUT (QUOTE FORMAT-PRINT-ROMAN) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-ROMAN) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-DECIMAL EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" 10)
       (CODE-START)
(LABEL 1)    (ADDI Q 4)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVEM O3 -1 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 0 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 0 Q)
(LABEL 4)    (MOVE O5 -1 Q)
             (MOVE O1 0 Q)
             (MOVE O2 (CONSTANT 2))
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (CALL LISP::FORMAT-PRINT-NUMBER 5)
             (SUBI Q 4)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-DECIMAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-DECIMAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-DECIMAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-BINARY EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" 2)
       (CODE-START)
(LABEL 1)    (ADDI Q 4)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVEM O3 -1 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 0 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 0 Q)
(LABEL 4)    (MOVE O5 -1 Q)
             (MOVE O1 0 Q)
             (MOVE O2 (CONSTANT 2))
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (CALL LISP::FORMAT-PRINT-NUMBER 5)
             (SUBI Q 4)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-BINARY) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-BINARY) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-BINARY) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-OCTAL EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" 8)
       (CODE-START)
(LABEL 1)    (ADDI Q 4)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVEM O3 -1 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 0 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 0 Q)
(LABEL 4)    (MOVE O5 -1 Q)
             (MOVE O1 0 Q)
             (MOVE O2 (CONSTANT 2))
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (CALL LISP::FORMAT-PRINT-NUMBER 5)
             (SUBI Q 4)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-OCTAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-OCTAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-OCTAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-HEXADECIMAL EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument" 16)
       (CODE-START)
(LABEL 1)    (ADDI Q 4)
             (MOVEM O1 -3 Q)
             (MOVEM O2 -2 Q)
             (MOVEM O3 -1 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 0 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 0 Q)
(LABEL 4)    (MOVE O5 -1 Q)
             (MOVE O1 0 Q)
             (MOVE O2 (CONSTANT 2))
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (CALL LISP::FORMAT-PRINT-NUMBER 5)
             (SUBI Q 4)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-HEXADECIMAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-HEXADECIMAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-HEXADECIMAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-PRINT-RADIX EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(*FORMAT-ARGUMENTS* "Missing argument")
       (CODE-START)
(LABEL 1)    (ADDI Q 6)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (SKIPN NIL (SPECIAL 0))
             (JRST 3)
             (MOVE O1 (SPECIAL 0))
             (MOVE O5 0 O1)
             (MOVEM O5 -1 Q)
             (MOVE O1 (SPECIAL 0))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 0))
             (MOVEM O5 -2 Q)
             (JRST 4)
(LABEL 3)    (MOVE O1 (CONSTANT 1))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -2 Q)
(LABEL 4)    (SKIPN NIL -3 Q)
             (JRST 5)
             (MOVE O1 -3 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -3 Q)
             (MOVE O5 O1)
             (MOVE O1 -2 Q)
             (MOVE O2 0 Q)
             (MOVE O3 -5 Q)
             (MOVE O4 -4 Q)
             (CALL LISP::FORMAT-PRINT-NUMBER 5)
             (JRST 6)
(LABEL 5)    (SKIPN NIL -4 Q)
             (JRST 7)
             (SKIPN NIL -5 Q)
             (JRST 9)
             (MOVE O1 -2 Q)
             (CALL LISP::FORMAT-PRINT-OLD-ROMAN 1)
             (JRST 10)
(LABEL 9)    (MOVE O1 -2 Q)
             (CALL LISP::FORMAT-PRINT-ROMAN 1)
(LABEL 10)   (JRST 8)
(LABEL 7)    (SKIPN NIL -5 Q)
             (JRST 11)
             (MOVE O1 -2 Q)
             (CALL LISP::FORMAT-PRINT-ORDINAL 1)
             (JRST 12)
(LABEL 11)   (MOVE O1 -2 Q)
             (CALL LISP::FORMAT-PRINT-CARDINAL 1)
(LABEL 12)
(LABEL 8)
(LABEL 6)    (SUBI Q 6)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-PRINT-RADIX) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-PRINT-RADIX) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-PRINT-RADIX) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-FIXED EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Colon flag not allowed" #\SPACE "Too many parameters" *FORMAT-ARGUMENTS* "Missing argument" SHORT-FLOAT 10 *PRINT-BASE* 1 0 T)
       (CODE-START)
(LABEL 1)    (ADDI Q 17)
             (MOVEM O1 -16 Q)
             (MOVEM O2 -15 Q)
             (MOVEM O3 -14 Q)
             (SKIPN NIL -16 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -14 Q)
             (JRST 7)
             (MOVE O1 -14 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -12 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -14 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -13 Q)
             (JUMPN O1 6)
             (MOVEM NIL -13 Q)
(LABEL 6)    (SKIPN NIL -14 Q)
             (JRST 10)
             (MOVE O1 -14 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -11 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -14 Q)
             (MOVE O1 O5)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (SKIPE NIL O1)
             (MOVEM O1 -12 Q)
             (JUMPN O1 9)
             (MOVEM NIL -12 Q)
(LABEL 9)    (SKIPN NIL -14 Q)
             (JRST 13)
             (MOVE O1 -14 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -10 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -14 Q)
             (MOVE O1 O5)
             (JRST 14)
(LABEL 13)   (MOVE O1 NIL)
(LABEL 14)   (SKIPE NIL O1)
             (MOVEM O1 -11 Q)
             (JUMPN O1 12)
             (MOVEM NIL -11 Q)
(LABEL 12)   (SKIPN NIL -14 Q)
             (JRST 16)
             (MOVE O1 -14 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -9 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -14 Q)
             (MOVE O1 O5)
             (JRST 17)
(LABEL 16)   (MOVE O1 NIL)
(LABEL 17)   (SKIPE NIL O1)
             (MOVEM O1 -10 Q)
             (JUMPN O1 15)
             (MOVEM NIL -10 Q)
(LABEL 15)   (SKIPN NIL -14 Q)
             (JRST 19)
             (MOVE O1 -14 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -14 Q)
             (MOVE O1 O5)
             (JRST 20)
(LABEL 19)   (MOVE O1 NIL)
(LABEL 20)   (SKIPE NIL O1)
             (MOVEM O1 -9 Q)
             (JUMPN O1 18)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -9 Q)
(LABEL 18)   (SKIPN NIL -14 Q)
             (JRST 22)
             (MOVE O1 (CONSTANT 2))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 22)   (SKIPN NIL (SPECIAL 3))
             (JRST 24)
             (MOVE O1 (SPECIAL 3))
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 (SPECIAL 3))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 3))
             (MOVEM O5 -7 Q)
             (JRST 25)
(LABEL 24)   (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -7 Q)
(LABEL 25)   (MOVE O1 -7 Q)
             (CALL FLOATP 1)
             (JUMPE O1 26)
             (MOVE O5 -7 Q)
             (MOVEM O5 -6 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -10 Q)
             (MOVEM O5 -2 Q)
             (PUSH Q -9 Q)
             (PUSH Q -16 Q)
             (MOVE O1 -8 Q)
             (MOVE O2 -7 Q)
             (MOVE O3 -6 Q)
             (MOVE O4 -5 Q)
             (MOVE O5 -4 Q)
             (CALL LISP::FORMAT-FIXED-AUX 7)
             (JRST 27)
(LABEL 26)   (MOVE O1 -7 Q)
             (CALL RATIONALP 1)
             (JUMPE O1 28)
             (MOVE O2 (CONSTANT 5))
             (MOVE O1 -7 Q)
             (CALL COERCE 2)
             (MOVEM O1 -6 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -10 Q)
             (MOVEM O5 -2 Q)
             (PUSH Q -9 Q)
             (PUSH Q -16 Q)
             (MOVE O1 -8 Q)
             (MOVE O2 -7 Q)
             (MOVE O3 -6 Q)
             (MOVE O4 -5 Q)
             (MOVE O5 -4 Q)
             (CALL LISP::FORMAT-FIXED-AUX 7)
             (JRST 29)
(LABEL 28)   (MOVE O5 (CONSTANT 6))
             (MOVEM O5 -5 Q)
             (MOVE O1 O5)
             (SPEC-BIND (SPECIAL 7))
             (MOVEM O1 (SPECIAL 7))
             (MOVE O1 -7 Q)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -4 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 8))
             (MOVEM O5 -2 Q)
             (MOVE O5 (CONSTANT 9))
             (MOVEM O5 -1 Q)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 0 Q)
             (PUSH Q (CONSTANT 10))
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
             (UNBIND 1)
(LABEL 29)
(LABEL 27)   (SUBI Q 17)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-FIXED) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-FIXED) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-FIXED) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-FIXED-AUX EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 1 2-MANY))
       #0_(0 #\- #\+ #\0 *STANDARD-OUTPUT*)
       (CODE-START)
(LABEL 1)    (ADDI Q 13)
             (MOVEM O1 -12 Q)
             (MOVEM O2 -11 Q)
             (MOVEM O3 -10 Q)
             (MOVEM O4 -9 Q)
             (MOVEM O5 -8 Q)
             (SKIPE NIL -11 Q)
             (JRST 5)
             (SKIPE NIL -10 Q)
(LABEL 5)    (JRST 3)
             (MOVE O1 -12 Q)
             (CALL PRIN1 1)
             (JRST 4)
(LABEL 3)    (MOVE O5 -11 Q)
             (MOVEM O5 -7 Q)
             (SKIPN NIL -11 Q)
             (JRST 8)
             (SKIPE NIL -13 Q)
             (JRST1 10)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -12 Q)
             (CALL < 2)
             (SKIPN NIL O1)
(LABEL 10)
(LABEL 8)    (JRST 7)
             (MOVE O1 -7 Q)
             (CALL 1- 1)
             (MOVEM O1 -5 Q)
             (MOVEM O1 -7 Q)
(LABEL 7)    (MOVE O1 -12 Q)
             (CALL ABS 1)
             (MOVEM O1 -6 Q)
             (MOVE O4 -9 Q)
             (MOVE O2 -7 Q)
             (MOVE O3 -10 Q)
             (CALL LISP::FLONUM-TO-STRING 4)
             (ADJUST-VALUES 4)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (MOVEM O4 -2 Q)
             (SKIPN NIL -10 Q)
             (JRST 14)
             (MOVE O1 -10 Q)
             (CALL ZEROP 1)
             (SKIPN NIL O1)
(LABEL 14)   (JRST 13)
             (MOVE O1 NIL)
             (MOVEM O1 -2 Q)
(LABEL 13)   (SKIPN NIL -11 Q)
             (JRST 18)
             (MOVE O2 -4 Q)
             (MOVE O1 -7 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
             (MOVEM O1 -7 Q)
             (SKIPN NIL -3 Q)
             (JRST 20)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL > 2)
             (JUMPN1 O1 23)
             (SKIPN NIL -2 Q)
(LABEL 23)   (JRST 21)
             (MOVE O1 -7 Q)
             (CALL 1- 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 -7 Q)
             (JRST 22)
(LABEL 21)   (MOVE O1 NIL)
             (MOVEM O1 -3 Q)
(LABEL 22)
(LABEL 20)   (SKIPN NIL -2 Q)
             (JRST 26)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL > 2)
             (JUMPE O1 27)
             (MOVE O1 -7 Q)
             (CALL 1- 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 -7 Q)
             (JRST 28)
(LABEL 27)   (MOVE O1 NIL)
             (MOVEM O1 -2 Q)
(LABEL 28)
(LABEL 26)
(LABEL 18)   (SKIPN NIL -11 Q)
             (JRST 33)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL < 2)
             (JUMPE O1 33)
             (SKIPN NIL -8 Q)
(LABEL 33)   (JRST 32)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 0 Q)
(LABEL 39)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 40)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 35)
(LABEL 40)   (MOVE O1 -8 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 39)
(LABEL 35)   (JRST 31)
(LABEL 32)   (SKIPA)
             (JRST 42)
             (SKIPN NIL -11 Q)
             (JRST 44)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 0 Q)
(LABEL 49)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 50)
             (JRST 45)
(LABEL 50)   (MOVE O1 -14 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 49)
(LABEL 45)
(LABEL 44)   (MOVE O2 (CONSTANT 0))
             (MOVE O1 -12 Q)
             (CALL < 2)
             (JUMPE O1 53)
             (MOVE O1 (CONSTANT 1))
             (CALL WRITE-CHAR 1)
             (JRST 54)
(LABEL 53)   (SKIPN NIL -13 Q)
             (JRST 55)
             (MOVE O1 (CONSTANT 2))
             (CALL WRITE-CHAR 1)
(LABEL 55)
(LABEL 54)   (SKIPN NIL -3 Q)
             (JRST 58)
             (MOVE O1 (CONSTANT 3))
             (CALL WRITE-CHAR 1)
(LABEL 58)   (MOVE O5 (SPECIAL 4))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -5 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (SKIPN NIL -2 Q)
             (JRST 61)
             (MOVE O1 (CONSTANT 3))
             (CALL WRITE-CHAR 1)
             (JRST 60)
(LABEL 61)   (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 60)
(LABEL 42)
(LABEL 31)
(LABEL 4)    (SUBI Q 15)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-FIXED-AUX) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (NUMBER W D K OVF PAD ATSIGN))) 
(%PUT (QUOTE FORMAT-FIXED-AUX) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-FIXED-AUX) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-EXPONENTIAL EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Colon flag not allowed" 1 #\SPACE "Too many parameters" *FORMAT-ARGUMENTS* "Missing argument" SHORT-FLOAT 10 *PRINT-BASE* 0 T)
       (CODE-START)
(LABEL 1)    (ADDI Q 19)
             (MOVEM O1 -18 Q)
             (MOVEM O2 -17 Q)
             (MOVEM O3 -16 Q)
             (SKIPN NIL -18 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -16 Q)
             (JRST 7)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -14 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -15 Q)
             (JUMPN O1 6)
             (MOVEM NIL -15 Q)
(LABEL 6)    (SKIPN NIL -16 Q)
             (JRST 10)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -13 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (SKIPE NIL O1)
             (MOVEM O1 -14 Q)
             (JUMPN O1 9)
             (MOVEM NIL -14 Q)
(LABEL 9)    (SKIPN NIL -16 Q)
             (JRST 13)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -12 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 14)
(LABEL 13)   (MOVE O1 NIL)
(LABEL 14)   (SKIPE NIL O1)
             (MOVEM O1 -13 Q)
             (JUMPN O1 12)
             (MOVEM NIL -13 Q)
(LABEL 12)   (SKIPN NIL -16 Q)
             (JRST 16)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -11 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 17)
(LABEL 16)   (MOVE O1 NIL)
(LABEL 17)   (SKIPE NIL O1)
             (MOVEM O1 -12 Q)
             (JUMPN O1 15)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -12 Q)
(LABEL 15)   (SKIPN NIL -16 Q)
             (JRST 19)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -10 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 20)
(LABEL 19)   (MOVE O1 NIL)
(LABEL 20)   (SKIPE NIL O1)
             (MOVEM O1 -11 Q)
             (JUMPN O1 18)
             (MOVEM NIL -11 Q)
(LABEL 18)   (SKIPN NIL -16 Q)
             (JRST 22)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -9 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 23)
(LABEL 22)   (MOVE O1 NIL)
(LABEL 23)   (SKIPE NIL O1)
             (MOVEM O1 -10 Q)
             (JUMPN O1 21)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -10 Q)
(LABEL 21)   (SKIPN NIL -16 Q)
             (JRST 25)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 26)
(LABEL 25)   (MOVE O1 NIL)
(LABEL 26)   (SKIPE NIL O1)
             (MOVEM O1 -9 Q)
             (JUMPN O1 24)
             (MOVEM NIL -9 Q)
(LABEL 24)   (SKIPN NIL -16 Q)
             (JRST 28)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 28)   (SKIPN NIL (SPECIAL 4))
             (JRST 30)
             (MOVE O1 (SPECIAL 4))
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 (SPECIAL 4))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 4))
             (MOVEM O5 -7 Q)
             (JRST 31)
(LABEL 30)   (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -7 Q)
(LABEL 31)   (MOVE O1 -7 Q)
             (CALL FLOATP 1)
             (JUMPE O1 32)
             (MOVE O5 -7 Q)
             (MOVEM O5 -6 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -14 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -2 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -20 Q)
             (MOVE O1 -10 Q)
             (MOVE O2 -9 Q)
             (MOVE O3 -8 Q)
             (MOVE O4 -7 Q)
             (MOVE O5 -6 Q)
             (CALL LISP::FORMAT-EXP-AUX 9)
             (JRST 33)
(LABEL 32)   (MOVE O1 -7 Q)
             (CALL RATIONALP 1)
             (JUMPE O1 34)
             (MOVE O2 (CONSTANT 6))
             (MOVE O1 -7 Q)
             (CALL COERCE 2)
             (MOVEM O1 -6 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -14 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -2 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -20 Q)
             (MOVE O1 -10 Q)
             (MOVE O2 -9 Q)
             (MOVE O3 -8 Q)
             (MOVE O4 -7 Q)
             (MOVE O5 -6 Q)
             (CALL LISP::FORMAT-EXP-AUX 9)
             (JRST 35)
(LABEL 34)   (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -5 Q)
             (MOVE O1 O5)
             (SPEC-BIND (SPECIAL 8))
             (MOVEM O1 (SPECIAL 8))
             (MOVE O1 -7 Q)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -4 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -2 Q)
             (MOVE O5 (CONSTANT 9))
             (MOVEM O5 -1 Q)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 0 Q)
             (PUSH Q (CONSTANT 10))
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
             (UNBIND 1)
(LABEL 35)
(LABEL 33)   (SUBI Q 19)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-EXPONENTIAL) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-EXPONENTIAL) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-EXPONENTIAL) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-EXPONENT-MARKER EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(*READ-DEFAULT-FLOAT-FORMAT* #\E SHORT-FLOAT #\S SINGLE-FLOAT #\F DOUBLE-FLOAT #\D LONG-FLOAT #\L)
       (CODE-START)
(LABEL 1)    (ADDI Q 2)
             (MOVEM O1 -1 Q)
             (MOVE O2 (SPECIAL 0))
             (CALL TYPEP 2)
             (JUMPE O1 3)
             (MOVE O1 (CONSTANT 1))
             (MOVEI N 1)
             (JRST 4)
(LABEL 3)    (MOVE O5 -1 Q)
             (MOVEM O5 0 Q)
             (MOVE O2 (CONSTANT 2))
             (MOVE O1 O5)
             (CALL TYPEP 2)
             (JUMPE O1 6)
             (MOVE O1 (CONSTANT 3))
             (MOVEI N 1)
             (JRST 5)
(LABEL 6)    (MOVE O2 (CONSTANT 4))
             (MOVE O1 0 Q)
             (CALL TYPEP 2)
             (JUMPE O1 7)
             (MOVE O1 (CONSTANT 5))
             (MOVEI N 1)
             (JRST 5)
(LABEL 7)    (MOVE O2 (CONSTANT 6))
             (MOVE O1 0 Q)
             (CALL TYPEP 2)
             (JUMPE O1 8)
             (MOVE O1 (CONSTANT 7))
             (MOVEI N 1)
             (JRST 5)
(LABEL 8)    (MOVE O2 (CONSTANT 8))
             (MOVE O1 0 Q)
             (CALL TYPEP 2)
             (JUMPE O1 9)
             (MOVE O1 (CONSTANT 9))
             (MOVEI N 1)
             (JRST 5)
(LABEL 9)    (MOVE O1 NIL)
             (MOVEI N 1)
(LABEL 5)
(LABEL 4)    (SUBI Q 2)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-EXPONENT-MARKER) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (NUMBER))) 
(%PUT (QUOTE FORMAT-EXPONENT-MARKER) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-EXPONENT-MARKER) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-EXP-AUX EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 1 2-MANY))
       #0_(0 1 2 #\- #\+ #\0 *STANDARD-OUTPUT*)
       (CODE-START)
(LABEL 1)    (ADDI Q 20)
             (MOVEM O1 -19 Q)
             (MOVEM O2 -18 Q)
             (MOVEM O3 -17 Q)
             (MOVEM O4 -16 Q)
             (MOVEM O5 -15 Q)
             (SKIPE NIL -18 Q)
             (JRST 5)
             (SKIPE NIL -17 Q)
(LABEL 5)    (JRST 3)
             (MOVE O1 -19 Q)
             (CALL PRIN1 1)
             (JRST 4)
(LABEL 3)    (MOVE O1 -19 Q)
             (CALL ABS 1)
             (CALL LISP::SCALE-EXPONENT 1)
             (ADJUST-VALUES 2)
             (MOVEM O1 -14 Q)
             (MOVEM O2 -13 Q)
             (MOVE O2 -15 Q)
             (MOVE O1 -13 Q)
             (CALL - 2)
             (MOVEM O1 -12 Q)
             (CALL ABS 1)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -11 Q)
             (SKIPN NIL -16 Q)
             (JRST 6)
             (MOVE O1 -11 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -8 Q)
             (MOVE O2 -16 Q)
             (CALL > 2)
             (JUMPE O1 8)
             (MOVE O5 -8 Q)
             (MOVEM O5 -10 Q)
             (JRST 9)
(LABEL 8)    (MOVE O5 -16 Q)
             (MOVEM O5 -10 Q)
(LABEL 9)    (JRST 7)
(LABEL 6)    (MOVE O1 -11 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -10 Q)
(LABEL 7)    (SKIPN NIL -17 Q)
             (JRST 10)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -15 Q)
             (CALL > 2)
             (JUMPE O1 12)
             (MOVE O2 -15 Q)
             (MOVE O1 -17 Q)
             (CALL - 2)
             (CALL 1+ 1)
             (MOVEM O1 -9 Q)
             (JRST 13)
(LABEL 12)   (MOVE O5 -17 Q)
             (MOVEM O5 -9 Q)
(LABEL 13)   (JRST 11)
(LABEL 10)   (MOVEM NIL -9 Q)
(LABEL 11)   (MOVE O2 (CONSTANT 0))
             (MOVE O1 -15 Q)
             (CALL < 2)
             (JUMPE O1 14)
             (MOVE O2 -15 Q)
             (MOVE O1 (CONSTANT 1))
             (CALL - 2)
             (MOVEM O1 -8 Q)
             (JRST 15)
(LABEL 14)   (MOVEM NIL -8 Q)
(LABEL 15)   (SKIPN NIL -18 Q)
             (JRST 16)
             (MOVE O2 (CONSTANT 2))
             (MOVE O1 -18 Q)
             (CALL - 2)
             (MOVEM O1 -6 Q)
             (MOVE O2 -10 Q)
             (CALL - 2)
             (MOVEM O1 -7 Q)
             (JRST 17)
(LABEL 16)   (MOVEM NIL -7 Q)
(LABEL 17)   (SKIPE NIL -20 Q)
             (JRST1 20)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -19 Q)
             (CALL < 2)
             (SKIPN NIL O1)
(LABEL 20)   (JRST 19)
             (MOVE O1 -7 Q)
             (CALL 1- 1)
             (MOVEM O1 -5 Q)
             (MOVEM O1 -7 Q)
(LABEL 19)   (SKIPN NIL -18 Q)
             (JRST 24)
             (SKIPN NIL -16 Q)
             (JRST 24)
             (SKIPN NIL -23 Q)
             (JRST 24)
             (MOVE O2 -16 Q)
             (MOVE O1 -10 Q)
             (CALL > 2)
             (SKIPN NIL O1)
(LABEL 24)   (JRST 22)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -5 Q)
             (MOVE O5 -18 Q)
             (MOVEM O5 -4 Q)
(LABEL 30)   (MOVE O2 -4 Q)
             (MOVE O1 -5 Q)
             (CALL < 2)
             (JUMPN O1 31)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 26)
(LABEL 31)   (MOVE O1 -23 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -5 Q)
             (CALL 1+ 1)
             (MOVEM O1 -5 Q)
             (JRST 30)
(LABEL 26)   (JRST 23)
(LABEL 22)   (MOVE O5 -8 Q)
             (MOVE O1 -14 Q)
             (MOVE O2 -7 Q)
             (MOVE O3 -9 Q)
             (MOVE O4 -15 Q)
             (CALL LISP::FLONUM-TO-STRING 5)
             (ADJUST-VALUES 4)
             (MOVEM O1 -5 Q)
             (MOVEM O2 -4 Q)
             (MOVEM O3 -3 Q)
             (MOVEM O4 -2 Q)
             (SKIPN NIL -18 Q)
             (JRST 34)
             (MOVE O2 -4 Q)
             (MOVE O1 -7 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
             (MOVEM O1 -7 Q)
             (SKIPN NIL -3 Q)
             (JRST 36)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL > 2)
             (JUMPE O1 37)
             (MOVE O1 -7 Q)
             (CALL 1- 1)
             (MOVEM O1 -1 Q)
             (MOVEM O1 -7 Q)
             (JRST 38)
(LABEL 37)   (MOVE O1 NIL)
             (MOVEM O1 -3 Q)
(LABEL 38)
(LABEL 36)
(LABEL 34)   (SKIPN NIL -18 Q)
             (JRST 43)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -7 Q)
             (CALL < 2)
             (JUMPE O1 43)
             (SKIPN NIL -23 Q)
(LABEL 43)   (JRST 42)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O5 -18 Q)
             (MOVEM O5 0 Q)
(LABEL 49)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 50)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 45)
(LABEL 50)   (MOVE O1 -23 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 49)
(LABEL 45)   (JRST 41)
(LABEL 42)   (SKIPA)
             (JRST 52)
             (SKIPN NIL -18 Q)
             (JRST 54)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 0 Q)
(LABEL 59)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 60)
             (JRST 55)
(LABEL 60)   (MOVE O1 -22 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 59)
(LABEL 55)
(LABEL 54)   (MOVE O2 (CONSTANT 0))
             (MOVE O1 -19 Q)
             (CALL < 2)
             (JUMPE O1 63)
             (MOVE O1 (CONSTANT 3))
             (CALL WRITE-CHAR 1)
             (JRST 64)
(LABEL 63)   (SKIPN NIL -20 Q)
             (JRST 65)
             (MOVE O1 (CONSTANT 4))
             (CALL WRITE-CHAR 1)
(LABEL 65)
(LABEL 64)   (SKIPN NIL -3 Q)
             (JRST 68)
             (MOVE O1 (CONSTANT 5))
             (CALL WRITE-CHAR 1)
(LABEL 68)   (MOVE O5 (SPECIAL 6))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -5 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
             (SKIPN NIL -21 Q)
             (JRST 70)
             (MOVE O1 -21 Q)
             (JRST 71)
(LABEL 70)   (MOVE O1 -19 Q)
             (CALL LISP::FORMAT-EXPONENT-MARKER 1)
(LABEL 71)   (CALL WRITE-CHAR 1)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -12 Q)
             (CALL < 2)
             (JUMPE O1 72)
             (MOVE O1 (CONSTANT 3))
             (JRST 73)
(LABEL 72)   (MOVE O1 (CONSTANT 4))
(LABEL 73)   (CALL WRITE-CHAR 1)
             (SKIPN NIL -16 Q)
             (JRST 75)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -1 Q)
             (MOVE O1 -11 Q)
             (CALL LENGTH 1)
             (MOVE O2 O1)
             (MOVE O1 -16 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
(LABEL 80)   (MOVE O2 0 Q)
             (MOVE O1 -1 Q)
             (CALL < 2)
             (JUMPN O1 81)
             (JRST 76)
(LABEL 81)   (MOVE O1 (CONSTANT 5))
             (CALL WRITE-CHAR 1)
             (MOVE O1 -1 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (JRST 80)
(LABEL 76)
(LABEL 75)   (MOVE O5 (SPECIAL 6))
             (MOVEM O5 -1 Q)
             (MOVE O4 NIL)
             (MOVE O1 -11 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 0))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 52)
(LABEL 41)
(LABEL 23)
(LABEL 4)    (SUBI Q 24)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-EXP-AUX) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (NUMBER W D E K OVF PAD MARKER ATSIGN))) 
(%PUT (QUOTE FORMAT-EXP-AUX) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-EXP-AUX) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-GENERAL-FLOAT EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_("Colon flag not allowed" #\* #\SPACE "Too many parameters" *FORMAT-ARGUMENTS* "Missing argument" SHORT-FLOAT 10 *PRINT-BASE* 1 0 T)
       (CODE-START)
(LABEL 1)    (ADDI Q 19)
             (MOVEM O1 -18 Q)
             (MOVEM O2 -17 Q)
             (MOVEM O3 -16 Q)
             (SKIPN NIL -18 Q)
             (JRST 4)
             (MOVE O1 (CONSTANT 0))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 4)    (SKIPN NIL -16 Q)
             (JRST 7)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -14 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -15 Q)
             (JUMPN O1 6)
             (MOVEM NIL -15 Q)
(LABEL 6)    (SKIPN NIL -16 Q)
             (JRST 10)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -13 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (SKIPE NIL O1)
             (MOVEM O1 -14 Q)
             (JUMPN O1 9)
             (MOVEM NIL -14 Q)
(LABEL 9)    (SKIPN NIL -16 Q)
             (JRST 13)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -12 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 14)
(LABEL 13)   (MOVE O1 NIL)
(LABEL 14)   (SKIPE NIL O1)
             (MOVEM O1 -13 Q)
             (JUMPN O1 12)
             (MOVEM NIL -13 Q)
(LABEL 12)   (SKIPN NIL -16 Q)
             (JRST 16)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -11 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 17)
(LABEL 16)   (MOVE O1 NIL)
(LABEL 17)   (SKIPE NIL O1)
             (MOVEM O1 -12 Q)
             (JUMPN O1 15)
             (MOVEM NIL -12 Q)
(LABEL 15)   (SKIPN NIL -16 Q)
             (JRST 19)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -10 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 20)
(LABEL 19)   (MOVE O1 NIL)
(LABEL 20)   (SKIPE NIL O1)
             (MOVEM O1 -11 Q)
             (JUMPN O1 18)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -11 Q)
(LABEL 18)   (SKIPN NIL -16 Q)
             (JRST 22)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -9 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 23)
(LABEL 22)   (MOVE O1 NIL)
(LABEL 23)   (SKIPE NIL O1)
             (MOVEM O1 -10 Q)
             (JUMPN O1 21)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -10 Q)
(LABEL 21)   (SKIPN NIL -16 Q)
             (JRST 25)
             (MOVE O1 -16 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -8 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -16 Q)
             (MOVE O1 O5)
             (JRST 26)
(LABEL 25)   (MOVE O1 NIL)
(LABEL 26)   (SKIPE NIL O1)
             (MOVEM O1 -9 Q)
             (JUMPN O1 24)
             (MOVEM NIL -9 Q)
(LABEL 24)   (SKIPN NIL -16 Q)
             (JRST 28)
             (MOVE O1 (CONSTANT 3))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 28)   (SKIPN NIL (SPECIAL 4))
             (JRST 30)
             (MOVE O1 (SPECIAL 4))
             (MOVE O5 0 O1)
             (MOVEM O5 -6 Q)
             (MOVE O1 (SPECIAL 4))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 4))
             (MOVEM O5 -7 Q)
             (JRST 31)
(LABEL 30)   (MOVE O1 (CONSTANT 5))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -7 Q)
(LABEL 31)   (MOVE O1 -7 Q)
             (CALL FLOATP 1)
             (JUMPE O1 32)
             (MOVE O5 -7 Q)
             (MOVEM O5 -6 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -14 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -2 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -20 Q)
             (MOVE O1 -10 Q)
             (MOVE O2 -9 Q)
             (MOVE O3 -8 Q)
             (MOVE O4 -7 Q)
             (MOVE O5 -6 Q)
             (CALL LISP::FORMAT-GENERAL-AUX 9)
             (JRST 33)
(LABEL 32)   (MOVE O1 -7 Q)
             (CALL RATIONALP 1)
             (JUMPE O1 34)
             (MOVE O2 (CONSTANT 6))
             (MOVE O1 -7 Q)
             (CALL COERCE 2)
             (MOVEM O1 -6 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -5 Q)
             (MOVE O5 -14 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -2 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -11 Q)
             (PUSH Q -20 Q)
             (MOVE O1 -10 Q)
             (MOVE O2 -9 Q)
             (MOVE O3 -8 Q)
             (MOVE O4 -7 Q)
             (MOVE O5 -6 Q)
             (CALL LISP::FORMAT-GENERAL-AUX 9)
             (JRST 35)
(LABEL 34)   (MOVE O5 (CONSTANT 7))
             (MOVEM O5 -5 Q)
             (MOVE O1 O5)
             (SPEC-BIND (SPECIAL 8))
             (MOVEM O1 (SPECIAL 8))
             (MOVE O1 -7 Q)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -4 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 (CONSTANT 9))
             (MOVEM O5 -2 Q)
             (MOVE O5 (CONSTANT 10))
             (MOVEM O5 -1 Q)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 0 Q)
             (PUSH Q (CONSTANT 11))
             (MOVE O1 -5 Q)
             (MOVE O2 -4 Q)
             (MOVE O3 -3 Q)
             (MOVE O4 -2 Q)
             (MOVE O5 -1 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
             (UNBIND 1)
(LABEL 35)
(LABEL 33)   (SUBI Q 19)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-GENERAL-FLOAT) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-GENERAL-FLOAT) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-GENERAL-FLOAT) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-GENERAL-AUX EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 2-FEW 1 2-MANY))
       #0_(1 7 2 4 0 #\SPACE)
       (CODE-START)
(LABEL 1)    (ADDI Q 15)
             (MOVEM O1 -14 Q)
             (MOVEM O2 -13 Q)
             (MOVEM O3 -12 Q)
             (MOVEM O4 -11 Q)
             (MOVEM O5 -10 Q)
             (CALL ABS 1)
             (CALL LISP::SCALE-EXPONENT 1)
             (ADJUST-VALUES 2)
             (MOVEM O1 -9 Q)
             (MOVEM O2 -8 Q)
             (SKIPE NIL -12 Q)
             (JRST 4)
             (MOVE O1 -14 Q)
             (CALL ABS 1)
             (CALL LISP::FLONUM-TO-STRING 1)
             (ADJUST-VALUES 2)
             (MOVEM O1 -7 Q)
             (MOVEM O2 -6 Q)
             (MOVE O2 (CONSTANT 0))
             (MOVE O1 -6 Q)
             (CALL = 2)
             (JUMPE O1 5)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -4 Q)
             (JRST 6)
(LABEL 5)    (MOVE O1 -6 Q)
             (CALL 1- 1)
             (MOVEM O1 -4 Q)
(LABEL 6)    (MOVE O2 (CONSTANT 1))
             (MOVE O1 -8 Q)
             (CALL < 2)
             (JUMPE O1 7)
             (MOVE O5 -8 Q)
             (MOVEM O5 -2 Q)
             (JRST 8)
(LABEL 7)    (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -2 Q)
(LABEL 8)    (MOVE O2 -2 Q)
             (MOVE O1 -4 Q)
             (CALL > 2)
             (JUMPE O1 9)
             (MOVE O1 -4 Q)
             (JRST 10)
(LABEL 9)    (MOVE O1 -2 Q)
(LABEL 10)   (MOVEM O1 -12 Q)
(LABEL 4)    (SKIPN NIL -11 Q)
             (JRST 12)
             (MOVE O2 (CONSTANT 2))
             (MOVE O1 -11 Q)
             (CALL + 2)
             (MOVEM O1 -7 Q)
             (JRST 13)
(LABEL 12)   (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -7 Q)
(LABEL 13)   (SKIPN NIL -13 Q)
             (JRST 14)
             (MOVE O2 -7 Q)
             (MOVE O1 -13 Q)
             (CALL - 2)
             (MOVEM O1 -6 Q)
             (JRST 15)
(LABEL 14)   (MOVEM NIL -6 Q)
(LABEL 15)   (MOVE O2 -8 Q)
             (MOVE O1 -12 Q)
             (CALL - 2)
             (MOVEM O1 -5 Q)
             (MOVE O3 -12 Q)
             (MOVE O1 (CONSTANT 4))
             (MOVE O2 -5 Q)
             (CALL <= 3)
             (JUMPE O1 17)
             (MOVE O5 -14 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -6 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -5 Q)
             (MOVEM O5 -2 Q)
             (MOVEM NIL -1 Q)
             (MOVE O5 -18 Q)
             (MOVEM O5 0 Q)
             (PUSH Q -17 Q)
             (PUSH Q -16 Q)
             (MOVE O1 -6 Q)
             (MOVE O2 -5 Q)
             (MOVE O3 -4 Q)
             (MOVE O4 -3 Q)
             (MOVE O5 -2 Q)
             (CALL LISP::FORMAT-FIXED-AUX 7)
             (MOVE O5 (CONSTANT 4))
             (MOVEM O5 -3 Q)
             (MOVE O5 -7 Q)
             (MOVEM O5 -2 Q)
(LABEL 22)   (MOVE O2 -2 Q)
             (MOVE O1 -3 Q)
             (CALL < 2)
             (JUMPN O1 23)
             (MOVE O1 NIL)
             (MOVEI N 1)
             (JRST 18)
(LABEL 23)   (MOVE O1 (CONSTANT 5))
             (CALL WRITE-CHAR 1)
             (MOVE O1 -3 Q)
             (CALL 1+ 1)
             (MOVEM O1 -3 Q)
             (JRST 22)
(LABEL 18)   (JRST 16)
(LABEL 17)   (SKIPA)
             (JRST 25)
             (MOVE O5 -14 Q)
             (MOVEM O5 -4 Q)
             (MOVE O5 -13 Q)
             (MOVEM O5 -3 Q)
             (MOVE O5 -12 Q)
             (MOVEM O5 -2 Q)
             (MOVE O5 -11 Q)
             (MOVEM O5 -1 Q)
             (MOVE O1 -10 Q)
             (SKIPE NIL O1)
             (MOVEM O1 0 Q)
             (JUMPN O1 26)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 0 Q)
(LABEL 26)   (PUSH Q -18 Q)
             (PUSH Q -18 Q)
             (PUSH Q -18 Q)
             (PUSH Q -18 Q)
             (MOVE O1 -8 Q)
             (MOVE O2 -7 Q)
             (MOVE O3 -6 Q)
             (MOVE O4 -5 Q)
             (MOVE O5 -4 Q)
             (CALL LISP::FORMAT-EXP-AUX 9)
(LABEL 25)
(LABEL 16)   (SUBI Q 19)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-GENERAL-AUX) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (NUMBER W D E K OVF PAD MARKER ATSIGN))) 
(%PUT (QUOTE FORMAT-GENERAL-AUX) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-GENERAL-AUX) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-DOLLARS EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY))
       #0_(2 1 0 #\SPACE "Too many parameters" *FORMAT-ARGUMENTS* "Missing argument" SHORT-FLOAT "-" "+" "" *STANDARD-OUTPUT* #\0 10 *PRINT-BASE* T)
       (CODE-START)
(LABEL 1)    (ADDI Q 21)
             (MOVEM O1 -20 Q)
             (MOVEM O2 -19 Q)
             (MOVEM O3 -18 Q)
             (SKIPN NIL -18 Q)
             (JRST 4)
             (MOVE O1 -18 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -16 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -18 Q)
             (MOVE O1 O5)
             (JRST 5)
(LABEL 4)    (MOVE O1 NIL)
(LABEL 5)    (SKIPE NIL O1)
             (MOVEM O1 -17 Q)
             (JUMPN O1 3)
             (MOVE O5 (CONSTANT 0))
             (MOVEM O5 -17 Q)
(LABEL 3)    (SKIPN NIL -18 Q)
             (JRST 7)
             (MOVE O1 -18 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -15 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -18 Q)
             (MOVE O1 O5)
             (JRST 8)
(LABEL 7)    (MOVE O1 NIL)
(LABEL 8)    (SKIPE NIL O1)
             (MOVEM O1 -16 Q)
             (JUMPN O1 6)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -16 Q)
(LABEL 6)    (SKIPN NIL -18 Q)
             (JRST 10)
             (MOVE O1 -18 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -14 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -18 Q)
             (MOVE O1 O5)
             (JRST 11)
(LABEL 10)   (MOVE O1 NIL)
(LABEL 11)   (SKIPE NIL O1)
             (MOVEM O1 -15 Q)
             (JUMPN O1 9)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -15 Q)
(LABEL 9)    (SKIPN NIL -18 Q)
             (JRST 13)
             (MOVE O1 -18 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 -13 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -18 Q)
             (MOVE O1 O5)
             (JRST 14)
(LABEL 13)   (MOVE O1 NIL)
(LABEL 14)   (SKIPE NIL O1)
             (MOVEM O1 -14 Q)
             (JUMPN O1 12)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -14 Q)
(LABEL 12)   (SKIPN NIL -18 Q)
             (JRST 16)
             (MOVE O1 (CONSTANT 4))
             (CALL LISP::FORMAT-ERROR 1)
(LABEL 16)   (SKIPN NIL (SPECIAL 5))
             (JRST 18)
             (MOVE O1 (SPECIAL 5))
             (MOVE O5 0 O1)
             (MOVEM O5 -11 Q)
             (MOVE O1 (SPECIAL 5))
             (MOVE O1 1 O1)
             (MOVEM O1 (SPECIAL 5))
             (MOVEM O5 -12 Q)
             (JRST 19)
(LABEL 18)   (MOVE O1 (CONSTANT 6))
             (CALL LISP::FORMAT-ERROR 1)
             (MOVEM O1 -12 Q)
(LABEL 19)   (MOVE O1 -12 Q)
             (CALL RATIONALP 1)
             (JUMPE O1 20)
             (MOVE O2 (CONSTANT 7))
             (MOVE O1 -12 Q)
             (CALL COERCE 2)
             (MOVEM O1 -12 Q)
(LABEL 20)   (MOVE O1 -12 Q)
             (CALL FLOATP 1)
             (JUMPE O1 22)
             (MOVE O2 (CONSTANT 2))
             (MOVE O1 -12 Q)
             (CALL < 2)
             (JUMPE O1 24)
             (MOVE O5 (CONSTANT 8))
             (MOVEM O5 -10 Q)
             (JRST 25)
(LABEL 24)   (SKIPN NIL -19 Q)
             (JRST 26)
             (MOVE O5 (CONSTANT 9))
             (MOVEM O5 -10 Q)
             (JRST 27)
(LABEL 26)   (MOVE O5 (CONSTANT 10))
             (MOVEM O5 -10 Q)
(LABEL 27)
(LABEL 25)   (MOVE O1 -10 Q)
             (CALL LENGTH 1)
             (MOVEM O1 -9 Q)
             (MOVE O4 NIL)
             (MOVE O1 -12 Q)
             (MOVE O2 O4)
             (MOVE O3 -17 Q)
             (CALL LISP::FLONUM-TO-STRING 4)
             (ADJUST-VALUES 5)
             (MOVEM O1 -7 Q)
             (MOVEM O2 -6 Q)
             (MOVEM O3 -5 Q)
             (MOVEM O4 -4 Q)
             (MOVEM O5 -3 Q)
             (SKIPN NIL -20 Q)
             (JRST 29)
             (MOVE O5 (SPECIAL 11))
             (MOVEM O5 -2 Q)
             (MOVE O4 NIL)
             (MOVE O1 -10 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 2))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 29)   (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 -9 Q)
             (MOVE O1 -15 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
             (MOVE O2 -3 Q)
             (MOVE O1 -16 Q)
             (CALL - 2)
             (MOVE O2 O1)
             (MOVE O1 0 Q)
             (CALL - 2)
             (MOVEM O1 0 Q)
             (MOVE O2 -6 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
(LABEL 35)   (MOVE O2 -1 Q)
             (MOVE O1 -2 Q)
             (CALL < 2)
             (JUMPN O1 36)
             (JRST 31)
(LABEL 36)   (MOVE O1 -14 Q)
             (CALL WRITE-CHAR 1)
             (MOVE O1 -2 Q)
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (JRST 35)
(LABEL 31)   (SKIPE NIL -20 Q)
             (JRST 39)
             (MOVE O5 (SPECIAL 11))
             (MOVEM O5 -2 Q)
             (MOVE O4 NIL)
             (MOVE O1 -10 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 2))
             (CALL LISP::%SP-WRITE-STRING 4)
(LABEL 39)   (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -2 Q)
             (MOVE O2 -3 Q)
             (MOVE O1 -16 Q)
             (CALL - 2)
             (MOVEM O1 -1 Q)
(LABEL 45)   (MOVE O2 -1 Q)
             (MOVE O1 -2 Q)
             (CALL < 2)
             (JUMPN O1 46)
             (JRST 41)
(LABEL 46)   (MOVE O1 (CONSTANT 12))
             (CALL WRITE-CHAR 1)
             (MOVE O1 -2 Q)
             (CALL 1+ 1)
             (MOVEM O1 -2 Q)
             (JRST 45)
(LABEL 41)   (MOVE O5 (SPECIAL 11))
             (MOVEM O5 -2 Q)
             (MOVE O4 NIL)
             (MOVE O1 -7 Q)
             (MOVE O2 O5)
             (MOVE O3 (CONSTANT 2))
             (CALL LISP::%SP-WRITE-STRING 4)
             (JRST 23)
(LABEL 22)   (MOVE O5 (CONSTANT 13))
             (MOVEM O5 -10 Q)
             (MOVE O1 O5)
             (SPEC-BIND (SPECIAL 14))
             (MOVEM O1 (SPECIAL 14))
             (MOVE O1 -12 Q)
             (CALL PRINC-TO-STRING 1)
             (MOVEM O1 -9 Q)
             (MOVE O5 -15 Q)
             (MOVEM O5 -8 Q)
             (MOVE O5 (CONSTANT 1))
             (MOVEM O5 -7 Q)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -6 Q)
             (MOVE O5 (CONSTANT 3))
             (MOVEM O5 -5 Q)
             (PUSH Q (CONSTANT 15))
             (MOVE O1 -10 Q)
             (MOVE O2 -9 Q)
             (MOVE O3 -8 Q)
             (MOVE O4 -7 Q)
             (MOVE O5 -6 Q)
             (CALL LISP::FORMAT-WRITE-FIELD 6)
             (UNBIND 1)
(LABEL 23)   (SUBI Q 21)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-DOLLARS) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (COLON ATSIGN PARMS))) 
(%PUT (QUOTE FORMAT-DOLLARS) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-DOLLARS) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_MAKE-DISPATCH-VECTOR-INTERNAL-218 EXPR
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_NIL
       (CODE-START)
(LABEL 1)    (ADDI Q 4)
             (MOVEM O1 -3 Q)
             (MOVE O1 0 O1)
             (CALL CHAR-DOWNCASE 1)
             (MOVEM O1 -2 Q)
             (MOVE O1 -3 Q)
             (MOVE O1 0 O1)
             (CALL CHAR-UPCASE 1)
             (MOVEM O1 -1 Q)
             (MOVE O2 O1)
             (CAME O2 -2 Q)
             (JRST 3)
             (MOVE O1 -3 Q)
             (CALL LIST 1)
             (JRST 4)
(LABEL 3)    (MOVE O1 -3 Q)
             (MOVE O2 1 O1)
             (MOVE O1 -1 Q)
             (CALL CONS 2)
             (MOVEM O1 0 Q)
             (MOVE O1 -3 Q)
             (MOVE O2 1 O1)
             (MOVE O1 -2 Q)
             (CALL CONS 2)
             (MOVE O2 O1)
             (MOVE O1 0 Q)
             (CALL LIST 2)
(LABEL 4)    (SUBI Q 4)
             (POPJ P)
)


#_(LAP #0_MAKE-DISPATCH-VECTOR-INTERNAL-219 EXPR
       (ENTRY-POINTS (2-FEW 2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_NIL
       (CODE-START)
(LABEL 1)    (ADDI Q 3)
             (MOVEM O1 -2 Q)
             (MOVEM O2 -1 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 O2)
             (MOVE O2 0 O1)
             (MOVE O1 O5)
             (CALL CHAR< 2)
             (SUBI Q 3)
             (POPJ P)
)


#_(LAP #0_MAKE-DISPATCH-VECTOR MACRO
       (ENTRY-POINTS (2-FEW 1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(MAKE-DISPATCH-VECTOR-INTERNAL-218 MAKE-DISPATCH-VECTOR-INTERNAL-219 0 128 "Garbage in dispatch vector - ~S" VECTOR)
       (CODE-START)
(LABEL 1)    (ADDI Q 8)
             (MOVEM O1 -7 Q)
             (MOVE O5 1 O1)
             (MOVEM O5 -6 Q)
             (MOVE O2 O5)
             (MOVE O1 (CONSTANT 0))
             (CALL MAPCAN 2)
             (MOVEM O1 -5 Q)
             (MOVE O2 (CONSTANT 1))
             (CALL SORT 2)
             (MOVEM O1 -4 Q)
             (MOVE O5 (CONSTANT 2))
             (MOVEM O5 -3 Q)
             (MOVEM NIL -2 Q)
(LABEL 7)    (MOVE O2 (CONSTANT 3))
             (MOVE O1 -3 Q)
             (CALL = 2)
             (JUMPE O1 8)
             (SKIPN NIL -4 Q)
             (JRST 10)
             (MOVE O2 -4 Q)
             (MOVE O1 (CONSTANT 4))
             (CALL ERROR 2)
(LABEL 10)   (MOVE O1 -2 Q)
             (CALL NREVERSE 1)
             (MOVE O2 O1)
             (MOVE O1 (CONSTANT 5))
             (CALL CONS 2)
             (JRST 3)
(LABEL 8)    (MOVE O1 -3 Q)
             (CALL 1+ 1)
             (MOVEM O1 -1 Q)
             (SKIPN NIL -4 Q)
             (JRST 12)
             (MOVE O1 -4 Q)
             (MOVE O1 0 O1)
             (MOVE O1 0 O1)
             (CALL CHAR-CODE 1)
             (MOVEM O1 0 Q)
             (MOVE O2 -3 Q)
             (CALL = 2)
             (JUMPE O1 14)
             (MOVE O1 -4 Q)
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (MOVE O1 1 O1)
             (MOVEM O1 -4 Q)
             (MOVE O1 O5)
             (MOVE O1 1 O1)
             (MOVE O5 0 O1)
             (MOVEM O5 0 Q)
             (JRST 15)
(LABEL 14)   (MOVEM NIL 0 Q)
(LABEL 15)   (JRST 13)
(LABEL 12)   (MOVEM NIL 0 Q)
(LABEL 13)   (MOVE O2 -2 Q)
             (MOVE O1 0 Q)
             (CALL CONS 2)
             (MOVEM O1 0 Q)
             (MOVE O1 -1 Q)
             (MOVEM O1 -3 Q)
             (MOVE O1 0 Q)
             (MOVEM O1 -2 Q)
             (JRST 7)
(LABEL 3)    (SUBI Q 8)
             (POPJ P)
)

(%PUT (QUOTE MAKE-DISPATCH-VECTOR) (QUOTE %ARGS-DOCUMENTATION) (QUOTE (&BODY ENTRIES))) 
(%PUT (QUOTE MAKE-DISPATCH-VECTOR) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE MAKE-DISPATCH-VECTOR) (QUOTE %SOURCE-DOCUMENTATION)))) 

#_(LAP #0_FORMAT-INIT EXPR
       (ENTRY-POINTS (1 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY 2-MANY))
       #0_(FORMAT-NEWLINE FORMAT-DOLLARS FORMAT-TERPRI FORMAT-FRESHLINE FORMAT-CAPITALIZATION FORMAT-SKIP-ARGUMENTS FORMAT-JUSTIFICATION FORMAT-INDIRECTION FORMAT-PRINC FORMAT-PRINT-BINARY FORMAT-PRINT-CHARACTER FORMAT-PRINT-DECIMAL FORMAT-EXPONENTIAL FORMAT-FIXED FORMAT-GENERAL-FLOAT FORMAT-PRINT-OCTAL FORMAT-PLURAL FORMAT-PRINT-RADIX FORMAT-PRIN1 FORMAT-TAB FORMAT-PRINT-HEXADECIMAL FORMAT-CONDITION FORMAT-ESCAPE FORMAT-ITERATION FORMAT-PAGE FORMAT-TILDE *FORMAT-DISPATCH-TABLE*)
       (CODE-START)
(LABEL 1)    (ADDI Q 5)
             (MOVEM NIL -4 Q)
             (MOVEM NIL -3 Q)
             (MOVEM NIL -2 Q)
             (MOVEM NIL -1 Q)
             (MOVEM NIL 0 Q)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 0))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 1))
             (PUSH Q (CONSTANT 2))
             (PUSH Q (CONSTANT 3))
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 4))
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 5))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 6))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 7))
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 8))
             (PUSH Q (CONSTANT 9))
             (PUSH Q (CONSTANT 10))
             (PUSH Q (CONSTANT 11))
             (PUSH Q (CONSTANT 12))
             (PUSH Q (CONSTANT 13))
             (PUSH Q (CONSTANT 14))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 15))
             (PUSH Q (CONSTANT 16))
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 17))
             (PUSH Q (CONSTANT 18))
             (PUSH Q (CONSTANT 19))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 20))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 21))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 22))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 8))
             (PUSH Q (CONSTANT 9))
             (PUSH Q (CONSTANT 10))
             (PUSH Q (CONSTANT 11))
             (PUSH Q (CONSTANT 12))
             (PUSH Q (CONSTANT 13))
             (PUSH Q (CONSTANT 14))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 15))
             (PUSH Q (CONSTANT 16))
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 17))
             (PUSH Q (CONSTANT 18))
             (PUSH Q (CONSTANT 19))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 20))
             (PUSH Q NIL)
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 23))
             (PUSH Q (CONSTANT 24))
             (PUSH Q NIL)
             (PUSH Q (CONSTANT 25))
             (PUSH Q NIL)
             (MOVE O1 -127 Q)
             (MOVE O2 O1)
             (MOVE O3 O2)
             (MOVE O4 O3)
             (MOVE O5 O4)
             (CALL VECTOR 128)
             (MOVEM O1 (SPECIAL 26))
             (MOVEI N 1)
             (SUBI Q 5)
             (POPJ P)
)

(%PUT (QUOTE FORMAT-INIT) (QUOTE %ARGS-DOCUMENTATION) (QUOTE NIL)) 
(%PUT (QUOTE FORMAT-INIT) (QUOTE %SOURCE-DOCUMENTATION) (CONS (QUOTE "CARMEN::SS:<CLISP.UPSALA>FORMAT.CLISP.31") (GET (QUOTE FORMAT-INIT) (QUOTE %SOURCE-DOCUMENTATION)))) 